<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Floor Area Ratio Web App</title>
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <style>
    html, body, #mapDiv {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
    }
    #controlPanel {
      position: absolute;
      top: 20px;
      right: 20px;
      padding: 15px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      max-width: 350px;
      z-index: 1000;
      max-height: 80vh;
      overflow-y: auto;
    }
    #layerPanel {
      position: absolute;
      top: 20px;
      left: 20px;
      padding: 15px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      max-width: 300px;
      z-index: 1000;
    }
    .button {
      margin-top: 10px;
      padding: 8px 12px;
      background-color: #0079c1;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
    }
    .button:hover {
      background-color: #005e95;
    }
    .button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
    .file-input-container {
      margin-bottom: 10px;
    }
    .field-selector {
      margin-top: 10px;
      width: 100%;
    }
    .result-info {
      margin-top: 15px;
      padding: 10px;
      background-color: #f8f8f8;
      border-radius: 4px;
      font-size: 14px;
    }
    .loading {
      display: none;
      color: #0079c1;
      margin-top: 15px;
      text-align: center;
    }
    .layer-item {
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }
    .layer-toggle {
      margin-right: 8px;
    }
    .layer-label {
      font-size: 14px;
      cursor: pointer;
    }
    .attribute-table {
      margin-top: 15px;
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    .attribute-table th, .attribute-table td {
      border: 1px solid #ddd;
      padding: 6px;
      text-align: left;
    }
    .attribute-table th {
      background-color: #f2f2f2;
    }
    .attribute-panel {
      margin-top: 15px;
      padding: 8px;
      background-color: #f8f8f8;
      border-radius: 4px;
      max-height: 300px;
      overflow-y: auto;
    }
    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .panel-title {
      font-weight: bold;
      margin: 0;
    }
    hr {
      margin: 15px 0;
      border: 0;
      border-top: 1px solid #ddd;
    }
    .info-popup {
      max-height: 200px;
      overflow-y: auto;
    }
    .crs-selector {
      margin-top: 10px;
      margin-bottom: 5px;
    }
    .export-options {
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }
    .export-button {
      flex: 1;
    }
    .home-button {
  position: absolute;
  top: 15px;
  right: 15px;
  z-index: 1001;
}
.home-button a {
  display: block;
  padding: 8px;
  color: #0079c1;
  background-color: white;
  border-radius: 50%;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  text-decoration: none;
  text-align: center;
}
.home-button a:hover {
  background-color: #f0f0f0;
}
.home-button i {
  font-size: 18px;
}
  </style>
</head>
<body>
  <div id="mapDiv"></div>
  
  <!-- Main Control Panel -->
  <div id="controlPanel">
    <div class="panel-header">
      <h2 class="panel-title">Floor Area Ratio Web App</h2>
      <div class="home-button">
        <a href="page11.html" title="Back to Main Page">
          <i class="fas fa-home"></i>
        </a>
      </div>
    </div>
    
    <div class="crs-selector">
      <label for="coordSystem">Coordinate Reference System:</label>
      <select id="coordSystem" class="field-selector">
        <option value="EPSG:4326">EPSG:4326 (WGS84)</option>
        <option value="EPSG:32647">EPSG:32647 (UTM Zone 47N)</option>
        <option value="EPSG:32648">EPSG:32648 (UTM Zone 48N)</option>
      </select>
    </div>
    
    <div class="file-input-container">
      <label for="buildingFile">1. Upload Building GeoJSON:</label>
      <input type="file" id="buildingFile" accept=".geojson,.json">
      <div id="buildingStatus"></div>
    </div>
    
    <div class="file-input-container">
      <label for="parcelFile">2. Upload Land Parcel GeoJSON:</label>
      <input type="file" id="parcelFile" accept=".geojson,.json">
      <div id="parcelStatus"></div>
    </div>
    
    <div id="fieldSelectorContainer" style="display:none;">
      <label for="parcelFieldSelector">Select Parcel Identifier Field:</label>
      <select id="parcelFieldSelector" class="field-selector"></select>
    </div>
    
    <button id="processStep1" class="button" disabled>3.1 Calculate Parcel Area</button>
    <div id="step1Result" class="result-info" style="display:none;"></div>
    
    <button id="processStep2" class="button" disabled>3.2 Extract Parcel Information</button>
    <div id="step2Result" class="result-info" style="display:none;"></div>
    
    <button id="processStep3" class="button" disabled>3.3 Calculate Total Building Area</button>
    <div id="step3Result" class="result-info" style="display:none;"></div>
    
    <button id="processStep4" class="button" disabled>3.4 Calculate FAR</button>
    <div id="step4Result" class="result-info" style="display:none;"></div>
    
    <div class="export-options">
      <button id="exportButton" class="button export-button" disabled>4.1 Export as GeoJSON</button>
      <button id="exportExcelButton" class="button export-button" disabled>4.2 Export as Excel</button>
    </div>
    
    <div id="loadingIndicator" class="loading">
      <i class="fas fa-cog fa-spin"></i> Processing...
    </div>
    
    <hr>
    
    <!-- Attribute Viewer Section -->
    <div class="panel-header">
      <h3 class="panel-title">Attribute Viewer</h3>
    </div>
    
    <div>
      <label for="layerSelect">Select Layer for Attributes:</label>
      <select id="layerSelect" class="field-selector">
        <option value="">-- Select a layer --</option>
      </select>
    </div>
    
    <div id="attributePanel" class="attribute-panel" style="display:none;">
      <div id="attributeContent"></div>
    </div>
  </div>
  
  <!-- Layer Control Panel -->
  <div id="layerPanel">
    <div class="panel-header">
      <h3 class="panel-title">Map Layers</h3>
    </div>
    <div id="layerList">
      <!-- Layer toggles will be added here dynamically -->
      <div class="layer-item">
        <span class="layer-label">No layers available</span>
      </div>
    </div>
  </div>

  <!-- Leaflet JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
  <!-- Turf.js for geometry operations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Turf.js/6.5.0/turf.min.js"></script>
  <!-- Proj4js for coordinate transformations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.8.0/proj4.js"></script>
  <!-- Proj4Leaflet for CRS handling in Leaflet -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4leaflet/1.0.2/proj4leaflet.min.js"></script>
  <!-- Esri Leaflet for ESRI basemaps -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/esri-leaflet/3.0.10/esri-leaflet.js"></script>
  <!-- SheetJS (XLSX) for Excel export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  
  <script>
const _0x2b06f3=_0x5f48;(function(_0x1bf589,_0x5d0b33){const _0x1e3791=_0x5f48,_0x2f4a7e=_0x1bf589();while(!![]){try{const _0xeb15ef=-parseInt(_0x1e3791(0x136))/0x1*(-parseInt(_0x1e3791(0x1ea))/0x2)+parseInt(_0x1e3791(0x178))/0x3*(-parseInt(_0x1e3791(0x17f))/0x4)+parseInt(_0x1e3791(0x15c))/0x5*(parseInt(_0x1e3791(0x18c))/0x6)+parseInt(_0x1e3791(0x1d7))/0x7+parseInt(_0x1e3791(0x113))/0x8*(parseInt(_0x1e3791(0xfe))/0x9)+parseInt(_0x1e3791(0x133))/0xa+-parseInt(_0x1e3791(0x161))/0xb*(parseInt(_0x1e3791(0x117))/0xc);if(_0xeb15ef===_0x5d0b33)break;else _0x2f4a7e['push'](_0x2f4a7e['shift']());}catch(_0x53a88e){_0x2f4a7e['push'](_0x2f4a7e['shift']());}}}(_0x2e36,0x4675c));let map,buildingLayer,parcelLayer,resultLayer,buildingGeojson,parcelGeojson,resultGeojson,parcelFields=[],currentCRS='EPSG:4326',basemapLayer,allLayers=[],layerData={};proj4[_0x2b06f3(0x1ca)](_0x2b06f3(0x135),_0x2b06f3(0x1c4)),proj4['defs'](_0x2b06f3(0x174),_0x2b06f3(0x197));const crs={'EPSG:4326':L['CRS'][_0x2b06f3(0x17d)],'EPSG:32647':new L[(_0x2b06f3(0x18d))]['CRS']('EPSG:32647',proj4[_0x2b06f3(0x1ca)](_0x2b06f3(0x135)),{'resolutions':[0x100,0x80,0x40,0x20,0x10,0x8,0x4,0x2,0x1,0.5,0.25],'origin':[0x0,0x0]}),'EPSG:32648':new L[(_0x2b06f3(0x18d))][(_0x2b06f3(0x1f4))](_0x2b06f3(0x174),proj4[_0x2b06f3(0x1ca)]('EPSG:32648'),{'resolutions':[0x100,0x80,0x40,0x20,0x10,0x8,0x4,0x2,0x1,0.5,0.25],'origin':[0x0,0x0]})};function initMap(){const _0x3d4453=_0x2b06f3,_0x491e7b=document[_0x3d4453(0x13e)](_0x3d4453(0x1ba))[_0x3d4453(0x1ed)];currentCRS=_0x491e7b,map&&map[_0x3d4453(0x1c3)](),map=L[_0x3d4453(0x154)](_0x3d4453(0x1eb),{'crs':crs[_0x491e7b]})[_0x3d4453(0x179)]([13.7,100.5],0xa),_0x491e7b==='EPSG:4326'?(basemapLayer=L['esri'][_0x3d4453(0x100)](_0x3d4453(0x17e),{'detectRetina':!![]})[_0x3d4453(0x190)](map),L[_0x3d4453(0x118)][_0x3d4453(0x100)](_0x3d4453(0x1f9))[_0x3d4453(0x190)](map)):(basemapLayer=L[_0x3d4453(0x1d3)]([[-0x5a,-0xb4],[0x5a,0xb4]],{'color':'#f8f8f8','weight':0x1,'fillColor':'#f8f8f8','fillOpacity':0x1})[_0x3d4453(0x190)](map),L['control'][_0x3d4453(0x167)]({'prefix':_0x3d4453(0x169)})[_0x3d4453(0x190)](map)),console['log'](_0x3d4453(0x1b7)+_0x491e7b),reloadLayers();}function reloadLayers(){const _0x18e84=_0x2b06f3;buildingLayer&&map[_0x18e84(0x1fb)](buildingLayer)&&map[_0x18e84(0x1ad)](buildingLayer);parcelLayer&&map[_0x18e84(0x1fb)](parcelLayer)&&map[_0x18e84(0x1ad)](parcelLayer);resultLayer&&map[_0x18e84(0x1fb)](resultLayer)&&map['removeLayer'](resultLayer);buildingGeojson&&addGeoJSONToMap(buildingGeojson,_0x18e84(0x17c),_0x18e84(0x1dc));parcelGeojson&&addGeoJSONToMap(parcelGeojson,'parcel',_0x18e84(0x1d8));if(resultGeojson){let _0x3cd03a=_0x18e84(0x12c),_0x423c23='Final\x20Result\x20(FAR)';if(resultGeojson[_0x18e84(0x11e)]['length']>0x0){const _0x56050a=resultGeojson['features'][0x0][_0x18e84(0x13a)];if(_0x56050a['FAR']!==undefined)_0x3cd03a=_0x18e84(0x12c),_0x423c23=_0x18e84(0x1c9);else{if(_0x56050a[_0x18e84(0x173)]!==undefined)_0x3cd03a=_0x18e84(0x193),_0x423c23=_0x18e84(0x10f);else _0x56050a[_0x18e84(0x168)]!==undefined&&(_0x3cd03a='parcelArea',_0x423c23=_0x18e84(0x15d));}}addGeoJSONToMap(resultGeojson,_0x3cd03a,_0x423c23);}}function checkCRS(_0x1d26fc){const _0x2b23e3=_0x2b06f3,_0x2475c9=document['getElementById'](_0x2b23e3(0x1ba))[_0x2b23e3(0x1ed)];if(!_0x1d26fc||!_0x1d26fc[_0x2b23e3(0x11e)]||_0x1d26fc[_0x2b23e3(0x11e)][_0x2b23e3(0x16a)]===0x0)return![];const _0x1d06c4=_0x1d26fc[_0x2b23e3(0x11e)][0x0];let _0x2c2bd3=[];if(_0x1d06c4[_0x2b23e3(0x15e)][_0x2b23e3(0x1a7)]==='Point')_0x2c2bd3=_0x1d06c4[_0x2b23e3(0x15e)]['coordinates'];else{if(_0x1d06c4['geometry'][_0x2b23e3(0x1a7)]==='LineString'||_0x1d06c4[_0x2b23e3(0x15e)][_0x2b23e3(0x1a7)]==='MultiPoint')_0x2c2bd3=_0x1d06c4[_0x2b23e3(0x15e)][_0x2b23e3(0xff)][0x0];else{if(_0x1d06c4[_0x2b23e3(0x15e)]['type']===_0x2b23e3(0x111)||_0x1d06c4[_0x2b23e3(0x15e)][_0x2b23e3(0x1a7)]===_0x2b23e3(0x131))_0x2c2bd3=_0x1d06c4[_0x2b23e3(0x15e)]['coordinates'][0x0][0x0];else _0x1d06c4['geometry'][_0x2b23e3(0x1a7)]===_0x2b23e3(0x180)&&(_0x2c2bd3=_0x1d06c4[_0x2b23e3(0x15e)][_0x2b23e3(0xff)][0x0][0x0][0x0]);}}if(_0x2c2bd3[_0x2b23e3(0x16a)]<0x2)return![];const _0x434d3c=_0x2c2bd3[0x0],_0x51faeb=_0x2c2bd3[0x1];return _0x2475c9===_0x2b23e3(0x11c)?_0x434d3c>=-0xb4&&_0x434d3c<=0xb4&&_0x51faeb>=-0x5a&&_0x51faeb<=0x5a:_0x434d3c>0x186a0&&_0x51faeb>0x186a0;}function addGeoJSONToMap(_0x435b2e,_0x32f1fa,_0x1b7d42){const _0x4e4295=_0x2b06f3,_0x1595f9=document[_0x4e4295(0x13e)]('coordSystem')[_0x4e4295(0x1ed)];let _0x218c60=JSON[_0x4e4295(0x123)](JSON[_0x4e4295(0x1da)](_0x435b2e));const _0x493f57={'color':_0x32f1fa===_0x4e4295(0x17c)?'#ff0000':_0x4e4295(0x1ce),'weight':0x1,'opacity':0x1,'fillOpacity':0.5};if(_0x32f1fa==='parcelArea')_0x493f57['color']=_0x4e4295(0x128);else{if(_0x32f1fa==='parcelsBuildingAreas')_0x493f57[_0x4e4295(0x172)]=_0x4e4295(0x128);else _0x32f1fa===_0x4e4295(0x12c)&&(_0x493f57['color']=_0x4e4295(0x128));}let _0x229929;if(_0x32f1fa===_0x4e4295(0x12c)){function _0x292d82(_0x3a730e){const _0x179bb4=_0x4e4295;return _0x3a730e<0.5?'#00ff00':_0x3a730e<0x1?'#ffff00':_0x3a730e<0x2?'#ffa500':_0x179bb4(0x139);}_0x229929=L[_0x4e4295(0x1c8)](_0x218c60,{'coordsToLatLng':function(_0x4eb4a9){const _0x116345=_0x4e4295;if(_0x1595f9!=='EPSG:4326'){const _0x5b135d=proj4(_0x1595f9,'EPSG:4326',_0x4eb4a9);return new L[(_0x116345(0x1b9))](_0x5b135d[0x1],_0x5b135d[0x0]);}return new L[(_0x116345(0x1b9))](_0x4eb4a9[0x1],_0x4eb4a9[0x0]);},'style':function(_0x30deaa){const _0x1c5599=_0x4e4295;return{'fillColor':_0x292d82(_0x30deaa[_0x1c5599(0x13a)]['FAR']),'weight':0x1,'opacity':0x1,'color':_0x1c5599(0x128),'fillOpacity':0.7};},'onEachFeature':function(_0x1c0e42,_0x4cc65e){const _0xffa792=_0x4e4295,_0x538dde=document[_0xffa792(0x13e)](_0xffa792(0x19e))[_0xffa792(0x1ed)]||'ID',_0x483b51=_0xffa792(0x206)+_0x538dde+':</strong>\x20'+_0x1c0e42[_0xffa792(0x13a)][_0x538dde]+_0xffa792(0x1a8)+_0x1c0e42[_0xffa792(0x13a)]['parcelArea']+_0xffa792(0x143)+_0x1c0e42[_0xffa792(0x13a)][_0xffa792(0x173)]+_0xffa792(0x1cf)+_0x1c0e42[_0xffa792(0x13a)][_0xffa792(0x106)]+_0xffa792(0x16c)+(_0x1c0e42['properties']['buildingCount']||0x0)+_0xffa792(0x138)+(_0x1c0e42[_0xffa792(0x13a)][_0xffa792(0x13c)]?_0xffa792(0x126)+_0x1c0e42[_0xffa792(0x13a)][_0xffa792(0x13c)]+_0xffa792(0x16f):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x4cc65e[_0xffa792(0x1e7)](_0x483b51);}})[_0x4e4295(0x190)](map);}else{if(_0x32f1fa===_0x4e4295(0x193)){function _0x205cbd(_0x24de7d){const _0xf74e4c=_0x4e4295;return _0x24de7d<0x3e8?_0xf74e4c(0x1b6):_0x24de7d<0x1388?_0xf74e4c(0x192):_0x24de7d<0x2710?_0xf74e4c(0x1aa):_0xf74e4c(0x139);}_0x229929=L[_0x4e4295(0x1c8)](_0x218c60,{'coordsToLatLng':function(_0x54536c){const _0x573349=_0x4e4295;if(_0x1595f9!=='EPSG:4326'){const _0x545ded=proj4(_0x1595f9,_0x573349(0x11c),_0x54536c);return new L[(_0x573349(0x1b9))](_0x545ded[0x1],_0x545ded[0x0]);}return new L[(_0x573349(0x1b9))](_0x54536c[0x1],_0x54536c[0x0]);},'style':function(_0x5643d7){const _0x17703e=_0x4e4295;return{'fillColor':_0x205cbd(_0x5643d7[_0x17703e(0x13a)][_0x17703e(0x173)]),'weight':0x1,'opacity':0x1,'color':'#000000','fillOpacity':0.7};},'onEachFeature':function(_0x58ceb8,_0x25e45c){const _0xe3910c=_0x4e4295,_0x24ffb7=document[_0xe3910c(0x13e)](_0xe3910c(0x19e))[_0xe3910c(0x1ed)]||'ID',_0x3c3559=_0xe3910c(0x206)+_0x24ffb7+_0xe3910c(0x1f7)+_0x58ceb8[_0xe3910c(0x13a)][_0x24ffb7]+_0xe3910c(0x16c)+(_0x58ceb8[_0xe3910c(0x13a)]['buildingCount']||0x0)+_0xe3910c(0x109)+_0x58ceb8[_0xe3910c(0x13a)][_0xe3910c(0x173)]+'\x20sq.m<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x58ceb8[_0xe3910c(0x13a)]['calculationDetails']?_0xe3910c(0x126)+_0x58ceb8['properties'][_0xe3910c(0x13c)]+_0xe3910c(0x16f):'')+_0xe3910c(0x1c7);_0x25e45c[_0xe3910c(0x1e7)](_0x3c3559);}})[_0x4e4295(0x190)](map);}else{if(_0x32f1fa==='parcelArea'){function _0x254d6d(_0x61fe62){const _0x4d6d9e=_0x4e4295;return _0x61fe62<0x1f4?_0x4d6d9e(0x1b6):_0x61fe62<0x3e8?_0x4d6d9e(0x192):_0x61fe62<0x1388?'#ff5500':_0x4d6d9e(0x139);}_0x229929=L[_0x4e4295(0x1c8)](_0x218c60,{'coordsToLatLng':function(_0x4622bb){const _0x25d298=_0x4e4295;if(_0x1595f9!==_0x25d298(0x11c)){const _0x333996=proj4(_0x1595f9,_0x25d298(0x11c),_0x4622bb);return new L[(_0x25d298(0x1b9))](_0x333996[0x1],_0x333996[0x0]);}return new L['LatLng'](_0x4622bb[0x1],_0x4622bb[0x0]);},'style':function(_0x48f43a){const _0x1ff5ad=_0x4e4295;return{'fillColor':_0x254d6d(_0x48f43a[_0x1ff5ad(0x13a)][_0x1ff5ad(0x168)]),'weight':0x1,'opacity':0x1,'color':_0x1ff5ad(0x128),'fillOpacity':0.7};},'onEachFeature':function(_0x41d403,_0x3c71ac){const _0x30aedc=_0x4e4295,_0x38a26f=document[_0x30aedc(0x13e)](_0x30aedc(0x19e))[_0x30aedc(0x1ed)]||'ID',_0x5e52e9=_0x30aedc(0x206)+_0x38a26f+':</strong>\x20'+_0x41d403[_0x30aedc(0x13a)][_0x38a26f]+_0x30aedc(0x1a8)+_0x41d403[_0x30aedc(0x13a)][_0x30aedc(0x168)]+_0x30aedc(0x14e);_0x3c71ac['bindPopup'](_0x5e52e9);}})[_0x4e4295(0x190)](map);}else _0x32f1fa===_0x4e4295(0x159)?_0x229929=L[_0x4e4295(0x1c8)](_0x218c60,{'coordsToLatLng':function(_0x32438b){const _0x16e0ac=_0x4e4295;if(_0x1595f9!==_0x16e0ac(0x11c)){const _0x30a90b=proj4(_0x1595f9,_0x16e0ac(0x11c),_0x32438b);return new L[(_0x16e0ac(0x1b9))](_0x30a90b[0x1],_0x30a90b[0x0]);}return new L[(_0x16e0ac(0x1b9))](_0x32438b[0x1],_0x32438b[0x0]);},'pointToLayer':function(_0x36a42c,_0x4e0e85){const _0x317f04=_0x4e4295;return L[_0x317f04(0x1ee)](_0x4e0e85,{'radius':0x6,'fillColor':_0x317f04(0x139),'color':_0x317f04(0x147),'weight':0x1,'opacity':0x1,'fillOpacity':0.8});},'onEachFeature':function(_0x871e74,_0x51e7df){const _0x2b2799=_0x4e4295;let _0x2a4f91='<div\x20class=\x22info-popup\x22>';for(const _0x297536 in _0x871e74['properties']){_0x2a4f91+=_0x2b2799(0x175)+_0x297536+':</strong>\x20'+_0x871e74[_0x2b2799(0x13a)][_0x297536]+'<br>';}_0x2a4f91+=_0x2b2799(0x141),_0x51e7df[_0x2b2799(0x1e7)](_0x2a4f91);}})[_0x4e4295(0x190)](map):_0x229929=L[_0x4e4295(0x1c8)](_0x218c60,{'coordsToLatLng':function(_0x5ab07a){const _0x2faf1a=_0x4e4295;if(_0x1595f9!==_0x2faf1a(0x11c)){const _0x4e3908=proj4(_0x1595f9,_0x2faf1a(0x11c),_0x5ab07a);return new L[(_0x2faf1a(0x1b9))](_0x4e3908[0x1],_0x4e3908[0x0]);}return new L[(_0x2faf1a(0x1b9))](_0x5ab07a[0x1],_0x5ab07a[0x0]);},'style':_0x493f57,'onEachFeature':function(_0x1d9340,_0x586855){const _0x492062=_0x4e4295;let _0x33629a='<div\x20class=\x22info-popup\x22>';for(const _0x2fdb27 in _0x1d9340[_0x492062(0x13a)]){_0x33629a+=_0x492062(0x175)+_0x2fdb27+_0x492062(0x1f7)+_0x1d9340[_0x492062(0x13a)][_0x2fdb27]+_0x492062(0x166);}_0x33629a+=_0x492062(0x141),_0x586855[_0x492062(0x1e7)](_0x33629a);}})[_0x4e4295(0x190)](map);}}if(_0x32f1fa===_0x4e4295(0x17c))buildingLayer=_0x229929;else _0x32f1fa==='parcel'?parcelLayer=_0x229929:resultLayer=_0x229929;addLayerToControl(_0x229929,_0x32f1fa,_0x1b7d42,_0x218c60);try{map[_0x4e4295(0x1b0)](_0x229929[_0x4e4295(0x107)]());}catch(_0x1cc7de){console[_0x4e4295(0x1f0)]('Could\x20not\x20zoom\x20to\x20layer\x20bounds:',_0x1cc7de);}return _0x229929;}function addLayerToControl(_0x206f0b,_0x2da272,_0x438b6d,_0x4fd430){const _0x2e51f5=_0x2b06f3;if(layerData[_0x2da272]){const _0x422e6d=allLayers['indexOf'](layerData[_0x2da272]['layer']);_0x422e6d>-0x1&&allLayers['splice'](_0x422e6d,0x1);}allLayers[_0x2e51f5(0x177)](_0x206f0b),layerData[_0x2da272]={'layer':_0x206f0b,'title':_0x438b6d,'geojson':_0x4fd430};const _0xb2ccf6=document[_0x2e51f5(0x13e)](_0x2e51f5(0x1af));let _0x107ebe=![];for(let _0x2a5226=0x0;_0x2a5226<_0xb2ccf6[_0x2e51f5(0x1a0)][_0x2e51f5(0x16a)];_0x2a5226++){if(_0xb2ccf6[_0x2e51f5(0x1a0)][_0x2a5226][_0x2e51f5(0x1ed)]===_0x2da272){_0x107ebe=!![];break;}}if(!_0x107ebe){const _0xc1a1a2=document[_0x2e51f5(0x1fe)](_0x2e51f5(0x10d));_0xc1a1a2[_0x2e51f5(0x1ed)]=_0x2da272,_0xc1a1a2[_0x2e51f5(0x12e)]=_0x438b6d,_0xb2ccf6[_0x2e51f5(0x1fd)](_0xc1a1a2);}updateLayerControlPanel();}function updateLayerControlPanel(){const _0x3a1d6f=_0x2b06f3,_0x5b5f05=document[_0x3a1d6f(0x13e)](_0x3a1d6f(0x151));_0x5b5f05[_0x3a1d6f(0x19a)]='',Object['keys'](layerData)[_0x3a1d6f(0x164)]()[_0x3a1d6f(0x1bd)](_0x1c2eb3=>{const _0x3a15da=_0x3a1d6f,_0x4a0e07=layerData[_0x1c2eb3],_0x424548=document[_0x3a15da(0x1fe)](_0x3a15da(0x1d2));_0x424548[_0x3a15da(0x149)]=_0x3a15da(0x1d5);const _0x161bd3=document[_0x3a15da(0x1fe)]('input');_0x161bd3[_0x3a15da(0x1a7)]=_0x3a15da(0x15b),_0x161bd3['className']=_0x3a15da(0x1ac),_0x161bd3[_0x3a15da(0x1a2)]=map['hasLayer'](_0x4a0e07[_0x3a15da(0x19c)]),_0x161bd3['dataset'][_0x3a15da(0x188)]=_0x1c2eb3,_0x161bd3[_0x3a15da(0x1fa)](_0x3a15da(0x1f8),function(){const _0x4fd0ab=_0x3a15da;this[_0x4fd0ab(0x1a2)]?!map['hasLayer'](_0x4a0e07[_0x4fd0ab(0x19c)])&&map[_0x4fd0ab(0x119)](_0x4a0e07[_0x4fd0ab(0x19c)]):map[_0x4fd0ab(0x1fb)](_0x4a0e07[_0x4fd0ab(0x19c)])&&map[_0x4fd0ab(0x1ad)](_0x4a0e07[_0x4fd0ab(0x19c)]);});const _0x1da485=document[_0x3a15da(0x1fe)](_0x3a15da(0x14d));_0x1da485[_0x3a15da(0x149)]=_0x3a15da(0x153),_0x1da485[_0x3a15da(0x12e)]=_0x4a0e07['title'],_0x424548[_0x3a15da(0x1fd)](_0x161bd3),_0x424548[_0x3a15da(0x1fd)](_0x1da485),_0x5b5f05[_0x3a15da(0x1fd)](_0x424548);});}function displayAttributes(_0x557647){const _0x46bb52=_0x2b06f3,_0x3a1ad3=document[_0x46bb52(0x13e)]('attributePanel'),_0x359753=document[_0x46bb52(0x13e)]('attributeContent');if(!_0x557647||!layerData[_0x557647]){_0x3a1ad3['style']['display']='none';return;}const _0x32d1ba=layerData[_0x557647],_0x2d8894=_0x32d1ba[_0x46bb52(0x1d1)];if(!_0x2d8894||!_0x2d8894['features']||_0x2d8894[_0x46bb52(0x11e)]['length']===0x0){_0x359753[_0x46bb52(0x19a)]=_0x46bb52(0x1d9),_0x3a1ad3['style'][_0x46bb52(0x18a)]=_0x46bb52(0x184);return;}let _0x59960a=_0x46bb52(0x125)+_0x32d1ba['title']+_0x46bb52(0x183);_0x59960a+=_0x46bb52(0x127);const _0x44f598={},_0xf676a3=document['getElementById'](_0x46bb52(0x19e))[_0x46bb52(0x1ed)]||'ID';_0x44f598[_0x46bb52(0x158)]=['OBJECTID',_0xf676a3],_0x44f598[_0x46bb52(0x17c)]=[_0x46bb52(0x16b),_0x46bb52(0x16d),_0x46bb52(0x1e9)],_0x44f598['buildingPoints']=[_0x46bb52(0x17b),_0x46bb52(0x150),'buildingArea',_0x46bb52(0x1e2)],_0x44f598[_0x46bb52(0x168)]=[_0xf676a3,'parcelArea'],_0x44f598[_0x46bb52(0x193)]=[_0xf676a3,_0x46bb52(0x173)],_0x44f598[_0x46bb52(0x12c)]=[_0xf676a3,_0x46bb52(0x168),'totalBuildingArea',_0x46bb52(0x106)];let _0x366080=[];_0x44f598[_0x557647]?_0x366080=_0x44f598[_0x557647]:_0x2d8894[_0x46bb52(0x11e)][_0x46bb52(0x1bd)](_0x493851=>{const _0x4a123e=_0x46bb52;_0x493851[_0x4a123e(0x13a)]&&Object[_0x4a123e(0x160)](_0x493851[_0x4a123e(0x13a)])[_0x4a123e(0x1bd)](_0x137407=>{const _0x16e5a4=_0x4a123e;!_0x366080['includes'](_0x137407)&&_0x366080[_0x16e5a4(0x177)](_0x137407);});}),_0x59960a+=_0x46bb52(0x12b),_0x59960a+=_0x46bb52(0x1a4),_0x366080['forEach'](_0x346c9a=>{const _0x7778f1=_0x46bb52;_0x59960a+=_0x7778f1(0x13d)+_0x346c9a+_0x7778f1(0x1e6);}),_0x59960a+='</tr>',_0x2d8894[_0x46bb52(0x11e)][_0x46bb52(0x1bd)]((_0x1d03cc,_0xb1562c)=>{const _0x8aa320=_0x46bb52;_0x59960a+='<tr>',_0x59960a+=_0x8aa320(0x204)+_0xb1562c+_0x8aa320(0x176),_0x366080[_0x8aa320(0x1bd)](_0x3e1db9=>{const _0x35c863=_0x8aa320,_0xbdc866=_0x1d03cc[_0x35c863(0x13a)]?_0x1d03cc[_0x35c863(0x13a)][_0x3e1db9]:'';_0x59960a+=_0x35c863(0x204)+(_0xbdc866!==undefined&&_0xbdc866!==null?_0xbdc866:'')+'</td>';}),_0x59960a+=_0x8aa320(0x1f6);}),_0x59960a+=_0x46bb52(0x1e8),_0x359753[_0x46bb52(0x19a)]=_0x59960a,_0x3a1ad3[_0x46bb52(0x1f5)][_0x46bb52(0x18a)]=_0x46bb52(0x184);}function handleFileUpload(_0x560901,_0x1985d6){const _0x976017=_0x2b06f3,_0x541806=_0x560901[_0x976017(0x1c0)][0x0];if(!_0x541806)return;const _0x5c0db8=new FileReader();_0x5c0db8[_0x976017(0x191)]=function(_0x700403){const _0x2d7464=_0x976017,_0x250eaa=_0x700403[_0x2d7464(0x152)][_0x2d7464(0x165)];try{const _0x324af5=JSON[_0x2d7464(0x123)](_0x250eaa),_0xd6fd0f=checkCRS(_0x324af5);if(!_0xd6fd0f){const _0x453948=confirm('WARNING:\x20The\x20coordinates\x20in\x20this\x20file\x20may\x20not\x20match\x20the\x20selected\x20coordinate\x20system\x20('+document[_0x2d7464(0x13e)](_0x2d7464(0x1ba))['value']+_0x2d7464(0x105));if(!_0x453948)return;}if(_0x1985d6===_0x2d7464(0x17c)&&buildingLayer)map[_0x2d7464(0x1ad)](buildingLayer),delete layerData['building'];else _0x1985d6===_0x2d7464(0x158)&&parcelLayer&&(map[_0x2d7464(0x1ad)](parcelLayer),delete layerData[_0x2d7464(0x158)]);if(_0x1985d6===_0x2d7464(0x17c))buildingGeojson=_0x324af5,document[_0x2d7464(0x13e)](_0x2d7464(0x1bf))[_0x2d7464(0x19a)]=_0x2d7464(0x15a)+_0x541806[_0x2d7464(0x140)]+_0x2d7464(0x16e);else{if(_0x1985d6===_0x2d7464(0x158)){parcelGeojson=_0x324af5,document[_0x2d7464(0x13e)](_0x2d7464(0x13b))['innerHTML']=_0x2d7464(0x15a)+_0x541806[_0x2d7464(0x140)]+_0x2d7464(0x16e);if(_0x324af5[_0x2d7464(0x11e)]&&_0x324af5['features'][_0x2d7464(0x16a)]>0x0){const _0x434155=_0x324af5[_0x2d7464(0x11e)][0x0][_0x2d7464(0x13a)];parcelFields=Object[_0x2d7464(0x160)](_0x434155);const _0x1e4c6f=document[_0x2d7464(0x13e)](_0x2d7464(0x19e));_0x1e4c6f['innerHTML']='',parcelFields[_0x2d7464(0x1bd)](_0x5b7e5d=>{const _0x2fca59=_0x2d7464,_0x536dff=document['createElement']('option');_0x536dff['value']=_0x5b7e5d,_0x536dff[_0x2fca59(0x12e)]=_0x5b7e5d,_0x1e4c6f[_0x2fca59(0x1fd)](_0x536dff);}),document[_0x2d7464(0x13e)](_0x2d7464(0x157))['style'][_0x2d7464(0x18a)]=_0x2d7464(0x184);}}}addGeoJSONToMap(_0x324af5,_0x1985d6,_0x1985d6===_0x2d7464(0x17c)?'Buildings':'Land\x20Parcels'),buildingGeojson&&parcelGeojson&&(document[_0x2d7464(0x13e)](_0x2d7464(0x124))[_0x2d7464(0x19d)]=![]);}catch(_0x29b105){console[_0x2d7464(0x198)](_0x2d7464(0x148),_0x29b105),alert(_0x2d7464(0x11d));}},_0x5c0db8[_0x976017(0x120)](_0x541806);}function transformCoords(_0x1485f9,_0xf67422,_0x40b269){if(_0xf67422===_0x40b269)return _0x1485f9;return proj4(_0xf67422,_0x40b269,_0x1485f9);}function transformGeoJSON(_0x26a4f2,_0x40c356,_0x372f6b){const _0x472d62=_0x2b06f3;if(_0x40c356===_0x372f6b)return JSON[_0x472d62(0x123)](JSON[_0x472d62(0x1da)](_0x26a4f2));const _0x2921d2={'type':_0x26a4f2[_0x472d62(0x1a7)],'features':[]};return _0x26a4f2[_0x472d62(0x11e)][_0x472d62(0x1bd)](_0x2e8cc1=>{const _0x205441=_0x472d62,_0x3f1bc2={'type':_0x2e8cc1[_0x205441(0x1a7)],'properties':{..._0x2e8cc1[_0x205441(0x13a)]},'geometry':{'type':_0x2e8cc1[_0x205441(0x15e)][_0x205441(0x1a7)]}};if(_0x2e8cc1[_0x205441(0x15e)][_0x205441(0x1a7)]===_0x205441(0x1b5))_0x3f1bc2[_0x205441(0x15e)][_0x205441(0xff)]=transformCoords(_0x2e8cc1[_0x205441(0x15e)][_0x205441(0xff)],_0x40c356,_0x372f6b);else{if(_0x2e8cc1[_0x205441(0x15e)][_0x205441(0x1a7)]===_0x205441(0x14f)||_0x2e8cc1[_0x205441(0x15e)][_0x205441(0x1a7)]===_0x205441(0x1b4))_0x3f1bc2['geometry'][_0x205441(0xff)]=_0x2e8cc1[_0x205441(0x15e)][_0x205441(0xff)][_0x205441(0x154)](_0x5eb0cf=>transformCoords(_0x5eb0cf,_0x40c356,_0x372f6b));else{if(_0x2e8cc1[_0x205441(0x15e)][_0x205441(0x1a7)]==='Polygon'||_0x2e8cc1[_0x205441(0x15e)]['type']===_0x205441(0x131))_0x3f1bc2[_0x205441(0x15e)]['coordinates']=_0x2e8cc1[_0x205441(0x15e)][_0x205441(0xff)]['map'](_0x5e6667=>_0x5e6667[_0x205441(0x154)](_0x1cee14=>transformCoords(_0x1cee14,_0x40c356,_0x372f6b)));else _0x2e8cc1[_0x205441(0x15e)][_0x205441(0x1a7)]==='MultiPolygon'&&(_0x3f1bc2[_0x205441(0x15e)][_0x205441(0xff)]=_0x2e8cc1['geometry']['coordinates'][_0x205441(0x154)](_0x42c798=>_0x42c798[_0x205441(0x154)](_0x30d8ad=>_0x30d8ad[_0x205441(0x154)](_0x3756cd=>transformCoords(_0x3756cd,_0x40c356,_0x372f6b)))));}}_0x2921d2[_0x205441(0x11e)][_0x205441(0x177)](_0x3f1bc2);}),_0x2921d2;}function processStep1(){const _0x5cfb39=_0x2b06f3;if(!parcelGeojson){alert(_0x5cfb39(0x14c));return;}document['getElementById'](_0x5cfb39(0x1a5))[_0x5cfb39(0x1f5)][_0x5cfb39(0x18a)]=_0x5cfb39(0x184),setTimeout(()=>{const _0x34ee13=_0x5cfb39;try{console[_0x34ee13(0x195)](_0x34ee13(0x19f));const _0x573457=document['getElementById'](_0x34ee13(0x1ba))[_0x34ee13(0x1ed)],_0x55cc0a=[];for(let _0x2d8b7d=0x0;_0x2d8b7d<parcelGeojson[_0x34ee13(0x11e)][_0x34ee13(0x16a)];_0x2d8b7d++){try{const _0x43d26b=parcelGeojson[_0x34ee13(0x11e)][_0x2d8b7d];console[_0x34ee13(0x195)](_0x34ee13(0x1f2)+(_0x2d8b7d+0x1)+'/'+parcelGeojson[_0x34ee13(0x11e)][_0x34ee13(0x16a)]);let _0x3a509e;_0x573457===_0x34ee13(0x11c)?_0x3a509e=turf['area'](_0x43d26b):_0x3a509e=calculateAreaUTM(_0x43d26b[_0x34ee13(0x15e)],_0x573457),console['log'](_0x34ee13(0x146)+_0x2d8b7d+_0x34ee13(0x162)+_0x3a509e[_0x34ee13(0x1c1)](0x2)+_0x34ee13(0x116)),_0x55cc0a[_0x34ee13(0x177)]({'type':_0x34ee13(0x14a),'properties':{..._0x43d26b['properties'],'parcelArea':Math['round'](_0x3a509e*0x64)/0x64},'geometry':_0x43d26b['geometry']});}catch(_0xd5faba){console['warn']('Error\x20processing\x20parcel\x20'+_0x2d8b7d+':',_0xd5faba);}}if(_0x55cc0a['length']===0x0)throw new Error(_0x34ee13(0x110));resultGeojson={'type':_0x34ee13(0x137),'features':_0x55cc0a},console[_0x34ee13(0x195)]('Parcel\x20Area\x20GeoJSON\x20created:',resultGeojson);resultLayer&&(map['removeLayer'](resultLayer),delete layerData[_0x34ee13(0x168)]);addGeoJSONToMap(resultGeojson,_0x34ee13(0x168),_0x34ee13(0x15d));let _0x1fe3dc=0x0;_0x55cc0a[_0x34ee13(0x1bd)](_0x4d12cf=>{const _0x2b8158=_0x34ee13;_0x1fe3dc+=_0x4d12cf[_0x2b8158(0x13a)]['parcelArea'];});const _0x2ce011=_0x1fe3dc/_0x55cc0a[_0x34ee13(0x16a)];document['getElementById'](_0x34ee13(0x142))[_0x34ee13(0x19a)]=_0x34ee13(0x12d)+_0x55cc0a['length']+_0x34ee13(0x104)+Math[_0x34ee13(0x1dd)](_0x1fe3dc*0x64)/0x64+_0x34ee13(0x130)+Math[_0x34ee13(0x1dd)](_0x2ce011*0x64)/0x64+_0x34ee13(0x199)+_0x573457+_0x34ee13(0x1bc),document[_0x34ee13(0x13e)](_0x34ee13(0x142))[_0x34ee13(0x1f5)]['display']='block',document[_0x34ee13(0x13e)]('processStep2')[_0x34ee13(0x19d)]=![],document[_0x34ee13(0x13e)](_0x34ee13(0x1a5))[_0x34ee13(0x1f5)][_0x34ee13(0x18a)]=_0x34ee13(0x1a1);}catch(_0x3bf26b){console[_0x34ee13(0x198)](_0x34ee13(0x1cb),_0x3bf26b),alert(_0x34ee13(0x1b2)+_0x3bf26b[_0x34ee13(0x1cc)]),document[_0x34ee13(0x13e)](_0x34ee13(0x1a5))['style'][_0x34ee13(0x18a)]=_0x34ee13(0x1a1);}},0x64);}function calculateAreaUTM(_0x31fde3,_0x41a5ec){const _0x1ef762=_0x2b06f3;let _0x5a9aba=0x0;if(_0x31fde3[_0x1ef762(0x1a7)]==='Polygon')_0x5a9aba=polygonArea(_0x31fde3['coordinates'][0x0]);else{if(_0x31fde3['type']===_0x1ef762(0x180))for(const _0x54c7e5 of _0x31fde3[_0x1ef762(0xff)]){_0x5a9aba+=polygonArea(_0x54c7e5[0x0]);for(let _0x3690a3=0x1;_0x3690a3<_0x54c7e5[_0x1ef762(0x16a)];_0x3690a3++){_0x5a9aba-=polygonArea(_0x54c7e5[_0x3690a3]);}}}return Math[_0x1ef762(0x201)](_0x5a9aba);}function polygonArea(_0x5b4d33){const _0x18c391=_0x2b06f3;let _0x51d4c3=0x0;const _0x4c4bf0=_0x5b4d33[_0x18c391(0x16a)];if(_0x4c4bf0<0x3)return 0x0;for(let _0xc3959d=0x0;_0xc3959d<_0x4c4bf0-0x1;_0xc3959d++){_0x51d4c3+=_0x5b4d33[_0xc3959d][0x0]*_0x5b4d33[_0xc3959d+0x1][0x1]-_0x5b4d33[_0xc3959d+0x1][0x0]*_0x5b4d33[_0xc3959d][0x1];}return _0x51d4c3+=_0x5b4d33[_0x4c4bf0-0x1][0x0]*_0x5b4d33[0x0][0x1]-_0x5b4d33[0x0][0x0]*_0x5b4d33[_0x4c4bf0-0x1][0x1],Math[_0x18c391(0x201)](_0x51d4c3/0x2);}function processStep2(){const _0x80cae5=_0x2b06f3;if(!buildingGeojson||!parcelGeojson){alert(_0x80cae5(0x1e0));return;}const _0x3be3fa=document[_0x80cae5(0x13e)](_0x80cae5(0x19e))[_0x80cae5(0x1ed)];if(!_0x3be3fa){alert(_0x80cae5(0x121));return;}document[_0x80cae5(0x13e)](_0x80cae5(0x1a5))[_0x80cae5(0x1f5)][_0x80cae5(0x18a)]=_0x80cae5(0x184),setTimeout(()=>{const _0x1d4dbe=_0x80cae5;try{console[_0x1d4dbe(0x195)](_0x1d4dbe(0x194));const _0x3cec69=document[_0x1d4dbe(0x13e)](_0x1d4dbe(0x1ba))['value'],_0x2739bf=[];let _0x3590d3=0x0,_0x5d28e5=0x0;buildingGeojson[_0x1d4dbe(0x11e)][_0x1d4dbe(0x1bd)]((_0x1ec233,_0x31d390)=>{const _0x40e97a=_0x1d4dbe;try{console['log']('Processing\x20building\x20'+(_0x31d390+0x1)+'/'+buildingGeojson[_0x40e97a(0x11e)][_0x40e97a(0x16a)]);let _0x468c0b;if(_0x1ec233[_0x40e97a(0x15e)][_0x40e97a(0x1a7)]==='Polygon')_0x468c0b=calculateCentroid(_0x1ec233[_0x40e97a(0x15e)][_0x40e97a(0xff)][0x0]);else{if(_0x1ec233['geometry'][_0x40e97a(0x1a7)]===_0x40e97a(0x180))_0x468c0b=calculateCentroid(_0x1ec233[_0x40e97a(0x15e)][_0x40e97a(0xff)][0x0][0x0]);else throw new Error(_0x40e97a(0x14b)+_0x1ec233['geometry'][_0x40e97a(0x1a7)]);}const _0x3ef3fa={'type':_0x40e97a(0x14a),'properties':{..._0x1ec233[_0x40e97a(0x13a)],'parcelId':null,'parcelName':null,'buildingArea':typeof _0x1ec233['properties'][_0x40e97a(0x16d)]==='number'?_0x1ec233['properties'][_0x40e97a(0x16d)]:0x0,'buildingStoreys':typeof _0x1ec233[_0x40e97a(0x13a)][_0x40e97a(0x1e9)]==='number'?_0x1ec233[_0x40e97a(0x13a)][_0x40e97a(0x1e9)]:0x1},'geometry':{'type':_0x40e97a(0x1b5),'coordinates':_0x468c0b}};_0x2739bf[_0x40e97a(0x177)](_0x3ef3fa),_0x5d28e5++;}catch(_0x5c90a4){console[_0x40e97a(0x1f0)](_0x40e97a(0x1ef)+_0x31d390+':',_0x5c90a4,_0x1ec233),_0x3590d3++;}}),console['log']('Created\x20'+_0x2739bf['length']+_0x1d4dbe(0x1d4)+_0x5d28e5+_0x1d4dbe(0x1b8)+_0x3590d3);if(_0x2739bf['length']===0x0)throw new Error(_0x1d4dbe(0x115));const _0x5b379f={'type':_0x1d4dbe(0x137),'features':_0x2739bf};_0x5b379f[_0x1d4dbe(0x11e)]['forEach']((_0x1a0ac9,_0x4f6701)=>{const _0x4d8b61=_0x1d4dbe;try{for(const _0x1d1f00 of parcelGeojson[_0x4d8b61(0x11e)]){if(pointInPolygon(_0x1a0ac9['geometry'][_0x4d8b61(0xff)],_0x1d1f00[_0x4d8b61(0x15e)])){_0x1a0ac9[_0x4d8b61(0x13a)][_0x4d8b61(0x17b)]=_0x1d1f00[_0x4d8b61(0x13a)][_0x3be3fa],_0x1a0ac9[_0x4d8b61(0x13a)]['parcelName']=_0x1d1f00['properties'][_0x3be3fa];break;}}}catch(_0x35b7bb){console[_0x4d8b61(0x1f0)](_0x4d8b61(0x144)+_0x4f6701+':',_0x35b7bb);}}),layerData[_0x1d4dbe(0x159)]&&layerData[_0x1d4dbe(0x159)]['layer']&&(map[_0x1d4dbe(0x1ad)](layerData[_0x1d4dbe(0x159)][_0x1d4dbe(0x19c)]),delete layerData[_0x1d4dbe(0x159)]),addGeoJSONToMap(_0x5b379f,_0x1d4dbe(0x159),_0x1d4dbe(0x1ec)),document[_0x1d4dbe(0x13e)](_0x1d4dbe(0x122))[_0x1d4dbe(0x12e)]='Buildings\x20converted\x20to\x20points\x20with\x20'+_0x3be3fa+_0x1d4dbe(0x11b),document['getElementById'](_0x1d4dbe(0x122))[_0x1d4dbe(0x1f5)][_0x1d4dbe(0x18a)]='block',document[_0x1d4dbe(0x13e)](_0x1d4dbe(0x1c2))[_0x1d4dbe(0x19d)]=![],document[_0x1d4dbe(0x13e)](_0x1d4dbe(0x1a5))[_0x1d4dbe(0x1f5)][_0x1d4dbe(0x18a)]=_0x1d4dbe(0x1a1);}catch(_0x31de21){console['error'](_0x1d4dbe(0x1d0),_0x31de21),alert(_0x1d4dbe(0x1be)+_0x31de21[_0x1d4dbe(0x1cc)]),document[_0x1d4dbe(0x13e)](_0x1d4dbe(0x1a5))[_0x1d4dbe(0x1f5)]['display']=_0x1d4dbe(0x1a1);}},0x64);}function _0x5f48(_0x9892a8,_0x44f4f1){const _0x2e36c6=_0x2e36();return _0x5f48=function(_0x5f4866,_0x50808d){_0x5f4866=_0x5f4866-0xfe;let _0x484214=_0x2e36c6[_0x5f4866];return _0x484214;},_0x5f48(_0x9892a8,_0x44f4f1);}function calculateCentroid(_0x43769d){const _0x33d3f8=_0x2b06f3;let _0x26d5c0=0x0,_0x13b307=0x0;for(let _0x64346c=0x0;_0x64346c<_0x43769d[_0x33d3f8(0x16a)];_0x64346c++){_0x26d5c0+=_0x43769d[_0x64346c][0x0],_0x13b307+=_0x43769d[_0x64346c][0x1];}return[_0x26d5c0/_0x43769d['length'],_0x13b307/_0x43769d[_0x33d3f8(0x16a)]];}function pointInPolygon(_0x557ec2,_0x20262a){const _0x3bae84=_0x2b06f3;try{if(_0x20262a[_0x3bae84(0x1a7)]===_0x3bae84(0x111))return isPointInPolygon(_0x557ec2,_0x20262a[_0x3bae84(0xff)][0x0]);else{if(_0x20262a[_0x3bae84(0x1a7)]===_0x3bae84(0x180))for(const _0x1384bd of _0x20262a[_0x3bae84(0xff)]){if(isPointInPolygon(_0x557ec2,_0x1384bd[0x0]))return!![];}}return![];}catch(_0x19a554){return console[_0x3bae84(0x1f0)](_0x3bae84(0x1e5),_0x19a554),![];}}function isPointInPolygon(_0x300a04,_0x9537b8){const _0x4ee8a0=_0x300a04[0x0],_0x128110=_0x300a04[0x1];let _0x50d098=![];for(let _0x2b6f0e=0x0,_0xa7a016=_0x9537b8['length']-0x1;_0x2b6f0e<_0x9537b8['length'];_0xa7a016=_0x2b6f0e++){const _0x4be9e1=_0x9537b8[_0x2b6f0e][0x0],_0x23693f=_0x9537b8[_0x2b6f0e][0x1],_0x54cd57=_0x9537b8[_0xa7a016][0x0],_0x41a1cf=_0x9537b8[_0xa7a016][0x1],_0x50bf9c=_0x23693f>_0x128110!==_0x41a1cf>_0x128110&&_0x4ee8a0<(_0x54cd57-_0x4be9e1)*(_0x128110-_0x23693f)/(_0x41a1cf-_0x23693f)+_0x4be9e1;if(_0x50bf9c)_0x50d098=!_0x50d098;}return _0x50d098;}function processStep3(){const _0x437ca5=_0x2b06f3;if(!buildingGeojson||!parcelGeojson){alert(_0x437ca5(0x101));return;}document[_0x437ca5(0x13e)](_0x437ca5(0x1a5))[_0x437ca5(0x1f5)][_0x437ca5(0x18a)]=_0x437ca5(0x184),setTimeout(()=>{const _0x3f75a1=_0x437ca5;try{console['log'](_0x3f75a1(0x186));const _0x4cf99e=document[_0x3f75a1(0x13e)](_0x3f75a1(0x19e))[_0x3f75a1(0x1ed)],_0x35cf88=JSON[_0x3f75a1(0x123)](JSON[_0x3f75a1(0x1da)](resultGeojson||parcelGeojson)),_0x115630={};_0x35cf88[_0x3f75a1(0x11e)][_0x3f75a1(0x1bd)](_0x5454cc=>{const _0xc7c5aa=_0x5454cc['properties'][_0x4cf99e];_0x115630[_0xc7c5aa]=0x0;});const _0x42e303={};_0x35cf88['features']['forEach'](_0x3b7398=>{const _0x32dc55=_0x3f75a1,_0x53bb22=_0x3b7398[_0x32dc55(0x13a)][_0x4cf99e];_0x42e303[_0x53bb22]={'buildingCount':0x0,'buildingList':[]};}),buildingGeojson[_0x3f75a1(0x11e)]['forEach']((_0x26d90d,_0x1cf05d)=>{const _0x161ac4=_0x3f75a1;try{let _0x57dc3c;if(_0x26d90d[_0x161ac4(0x15e)][_0x161ac4(0x1a7)]===_0x161ac4(0x111))_0x57dc3c=calculateCentroid(_0x26d90d[_0x161ac4(0x15e)][_0x161ac4(0xff)][0x0]);else{if(_0x26d90d[_0x161ac4(0x15e)][_0x161ac4(0x1a7)]===_0x161ac4(0x180))_0x57dc3c=calculateCentroid(_0x26d90d[_0x161ac4(0x15e)][_0x161ac4(0xff)][0x0][0x0]);else throw new Error(_0x161ac4(0x14b)+_0x26d90d['geometry'][_0x161ac4(0x1a7)]);}let _0x477866=0x0,_0x1ddafe=0x1;if(typeof _0x26d90d[_0x161ac4(0x13a)][_0x161ac4(0x16d)]===_0x161ac4(0x189))_0x477866=_0x26d90d[_0x161ac4(0x13a)][_0x161ac4(0x16d)];else typeof _0x26d90d['properties']['BL_AREA']===_0x161ac4(0x203)&&(_0x477866=parseFloat(_0x26d90d[_0x161ac4(0x13a)][_0x161ac4(0x16d)])||0x0);if(typeof _0x26d90d['properties'][_0x161ac4(0x1e9)]===_0x161ac4(0x189))_0x1ddafe=_0x26d90d[_0x161ac4(0x13a)][_0x161ac4(0x1e9)];else typeof _0x26d90d[_0x161ac4(0x13a)][_0x161ac4(0x1e9)]===_0x161ac4(0x203)&&(_0x1ddafe=parseInt(_0x26d90d[_0x161ac4(0x13a)][_0x161ac4(0x1e9)])||0x1);_0x477866=isNaN(_0x477866)||_0x477866<0x0?0x0:_0x477866,_0x1ddafe=isNaN(_0x1ddafe)||_0x1ddafe<0x1?0x1:_0x1ddafe;const _0x2e7eaa=_0x477866*_0x1ddafe;console[_0x161ac4(0x195)](_0x161ac4(0x134)+_0x1cf05d+':\x20'+_0x477866+_0x161ac4(0x1e1)+_0x1ddafe+'\x20floors\x20=\x20'+_0x2e7eaa+_0x161ac4(0x1a9));for(const _0xd7a7aa of parcelGeojson['features']){if(pointInPolygon(_0x57dc3c,_0xd7a7aa[_0x161ac4(0x15e)])){const _0x4ebd0f=_0xd7a7aa['properties'][_0x4cf99e];_0x115630[_0x4ebd0f]+=_0x2e7eaa,_0x42e303[_0x4ebd0f][_0x161ac4(0x1f3)]++,_0x42e303[_0x4ebd0f][_0x161ac4(0x1d6)][_0x161ac4(0x177)]({'id':_0x1cf05d,'area':_0x477866,'storeys':_0x1ddafe,'totalArea':_0x2e7eaa});break;}}}catch(_0x51f0fc){console['warn'](_0x161ac4(0x155)+_0x1cf05d+':',_0x51f0fc);}}),_0x35cf88['features'][_0x3f75a1(0x1bd)](_0xf49595=>{const _0x46cf19=_0x3f75a1,_0x3be005=_0xf49595['properties'][_0x4cf99e];_0xf49595[_0x46cf19(0x13a)][_0x46cf19(0x173)]=_0x115630[_0x3be005]||0x0,_0xf49595[_0x46cf19(0x13a)]['totalBuildingArea']=Math['round'](_0xf49595[_0x46cf19(0x13a)][_0x46cf19(0x173)]*0x64)/0x64;}),resultGeojson=_0x35cf88;resultLayer&&(map[_0x3f75a1(0x1ad)](resultLayer),delete layerData[_0x3f75a1(0x193)]);_0x35cf88[_0x3f75a1(0x11e)][_0x3f75a1(0x1bd)](_0x5905cc=>{const _0x3837e0=_0x3f75a1,_0x10355c=_0x5905cc[_0x3837e0(0x13a)][_0x4cf99e];if(_0x42e303[_0x10355c]){_0x5905cc[_0x3837e0(0x13a)][_0x3837e0(0x1f3)]=_0x42e303[_0x10355c][_0x3837e0(0x1f3)];let _0x51b30a=_0x3837e0(0x18b);_0x42e303[_0x10355c]['buildingList'][_0x3837e0(0x1bd)](_0x36cb44=>{const _0xf25e89=_0x3837e0;_0x51b30a+=_0xf25e89(0x134)+_0x36cb44['id']+':\x20'+_0x36cb44[_0xf25e89(0x17a)]+_0xf25e89(0x1e1)+_0x36cb44[_0xf25e89(0x170)]+_0xf25e89(0x1ae)+_0x36cb44[_0xf25e89(0x1b1)]+_0xf25e89(0x18f);}),_0x5905cc[_0x3837e0(0x13a)]['calculationDetails']=_0x51b30a;}else _0x5905cc[_0x3837e0(0x13a)][_0x3837e0(0x1f3)]=0x0,_0x5905cc[_0x3837e0(0x13a)][_0x3837e0(0x13c)]=_0x3837e0(0x13f);}),addGeoJSONToMap(resultGeojson,_0x3f75a1(0x193),_0x3f75a1(0x10f));let _0x2fec5e=0x0,_0x54bf1c=0x0;Object[_0x3f75a1(0x160)](_0x42e303)[_0x3f75a1(0x1bd)](_0x176886=>{const _0x15bd84=_0x3f75a1;_0x2fec5e+=_0x42e303[_0x176886]['buildingCount'],_0x42e303[_0x176886][_0x15bd84(0x1d6)][_0x15bd84(0x1bd)](_0x6fd490=>{const _0x8a87a0=_0x15bd84;_0x54bf1c+=_0x6fd490[_0x8a87a0(0x1b1)];});}),document[_0x3f75a1(0x13e)](_0x3f75a1(0x10b))[_0x3f75a1(0x19a)]=_0x3f75a1(0x18e)+_0x2fec5e+_0x3f75a1(0x1df)+Math[_0x3f75a1(0x1dd)](_0x54bf1c*0x64)/0x64+_0x3f75a1(0x19b)+document[_0x3f75a1(0x13e)](_0x3f75a1(0x1ba))[_0x3f75a1(0x1ed)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x3f75a1(0x13e)]('step3Result')[_0x3f75a1(0x1f5)][_0x3f75a1(0x18a)]=_0x3f75a1(0x184),document[_0x3f75a1(0x13e)](_0x3f75a1(0x1b3))[_0x3f75a1(0x19d)]=![],document['getElementById'](_0x3f75a1(0x1a5))['style'][_0x3f75a1(0x18a)]=_0x3f75a1(0x1a1);}catch(_0x236c1d){console[_0x3f75a1(0x198)](_0x3f75a1(0x12a),_0x236c1d),alert(_0x3f75a1(0x1a6)+_0x236c1d[_0x3f75a1(0x1cc)]),document[_0x3f75a1(0x13e)](_0x3f75a1(0x1a5))[_0x3f75a1(0x1f5)]['display']=_0x3f75a1(0x1a1);}},0x64);}function processStep4(){const _0x19a5a3=_0x2b06f3;if(!resultGeojson){alert(_0x19a5a3(0x1de));return;}document[_0x19a5a3(0x13e)](_0x19a5a3(0x1a5))['style'][_0x19a5a3(0x18a)]=_0x19a5a3(0x184),setTimeout(()=>{const _0x50727d=_0x19a5a3;try{console['log']('Starting\x20step\x204\x20processing...');const _0x16bfc4=document[_0x50727d(0x13e)](_0x50727d(0x19e))[_0x50727d(0x1ed)],_0x4e9936=JSON[_0x50727d(0x123)](JSON[_0x50727d(0x1da)](resultGeojson));_0x4e9936['features'][_0x50727d(0x1bd)](_0x3e2bc4=>{const _0x14f2dd=_0x50727d,_0x13ada0=_0x3e2bc4[_0x14f2dd(0x13a)][_0x14f2dd(0x173)]||0x0,_0x4d92ff=_0x3e2bc4['properties'][_0x14f2dd(0x168)]||0x0;_0x4d92ff>0x0?_0x3e2bc4['properties'][_0x14f2dd(0x106)]=_0x13ada0/_0x4d92ff:_0x3e2bc4['properties']['FAR']=0x0,_0x3e2bc4[_0x14f2dd(0x13a)]['FAR']=Math[_0x14f2dd(0x1dd)](_0x3e2bc4['properties'][_0x14f2dd(0x106)]*0x3e8)/0x3e8;});resultLayer&&(map[_0x50727d(0x1ad)](resultLayer),delete layerData[_0x50727d(0x12c)]);addGeoJSONToMap(_0x4e9936,'finalResult',_0x50727d(0x1c9)),window[_0x50727d(0x1a3)]=_0x4e9936;let _0x18c764=0x0,_0x51ff11=0x0,_0x38909c=_0x4e9936[_0x50727d(0x11e)]['length'],_0x2335a8=0x0,_0x7023a4=[];_0x4e9936[_0x50727d(0x11e)][_0x50727d(0x1bd)](_0x21d509=>{const _0x4a2404=_0x50727d;_0x21d509[_0x4a2404(0x13a)]['parcelArea']>0x0&&(_0x18c764+=_0x21d509[_0x4a2404(0x13a)][_0x4a2404(0x168)],_0x51ff11+=_0x21d509[_0x4a2404(0x13a)][_0x4a2404(0x173)]||0x0,_0x21d509[_0x4a2404(0x13a)][_0x4a2404(0x106)]!==undefined&&_0x21d509[_0x4a2404(0x13a)][_0x4a2404(0x168)]>0x0&&_0x7023a4['push'](_0x21d509[_0x4a2404(0x13a)][_0x4a2404(0x106)]),_0x2335a8++);});const _0x449c3f=_0x7023a4['length']>0x0?_0x7023a4[_0x50727d(0x103)]((_0x25ca37,_0x1087ea)=>_0x25ca37+_0x1087ea,0x0)/_0x7023a4[_0x50727d(0x16a)]:0x0,_0xc05120=_0x7023a4[_0x50727d(0x16a)]>0x0?Math['max'](..._0x7023a4):0x0,_0xf671e7=_0x7023a4[_0x50727d(0x16a)]>0x0?Math[_0x50727d(0x10c)](..._0x7023a4):0x0;document[_0x50727d(0x13e)]('step4Result')[_0x50727d(0x19a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>FAR\x20calculated\x20per\x20parcel:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>FAR\x20=\x20totalBuildingArea\x20/\x20parcelArea</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Summary\x20Statistics:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Total\x20parcels:\x20'+_0x38909c+_0x50727d(0x187)+Math[_0x50727d(0x1dd)](_0x18c764*0x64)/0x64+'\x20sq.m</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Total\x20building\x20area:\x20'+Math[_0x50727d(0x1dd)](_0x51ff11*0x64)/0x64+_0x50727d(0x1db)+Math[_0x50727d(0x1dd)](_0x449c3f*0x3e8)/0x3e8+_0x50727d(0x132)+Math[_0x50727d(0x1dd)](_0xc05120*0x3e8)/0x3e8+_0x50727d(0x114)+Math[_0x50727d(0x1dd)](_0xf671e7*0x3e8)/0x3e8+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>CRS:\x20'+document[_0x50727d(0x13e)](_0x50727d(0x1ba))[_0x50727d(0x1ed)]+_0x50727d(0x1bc),document['getElementById'](_0x50727d(0x102))[_0x50727d(0x1f5)][_0x50727d(0x18a)]='block',document[_0x50727d(0x13e)]('exportButton')[_0x50727d(0x19d)]=![],document['getElementById']('exportExcelButton')[_0x50727d(0x19d)]=![],document[_0x50727d(0x13e)]('loadingIndicator')[_0x50727d(0x1f5)][_0x50727d(0x18a)]=_0x50727d(0x1a1);}catch(_0x2eece7){console[_0x50727d(0x198)](_0x50727d(0x156),_0x2eece7),alert(_0x50727d(0x1fc)+_0x2eece7['message']),document[_0x50727d(0x13e)]('loadingIndicator')[_0x50727d(0x1f5)]['display']=_0x50727d(0x1a1);}},0x64);}function exportResult(){const _0x908fbb=_0x2b06f3;if(!window[_0x908fbb(0x1a3)]){alert(_0x908fbb(0x202));return;}const _0x832d6e=JSON[_0x908fbb(0x123)](JSON[_0x908fbb(0x1da)](window[_0x908fbb(0x1a3)]));parcelGeojson&&parcelGeojson[_0x908fbb(0x10a)]?_0x832d6e[_0x908fbb(0x10a)]=parcelGeojson[_0x908fbb(0x10a)]:_0x832d6e[_0x908fbb(0x10a)]={'type':'name','properties':{'name':_0x908fbb(0x11c)}};_0x832d6e['properties']=_0x832d6e[_0x908fbb(0x13a)]||{},_0x832d6e[_0x908fbb(0x13a)][_0x908fbb(0x129)]=_0x908fbb(0x182);const _0x3117cc=new Blob([JSON[_0x908fbb(0x1da)](_0x832d6e)],{'type':_0x908fbb(0x11f)}),_0x243c6b=URL['createObjectURL'](_0x3117cc),_0x5c5fde=document[_0x908fbb(0x1fe)]('a');_0x5c5fde[_0x908fbb(0x112)]=_0x243c6b,_0x5c5fde[_0x908fbb(0x1ab)]=_0x908fbb(0x1f1),document[_0x908fbb(0x196)][_0x908fbb(0x1fd)](_0x5c5fde),_0x5c5fde['click'](),document[_0x908fbb(0x196)][_0x908fbb(0x11a)](_0x5c5fde),URL[_0x908fbb(0x10e)](_0x243c6b);}function exportExcel(){const _0x1fecca=_0x2b06f3;if(!window[_0x1fecca(0x1a3)]){alert(_0x1fecca(0x202));return;}const _0x5e7993=document[_0x1fecca(0x13e)](_0x1fecca(0x1ba))[_0x1fecca(0x1ed)],_0x2545a5=document[_0x1fecca(0x13e)](_0x1fecca(0x19e))['value']||'ID',_0x374c17=XLSX['utils'][_0x1fecca(0x1e4)](),_0x418368=window[_0x1fecca(0x1a3)][_0x1fecca(0x11e)][_0x1fecca(0x154)](_0x45b290=>{const _0xfd191f=_0x1fecca;return{[_0x2545a5]:_0x45b290[_0xfd191f(0x13a)][_0x2545a5],'Parcel\x20Area\x20(sq.m)':_0x45b290['properties'][_0xfd191f(0x168)],'Total\x20Building\x20Area\x20(sq.m)':_0x45b290[_0xfd191f(0x13a)][_0xfd191f(0x173)],'FAR':_0x45b290['properties'][_0xfd191f(0x106)],'Building\x20Count':_0x45b290[_0xfd191f(0x13a)][_0xfd191f(0x1f3)]||0x0};});let _0xb8f478=_0x418368['filter'](_0x10bd88=>_0x10bd88[_0x1fecca(0x1c5)]>0x0)[_0x1fecca(0x154)](_0x5718ed=>_0x5718ed[_0x1fecca(0x106)]);const _0x346ff2=_0xb8f478['length']>0x0?_0xb8f478[_0x1fecca(0x103)]((_0x20ccff,_0x56915f)=>_0x20ccff+_0x56915f,0x0)/_0xb8f478[_0x1fecca(0x16a)]:0x0,_0x47c578=_0xb8f478[_0x1fecca(0x16a)]>0x0?Math[_0x1fecca(0x108)](..._0xb8f478):0x0,_0x37c19b=_0xb8f478[_0x1fecca(0x16a)]>0x0?Math[_0x1fecca(0x10c)](..._0xb8f478):0x0;_0x418368['push']({}),_0x418368['push']({[_0x2545a5]:_0x1fecca(0x1cd)}),_0x418368[_0x1fecca(0x177)]({[_0x2545a5]:_0x1fecca(0x145),'FAR':Math[_0x1fecca(0x1dd)](_0x346ff2*0x3e8)/0x3e8}),_0x418368[_0x1fecca(0x177)]({[_0x2545a5]:_0x1fecca(0x163),'FAR':Math[_0x1fecca(0x1dd)](_0x47c578*0x3e8)/0x3e8}),_0x418368['push']({[_0x2545a5]:_0x1fecca(0x15f),'FAR':Math[_0x1fecca(0x1dd)](_0x37c19b*0x3e8)/0x3e8});const _0x2ad878=XLSX['utils'][_0x1fecca(0x1c6)](_0x418368);XLSX[_0x1fecca(0x12f)][_0x1fecca(0x205)](_0x374c17,_0x2ad878,'FAR\x20Analysis'),XLSX[_0x1fecca(0x171)](_0x374c17,_0x1fecca(0x1bb)+_0x5e7993[_0x1fecca(0x181)](':','_')+_0x1fecca(0x185));}function init(){const _0x42171e=_0x2b06f3;initMap(),document['getElementById'](_0x42171e(0x1ba))['addEventListener'](_0x42171e(0x1f8),function(){initMap();}),document[_0x42171e(0x13e)]('buildingFile')[_0x42171e(0x1fa)](_0x42171e(0x1f8),function(){const _0x36835a=_0x42171e;handleFileUpload(this,_0x36835a(0x17c));}),document[_0x42171e(0x13e)](_0x42171e(0x1ff))[_0x42171e(0x1fa)](_0x42171e(0x1f8),function(){const _0x556ef7=_0x42171e;handleFileUpload(this,_0x556ef7(0x158));}),document[_0x42171e(0x13e)](_0x42171e(0x124))[_0x42171e(0x1fa)](_0x42171e(0x1e3),processStep1),document[_0x42171e(0x13e)]('processStep2')[_0x42171e(0x1fa)](_0x42171e(0x1e3),processStep2),document[_0x42171e(0x13e)](_0x42171e(0x1c2))[_0x42171e(0x1fa)](_0x42171e(0x1e3),processStep3),document['getElementById'](_0x42171e(0x1b3))[_0x42171e(0x1fa)](_0x42171e(0x1e3),processStep4),document[_0x42171e(0x13e)]('exportButton')[_0x42171e(0x1fa)]('click',exportResult),document[_0x42171e(0x13e)](_0x42171e(0x200))[_0x42171e(0x1fa)](_0x42171e(0x1e3),exportExcel),document[_0x42171e(0x13e)](_0x42171e(0x1af))[_0x42171e(0x1fa)]('change',function(){const _0x5d6c54=_0x42171e;displayAttributes(this[_0x5d6c54(0x1ed)]);}),console[_0x42171e(0x195)]('Application\x20initialized\x20successfully!');}window[_0x2b06f3(0x191)]=init;function _0x2e36(){const _0x54c592=['\x20Attributes</h4>','block','.xlsx','Starting\x20step\x203\x20processing...','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Total\x20parcel\x20area:\x20','layerId','number','display','Buildings\x20calculation\x20details:\x0a','6wxJqzg','Proj','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Total\x20building\x20areas\x20calculated\x20per\x20parcel</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Total\x20buildings\x20processed:\x20','\x20sq.m\x0a','addTo','onload','#ffaa00','parcelsBuildingAreas','Starting\x20step\x202\x20processing...','log','body','+proj=utm\x20+zone=48\x20+datum=WGS84\x20+units=m\x20+no_defs','error','\x20sq.m</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>CRS:\x20','innerHTML','\x20sq.m</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Formula:\x20Building\x20Area\x20Ã—\x20Number\x20of\x20Floors\x20=\x20Total\x20Building\x20Area</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>CRS:\x20','layer','disabled','parcelFieldSelector','Starting\x20step\x201\x20processing...','options','none','checked','finalResultGeojson','<th>FID</th>','loadingIndicator','Error\x20processing\x20step\x203:\x20','type','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>Parcel\x20Area:</strong>\x20','\x20sq.m\x20total','#ff5500','download','layer-toggle','removeLayer','\x20floors\x20=\x20','layerSelect','fitBounds','totalArea','Error\x20processing\x20step\x201:\x20','processStep4','MultiPoint','Point','#ffff00','Map\x20initialized\x20with\x20CRS:\x20',',\x20Failed:\x20','LatLng','coordSystem','FAR_analysis_result_','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','forEach','Error\x20processing\x20step\x202:\x20','buildingStatus','files','toFixed','processStep3','remove','+proj=utm\x20+zone=47\x20+datum=WGS84\x20+units=m\x20+no_defs','Parcel\x20Area\x20(sq.m)','json_to_sheet','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','geoJSON','Final\x20Result\x20(FAR)','defs','Error\x20in\x20step\x201\x20processing:','message','SUMMARY\x20STATISTICS','#00ff00','\x20sq.m<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>FAR:</strong>\x20','Error\x20in\x20step\x202\x20processing:','geojson','div','rectangle','\x20building\x20points.\x20Success:\x20','layer-item','buildingList','2247735eRiceR','Land\x20Parcels','<p>No\x20attribute\x20data\x20available\x20for\x20this\x20layer.</p>','stringify','\x20sq.m</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Average\x20FAR:</strong>\x20','Buildings','round','Please\x20complete\x20step\x203\x20first.','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Total\x20building\x20area:\x20','Please\x20upload\x20building\x20and\x20parcel\x20files\x20first.','\x20sq.m\x20Ã—\x20','buildingStoreys','click','book_new','Error\x20in\x20pointInPolygon:','</th>','bindPopup','</table>','BL_NSTOREY','50764FjSdmL','mapDiv','Building\x20Points','value','circleMarker','Error\x20creating\x20point\x20for\x20building\x20','warn','FAR_analysis_result.geojson','Processing\x20parcel\x20','buildingCount','CRS','style','</tr>',':</strong>\x20','change','ImageryLabels','addEventListener','hasLayer','Error\x20processing\x20step\x204:\x20','appendChild','createElement','parcelFile','exportExcelButton','abs','Please\x20complete\x20step\x204\x20first.','string','<td>','book_append_sheet','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info-popup\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>','1773xVWTde','coordinates','basemapLayer','Please\x20complete\x20step\x202\x20first.','step4Result','reduce','\x20parcels</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Total\x20area:\x20',').\x20Do\x20you\x20want\x20to\x20continue\x20anyway?\x20If\x20not,\x20please\x20change\x20the\x20coordinate\x20system\x20and\x20try\x20again.','FAR','getBounds','max','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>Total\x20Building\x20Area:</strong>\x20','crs','step3Result','min','option','revokeObjectURL','Parcels\x20with\x20Building\x20Areas','Failed\x20to\x20calculate\x20areas\x20for\x20any\x20parcels.','Polygon','href','3896vomgFm','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Minimum\x20FAR:</strong>\x20','Failed\x20to\x20create\x20any\x20building\x20points.\x20Check\x20the\x20building\x20GeoJSON\x20data.','\x20sq.m','312EdjHZN','esri','addLayer','removeChild','\x20information','EPSG:4326','Error\x20parsing\x20GeoJSON\x20file.\x20Please\x20check\x20the\x20file\x20format.','features','application/json','readAsText','Please\x20select\x20a\x20parcel\x20field.','step2Result','parse','processStep1','<h4>','<strong>Calculation\x20Details:</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<pre\x20style=\x22max-height:\x20100px;\x20overflow-y:\x20auto;\x22>','<table\x20class=\x22attribute-table\x22>','#000000','targetProjection','Error\x20in\x20step\x203\x20processing:','<tr>','finalResult','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Parcel\x20areas\x20calculated\x20for\x20','textContent','utils','\x20sq.m</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Average\x20parcel\x20area:\x20','MultiLineString','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Maximum\x20FAR:</strong>\x20','2851240mcaewd','Building\x20','EPSG:32647','21EHICEO','FeatureCollection','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#ff0000','properties','parcelStatus','calculationDetails','<th>','getElementById','No\x20buildings\x20found\x20in\x20this\x20parcel','name','</div>','step1Result','\x20sq.m<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>Total\x20Building\x20Area:</strong>\x20','Error\x20processing\x20point\x20','Average\x20FAR','Parcel\x20','#000','Error\x20parsing\x20GeoJSON:','className','Feature','Unsupported\x20geometry\x20type:\x20','Please\x20upload\x20parcel\x20file\x20first.','label','\x20sq.m\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','LineString','parcelName','layerList','target','layer-label','map','Error\x20processing\x20building\x20','Error\x20in\x20step\x204\x20processing:','fieldSelectorContainer','parcel','buildingPoints','<i\x20class=\x22fas\x20fa-check-circle\x22></i>\x20','checkbox','773380HLxevB','Parcels\x20with\x20Area','geometry','Minimum\x20FAR','keys','321662eUfhFY','\x20-\x20Area:\x20','Maximum\x20FAR','reverse','result','<br>','attribution','parcelArea','Base\x20map\x20limited\x20in\x20UTM\x20projection.\x20Switch\x20to\x20EPSG:4326\x20for\x20full\x20basemap.','length','OBJECTID','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>Building\x20Count:</strong>\x20','BL_AREA','\x20loaded','</pre>','storeys','writeFile','color','totalBuildingArea','EPSG:32648','<strong>','</td>','push','14613VcUmIh','setView','area','parcelId','building','EPSG3857','Imagery','280alnMBh','MultiPolygon','replace','EPSG:32647\x20or\x20EPSG:32648\x20as\x20per\x20source\x20data'];_0x2e36=function(){return _0x54c592;};return _0x2e36();}
  </script>
</body>
</html>