<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบประมวลผลข้อมูลอาคาร</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">ระบบประมวลผลข้อมูลอาคาร</h1>
        <div class="mb-3">
            <label for="excelFile" class="form-label">นำเข้าไฟล์ Excel:</label>
            <input type="file" class="form-control" id="excelFile" accept=".xlsx, .xls">
        </div>
        <button id="processButton" class="btn btn-primary mb-3">ประมวลผล</button>
        <div id="progressContainer" class="d-none">
            <div class="progress mb-3">
                <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
            </div>
        </div>
        <button id="exportButton" class="btn btn-success d-none">นำออกไฟล์ Excel</button>
        <div class="container mt-5"></div>
        <a href="page3.html" class="btn btn-info mt-3">คำนวณพื้นที่การใช้ประโยชน์ที่ดิน</a>
    </div>
    <script>
const _0x267e0c=_0x2b5e;(function(_0xac75c9,_0x4b167e){const _0x1827b4=_0x2b5e,_0xddfcc7=_0xac75c9();while(!![]){try{const _0x33e99b=-parseInt(_0x1827b4(0x135))/0x1*(parseInt(_0x1827b4(0x12f))/0x2)+parseInt(_0x1827b4(0x118))/0x3*(parseInt(_0x1827b4(0x12d))/0x4)+-parseInt(_0x1827b4(0x115))/0x5+-parseInt(_0x1827b4(0x136))/0x6+-parseInt(_0x1827b4(0x117))/0x7+-parseInt(_0x1827b4(0x11c))/0x8+parseInt(_0x1827b4(0x122))/0x9*(parseInt(_0x1827b4(0x124))/0xa);if(_0x33e99b===_0x4b167e)break;else _0xddfcc7['push'](_0xddfcc7['shift']());}catch(_0x2f4448){_0xddfcc7['push'](_0xddfcc7['shift']());}}}(_0x1364,0x35d0e));const reuse2Data={'1000':'10','1100':'10','1101':'10','1102':'10','1103':'10','1121':'10','1122':'10','1123':'10','1131':'10','1132':'10','1200':'10','1300':'10','1310':'10','1320':'10','1330':'10','1340':'10','1350':'10','1800':'90','2000':'20','2100':'20','2200':'20','2210':'20','2220':'20','2230':'20','2231':'20','2232':'20','2233':'20','2234':'20','2240':'20','2241':'20','2250':'20','2251':'20','2260':'20','2270':'20','2280':'20','2300':'20','2301':'20','2302':'20','2400':'20','2410':'20','2420':'20','2480':'20','2500':'20','2800':'20','3000':'30','3100':'30','3110':'30','3120':'30','3300':'33','3310':'33','3311':'33','3321':'33','3322':'33','3800':'30','4100':'41','4110':'41','4120':'41','4121':'41','4122':'41','4123':'41','4180':'41','4200':'30','4300':'30','5000':'90','5130':'90','5140':'90','5150':'90','5160':'90','5180':'90','5200':'90','5210':'90','5220':'90','5230':'90','5300':'90','5310':'90','5320':'90','5330':'90','5400':'90','5410':'90','5420':'90','5430':'90','5440':'90','5500':'90','5510':'90','5520':'90','5800':'90','6000':'90','6100':'90','6105':'90','6110':'90','6120':'90','6130':'90','6140':'90','6141':'90','6142':'90','6143':'90','6150':'90','6160':'90','6180':'90','6200':'90','6210':'90','6220':'90','6230':'90','6240':'90','6250':'90','6260':'90','6270':'90','6280':'90','6300':'90','6310':'90','6320':'90','6330':'90','6340':'90','6350':'90','6360':'90','6370':'90','6380':'90','6381':'90','6382':'90','6383':'90','6400':'90','6500':'90','6510':'90','6530':'90','6580':'90','6600':'90','6610':'90','6620':'90','6630':'90','6640':'90','6650':'90','6660':'90','6800':'90','6830':'90','6831':'90','7000':'90','7200':'90','7210':'90','7220':'90','7300':'90','7310':'90','7320':'90','7321':'90','7322':'90','7323':'90','7324':'90','7330':'90','7380':'90','8000':'80','8170':'80','8180':'80','8190':'80','8310':'80','8500':'80','9991':'90','9993':'90','9998':'90','9999':'90'};let processedData=[];document[_0x267e0c(0x125)](_0x267e0c(0x12c))['addEventListener'](_0x267e0c(0x114),processExcel),document['getElementById']('exportButton')['addEventListener'](_0x267e0c(0x114),exportToExcel);function _0x1364(){const _0x366859=['result','พื้นที่ใช้สอย','onload','ProcessedData','BL_USE','readAsArrayBuffer','click','639660cIkSSZ','length','803334BIOEdA','153CdNVry','writeFile','processed_building_data.xlsx','round','1656392KVyAkH','width','style','remove','array','classList','558MbNhsx','files','121090CUDOSq','getElementById','Re_BL_CODE','Sheets','progressContainer','กรุณาเลือกไฟล์\x20Excel','book_append_sheet','read','processButton','13540ZVLDqp','utils','405836iYYXtA','book_new','BL_NSTOREY','aria-valuenow','d-none','map','1Fvyrln','301812zRGlxg','BL_AREA','progressBar'];_0x1364=function(){return _0x366859;};return _0x1364();}function processExcel(){const _0x18f9a8=_0x267e0c,_0x4519d0=document[_0x18f9a8(0x125)]('excelFile'),_0xedcc04=_0x4519d0[_0x18f9a8(0x123)][0x0];if(!_0xedcc04){alert(_0x18f9a8(0x129));return;}const _0x4a3fb1=new FileReader();_0x4a3fb1[_0x18f9a8(0x13b)]=function(_0x1f24b4){const _0x4c01d9=_0x18f9a8,_0x4c9d48=new Uint8Array(_0x1f24b4['target'][_0x4c01d9(0x139)]),_0x88969d=XLSX[_0x4c01d9(0x12b)](_0x4c9d48,{'type':_0x4c01d9(0x120)}),_0x1fe785=_0x88969d['SheetNames'][0x0],_0x377f77=_0x88969d[_0x4c01d9(0x127)][_0x1fe785],_0x313b6f=XLSX[_0x4c01d9(0x12e)]['sheet_to_json'](_0x377f77);processData(_0x313b6f);},_0x4a3fb1[_0x18f9a8(0x113)](_0xedcc04);}function _0x2b5e(_0x5290f2,_0x2b42b8){const _0x13643e=_0x1364();return _0x2b5e=function(_0x2b5e5e,_0x2c2a40){_0x2b5e5e=_0x2b5e5e-0x111;let _0x23fb7c=_0x13643e[_0x2b5e5e];return _0x23fb7c;},_0x2b5e(_0x5290f2,_0x2b42b8);}function processData(_0xdf4fbb){const _0x5ec4b5=_0x267e0c,_0x216446=document[_0x5ec4b5(0x125)](_0x5ec4b5(0x138)),_0x54687b=document[_0x5ec4b5(0x125)](_0x5ec4b5(0x128));_0x54687b['classList'][_0x5ec4b5(0x11f)](_0x5ec4b5(0x133)),processedData=_0xdf4fbb[_0x5ec4b5(0x134)]((_0x29d78b,_0x4386e9)=>{const _0xce9626=_0x5ec4b5,_0x273064=Math[_0xce9626(0x11b)]((_0x4386e9+0x1)/_0xdf4fbb[_0xce9626(0x116)]*0x64);_0x216446[_0xce9626(0x11e)][_0xce9626(0x11d)]=_0x273064+'%',_0x216446['setAttribute'](_0xce9626(0x132),_0x273064),_0x216446['textContent']=_0x273064+'%';const _0x2d9fb3={..._0x29d78b};return _0x2d9fb3['พื้นที่ใช้สอย']=_0x29d78b[_0xce9626(0x137)]*_0x29d78b[_0xce9626(0x131)],_0x2d9fb3[_0xce9626(0x126)]=reuse2Data[_0x29d78b[_0xce9626(0x112)]]||'',_0x2d9fb3['code']=determineCode(_0x2d9fb3),_0x2d9fb3;}),document[_0x5ec4b5(0x125)]('exportButton')[_0x5ec4b5(0x121)][_0x5ec4b5(0x11f)](_0x5ec4b5(0x133));}function determineCode(_0x3f051b){const _0x2b3869=_0x267e0c,{Re_BL_CODE:_0x3ee4bc,BL_TYPE:_0x5c01d1,BL_AREA:_0x31294f,BL_NSTOREY:_0x59627d}=_0x3f051b,_0xccdaa6=_0x3f051b[_0x2b3869(0x13a)];if(_0xccdaa6>=0x7d0){if(_0x3ee4bc==='10'&&_0x31294f>=0x65&&_0x31294f<=0x190)return 0x4;if(_0x3ee4bc==='10'&&_0x31294f>=0x191)return 0x5;if(_0x3ee4bc==='20'&&_0x31294f>=0x65&&_0x31294f<=0x190)return 0x2;if(_0x3ee4bc==='20'&&_0x31294f>=0x191)return 0x3;if(_0x3ee4bc==='41'&&_0x31294f>=0x65&&_0x31294f<=0x190)return 0x2;if(_0x3ee4bc==='41'&&_0x31294f>=0x191)return 0x3;}if(_0xccdaa6>=0x3e8&&_0x59627d>=0x5){if(_0x3ee4bc==='10'&&_0x31294f>=0x65&&_0x31294f<=0x190)return 0x4;if(_0x3ee4bc==='10'&&_0x31294f>=0x191)return 0x5;if(_0x3ee4bc==='20'&&_0x31294f>=0x65&&_0x31294f<=0x190)return 0x2;if(_0x3ee4bc==='20'&&_0x31294f>=0x191)return 0x3;if(_0x3ee4bc==='41'&&_0x31294f>=0x65&&_0x31294f<=0x190)return 0x2;if(_0x3ee4bc==='41'&&_0x31294f>=0x191)return 0x3;}if(_0x59627d>=0x8){if(_0x3ee4bc==='10'&&_0x31294f>=0x65&&_0x31294f<=0x190)return 0x4;if(_0x3ee4bc==='10'&&_0x31294f>=0x191)return 0x5;if(_0x3ee4bc==='20'&&_0x31294f>=0x65&&_0x31294f<=0x190)return 0x2;if(_0x3ee4bc==='20'&&_0x31294f>=0x191)return 0x3;if(_0x3ee4bc==='41'&&_0x31294f>=0x65&&_0x31294f<=0x190)return 0x2;if(_0x3ee4bc==='41'&&_0x31294f>=0x191)return 0x3;}if(_0x3ee4bc==='10'){if(_0x5c01d1===0x1||_0x5c01d1===0x2)return 0x1;if(_0x5c01d1===0x3||_0x5c01d1===0x4||_0x5c01d1===0x5)return 0x2;if(_0x5c01d1===0x6||_0x5c01d1===0x7||_0x5c01d1===0x8||_0x5c01d1===0x62)return 0x3;}if(_0x3ee4bc==='20'||_0x3ee4bc==='41')return 0x1;if(_0x3ee4bc==='30'){if(_0x31294f<=0xc8)return 0x1;if(_0x31294f>0xc8&&_0x31294f<=0x1f4)return 0x2;if(_0x31294f>0x1f4&&_0x31294f<=0x3e8)return 0x3;if(_0x31294f>0x3e8)return 0x4;}if(_0x3ee4bc==='33'){if(_0x31294f<=0x64)return 0x1;if(_0x31294f>0x64&&_0x31294f<=0x1f4)return 0x2;if(_0x31294f>0x1f4)return 0x3;}if(_0x3ee4bc==='80'||_0x3ee4bc==='90')return 0x1;return 0x0;}function exportToExcel(){const _0x2845dc=_0x267e0c,_0x516cd2=XLSX[_0x2845dc(0x12e)]['json_to_sheet'](processedData),_0x484bf7=XLSX[_0x2845dc(0x12e)][_0x2845dc(0x130)]();XLSX[_0x2845dc(0x12e)][_0x2845dc(0x12a)](_0x484bf7,_0x516cd2,_0x2845dc(0x111)),XLSX[_0x2845dc(0x119)](_0x484bf7,_0x2845dc(0x11a));}
    </script>
</body>
</html>
