<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RECLASS BLDG</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://me.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=qBZv9kqpas3uwSwMWeeaeUErDSGo8KpgrE71Y4TFTfK38njVNRWcX5TiVat6lQymsGbUQ2AZrtLSSvBwsL8K979MfZgwFKGrXx07mxLRh7uRb6PAyJXGdAc7TI_JqZTAEsbcZCy12yMPOdfC5AhcC8W_9u5IY8i_Wx8sanWFoEg0VC53UBo8LrYEGStODncxqEcFQ9Txsv0ELnGq3drLRSnciGE04FGwEJ39Vye2EMZIyhOdzP-I5Xa4llL4wu3c_GkJykPglypj0QZ_MbuzL-X0Hu1r6cOOxeD3-FhufJRyZ9WT7oHpRWR7SbEGiFeTJNocOyxi5l1HOh6BKB-Hol0keRDulafIneH377228jw-hQoeO0aYfVQTLaNEqMOX_Wd5Jw3Wq5kqcsxuCbKWOw" charset="UTF-8"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .gradient-bg {
            background: #f8fafc;
            min-height: 100vh;
        }
        
        .main-container {
            display: flex;
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }

        .left-section {
            flex: 1;
            position: relative;
            overflow: hidden;
            max-width: 65%;
        }

        .city-image {
            width: 100%;
            height: 100vh;
            object-fit: cover;
            object-position: center;
        }

        .right-section {
            flex: 1;
            max-width: 35%;
            padding: 2rem 3rem;
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
        }

        .title-container {
            margin-bottom: 2rem;
        }

        .controls-container {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .section-title {
            color: #134e4a;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .file-button {
            width: 100%;
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            color: #64748b;
            border-radius: 4px;
            transition: all 0.3s;
            background: #ffffff;
            text-align: left;
        }

        .process-button {
            width: 100%;
            padding: 0.5rem 1rem;
            background-color: #134e4a;
            color: white;
            border-radius: 4px;
            transition: all 0.3s;
            border: none;
            text-align: center;
        }

        .file-button:hover {
            border-color: #134e4a;
        }

        .process-button:hover {
            background-color: #115e59;
        }

        .fixed-buttons {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            display: flex;
            gap: 1rem;
        }

        .home-button, .landuse-button {
            background-color: #134e4a;
            color: white;
            padding: 0.75rem;
            border-radius: 9999px;
            transition: all 0.3s;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .landuse-button {
            padding: 0.75rem 1.5rem;
            white-space: nowrap;
        }

        .home-button:hover, .landuse-button:hover {
            background-color: #115e59;
            color: white;
        }

        .custom-progress {
            width: 100%;
            background-color: #f0fdfa;
            border-radius: 4px;
            padding: 2px;
            border: 1px solid #134e4a;
        }

        .custom-progress-bar {
            background-color: #134e4a;
            height: 16px;
            border-radius: 2px;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
        }

        .manual-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #134e4a;
            text-decoration: none;
            margin-top: 1rem;
            font-size: 0.9rem;
        }

        .manual-link:hover {
            color: #115e59;
        }

        .main-title {
            color: #134e4a;
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #1f2937;
            font-size: 1.1rem;
        }

        .file-name-display {
            font-size: 0.875rem;
            color: #475569;
            margin-top: 0.5rem;
            min-height: 1.25rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .file-input-container {
            width: 100%;
        }
    </style>
</head>
<body class="gradient-bg">
    <div class="main-container">
        <!-- Left Section -->
        <div class="left-section">
            <img src="city.png" alt="City skyline" class="city-image">
        </div>

        <!-- Right Section -->
        <div class="right-section">
            <div class="title-container">
                <h1 class="main-title">Reclass BLDG</h1>
                <h2 class="subtitle">จัดประเภทข้อมูลอาคาร</h2>
            </div>

            <div class="controls-container">
                <a href="Reclass BLDG Handbook.pdf" class="manual-link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                    </svg>
                    คู่มือการใช้งาน
                </a>

                <div class="mt-4">
                    <div class="section-title">ไฟล์อาคาร (Excel)</div>
                    <div class="file-input-container">
                        <input type="file" id="excelFile" accept=".xlsx, .xls" class="hidden" onchange="updateFileName(this)">
                        <button onclick="document.getElementById('excelFile').click()" class="file-button">
                            Choose File
                        </button>
                        <div id="fileName" class="file-name-display"></div>
                    </div>
                </div>

                <button id="processButton" class="process-button">
                    RECLASS
                </button>

                <div id="progressContainer" class="d-none w-full">
                    <div class="custom-progress">
                        <div id="progressBar" class="custom-progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                    </div>
                </div>

                <button id="exportButton" class="process-button d-none">
                    นำออกไฟล์อาคาร (Excel)
                </button>
            </div>
        </div>
    </div>

    <!-- Fixed buttons -->
    <div class="fixed-buttons">
        <a href="index.html" class="home-button">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
            </svg>
        </a>
        <a href="page3.html" class="landuse-button">
            Calculate Landuse
        </a>
    </div>

    <script>
const _0x5982f1=_0x1019;(function(_0xb7c518,_0x4fa5bc){const _0x2a1190=_0x1019,_0x1e03ea=_0xb7c518();while(!![]){try{const _0x1158e0=parseInt(_0x2a1190(0x17b))/0x1+parseInt(_0x2a1190(0x16b))/0x2+-parseInt(_0x2a1190(0x153))/0x3*(parseInt(_0x2a1190(0x195))/0x4)+-parseInt(_0x2a1190(0x183))/0x5+parseInt(_0x2a1190(0x16d))/0x6+-parseInt(_0x2a1190(0x18f))/0x7*(parseInt(_0x2a1190(0x16a))/0x8)+-parseInt(_0x2a1190(0x152))/0x9*(-parseInt(_0x2a1190(0x17c))/0xa);if(_0x1158e0===_0x4fa5bc)break;else _0x1e03ea['push'](_0x1e03ea['shift']());}catch(_0x1f04ea){_0x1e03ea['push'](_0x1e03ea['shift']());}}}(_0x50da,0x47dee));const plBlockPatterns={'อย.':_0x5982f1(0x198),'ย.1':_0x5982f1(0x172),'ย.2':_0x5982f1(0x191),'ย.3':_0x5982f1(0x158),'ย.4':'ย.4','ย.5':_0x5982f1(0x184),'ย.6':'ย.6','ย.7':'ย.7','ย.8':_0x5982f1(0x166),'พ.1':'พ.1','พ.2':'พ.2','พ.3':_0x5982f1(0x16c),'พ.4':_0x5982f1(0x176),'ขก.':_0x5982f1(0x169),'อ.1':_0x5982f1(0x18b),'อ.2':'อ.2','อ.3':_0x5982f1(0x190),'อ.4':_0x5982f1(0x17f),'ก.1':'ก.1','ก.2':_0x5982f1(0x170),'ก.3':_0x5982f1(0x164),'ก.4':_0x5982f1(0x181),'ก.5':_0x5982f1(0x185),'อก.':_0x5982f1(0x18e),'ปก.':_0x5982f1(0x177),'อท.':_0x5982f1(0x16e),'ล.':'ล.','ลล.':_0x5982f1(0x178),'สล.':'สล.','อป.':'อป.','ศษ.':_0x5982f1(0x155),'ลช.':_0x5982f1(0x186),'ลส.':_0x5982f1(0x162),'อศ.':'อศ.','ศน.':'ศน.','ส.':'ส.'};function checkPlBlock(_0x233764){const _0x566795=_0x5982f1;if(!_0x233764)return'';_0x233764=_0x233764['toString']();for(const [_0x14a00e,_0x52cd5f]of Object[_0x566795(0x151)](plBlockPatterns)){if(_0x233764[_0x566795(0x182)](_0x14a00e))return _0x52cd5f;}return'';}function _0x1019(_0x10660e,_0x190746){const _0x50dad2=_0x50da();return _0x1019=function(_0x10197f,_0x3c8776){_0x10197f=_0x10197f-0x148;let _0x41890b=_0x50dad2[_0x10197f];return _0x41890b;},_0x1019(_0x10660e,_0x190746);}const reuse2Data={'1000':'10','1100':'10','1101':'10','1102':'10','1103':'10','1121':'10','1122':'10','1123':'10','1131':'10','1132':'10','1200':'10','1300':'10','1310':'10','1320':'10','1330':'10','1340':'10','1350':'10','1800':'90','2000':'20','2100':'20','2200':'20','2210':'20','2220':'20','2230':'20','2231':'20','2232':'20','2233':'20','2234':'20','2240':'20','2241':'20','2250':'20','2251':'20','2260':'20','2270':'20','2280':'20','2300':'20','2301':'20','2302':'20','2400':'20','2410':'20','2420':'20','2480':'20','2500':'20','2800':'20','3000':'30','3100':'30','3110':'30','3120':'30','3300':'33','3310':'33','3311':'33','3321':'33','3322':'33','3800':'30','4100':'41','4110':'41','4120':'41','4121':'41','4122':'41','4123':'41','4180':'41','4200':'30','4300':'30','5000':'90','5130':'90','5140':'90','5150':'90','5160':'90','5180':'90','5200':'90','5210':'90','5220':'90','5230':'90','5300':'90','5310':'90','5320':'90','5330':'90','5400':'90','5410':'90','5420':'90','5430':'90','5440':'90','5500':'90','5510':'90','5520':'90','5800':'90','6000':'90','6100':'90','6105':'90','6110':'90','6120':'90','6130':'90','6140':'90','6141':'90','6142':'90','6143':'90','6150':'90','6160':'90','6180':'90','6200':'90','6210':'90','6220':'90','6230':'90','6240':'90','6250':'90','6260':'90','6270':'90','6280':'90','6300':'90','6310':'90','6320':'90','6330':'90','6340':'90','6350':'90','6360':'90','6370':'90','6380':'90','6381':'90','6382':'90','6383':'90','6400':'90','6500':'90','6510':'90','6530':'90','6580':'90','6600':'90','6610':'90','6620':'90','6630':'90','6640':'90','6650':'90','6660':'90','6800':'90','6830':'90','6831':'90','7000':'90','7200':'90','7210':'90','7220':'90','7300':'90','7310':'90','7320':'90','7321':'90','7322':'90','7323':'90','7324':'90','7330':'90','7380':'90','8000':'80','8170':'80','8180':'80','8190':'80','8310':'80','8500':'80','9991':'90','9993':'90','9998':'90','9999':'90'};let processedData=[];function convertToText(_0x8fd440){const _0x55bd32=_0x5982f1;if(_0x8fd440===null||_0x8fd440===undefined)return'';return _0x8fd440[_0x55bd32(0x156)]();}function processExcel(){const _0xa77c4a=_0x5982f1,_0x565e75=document[_0xa77c4a(0x15c)](_0xa77c4a(0x180)),_0x1e71da=_0x565e75['files'][0x0];if(!_0x1e71da){alert(_0xa77c4a(0x17e));return;}const _0x4b524e=new FileReader();_0x4b524e[_0xa77c4a(0x15f)]=function(_0xd144f9){const _0xb4af50=_0xa77c4a,_0x5c8c55=new Uint8Array(_0xd144f9['target'][_0xb4af50(0x193)]),_0x2e90dd=XLSX[_0xb4af50(0x194)](_0x5c8c55,{'type':_0xb4af50(0x149)}),_0x511cc8=_0x2e90dd['SheetNames'][0x0],_0x2c2392=_0x2e90dd[_0xb4af50(0x161)][_0x511cc8],_0x51094c=XLSX[_0xb4af50(0x15d)][_0xb4af50(0x14b)](_0x2c2392);processData(_0x51094c);},_0x4b524e[_0xa77c4a(0x192)](_0x1e71da);}function _0x50da(){const _0x6a5f54=['1170505iCUGVl','ย.5','ก.5','ลช.','remove','d-none','files','BL_AREA','อ.1','PL_BLOCK2','json_to_sheet','อก.','14231ESawKY','อ.3','ย.2','readAsArrayBuffer','result','read','274024LTGkub','classList','book_append_sheet','อย.','aria-valuenow','array','พื้นที่การใช้ประโยชน์อาคารรวม','sheet_to_json','BL_TYPE','ACQYEAR','PL_BLOCK','textContent','BL_NSTOREY','entries','2321199OqKaPz','6BYVeMU','processButton','ศษ.','toString','fileName','ย.3','length','round','addEventListener','getElementById','utils','writeFile','onload','setAttribute','Sheets','ลส.','exportButton','ก.3','BL_USE','ย.8','click','progressBar','ขก.','2040oxVlZR','167212opzFPw','พ.3','2575020OVdyWq','อท.','progressContainer','ก.2','bldg_reclass.xlsx','ย.1','RE_BL_AREA','RE_BL_USE','PL_USE','พ.4','ปก.','ลล.','style','name','413223RuVvXH','10yHvKEs','width','กรุณาเลือกไฟล์\x20Excel','อ.4','excelFile','ก.4','includes'];_0x50da=function(){return _0x6a5f54;};return _0x50da();}function processData(_0x4597ab){const _0x4e2d92=_0x5982f1,_0x3eec2d=document['getElementById'](_0x4e2d92(0x168)),_0x560872=document[_0x4e2d92(0x15c)](_0x4e2d92(0x16f));_0x560872[_0x4e2d92(0x196)][_0x4e2d92(0x187)](_0x4e2d92(0x188)),processedData=_0x4597ab['map']((_0x4d5bb8,_0x1e3741)=>{const _0x443ba7=_0x4e2d92,_0x52aae8=Math[_0x443ba7(0x15a)]((_0x1e3741+0x1)/_0x4597ab[_0x443ba7(0x159)]*0x64);_0x3eec2d[_0x443ba7(0x179)][_0x443ba7(0x17d)]=_0x52aae8+'%',_0x3eec2d[_0x443ba7(0x160)](_0x443ba7(0x148),_0x52aae8),_0x3eec2d[_0x443ba7(0x14f)]=_0x52aae8+'%';const _0x242ec1={..._0x4d5bb8};_0x242ec1[_0x443ba7(0x14c)]=convertToText(_0x4d5bb8['BL_TYPE']),_0x242ec1[_0x443ba7(0x165)]=convertToText(_0x4d5bb8[_0x443ba7(0x165)]),_0x242ec1[_0x443ba7(0x14d)]=convertToText(_0x4d5bb8[_0x443ba7(0x14d)]),_0x242ec1['PL_BLOCK']=convertToText(_0x4d5bb8[_0x443ba7(0x14e)]),_0x242ec1[_0x443ba7(0x175)]=convertToText(_0x4d5bb8[_0x443ba7(0x175)]),_0x242ec1[_0x443ba7(0x18c)]=checkPlBlock(_0x4d5bb8['PL_BLOCK']);const _0x54d7ef=parseFloat(_0x4d5bb8[_0x443ba7(0x18a)])||0x0,_0x16ff1c=parseFloat(_0x4d5bb8[_0x443ba7(0x150)])||0x0;return _0x242ec1[_0x443ba7(0x14a)]=_0x54d7ef*_0x16ff1c,_0x242ec1[_0x443ba7(0x174)]=reuse2Data[_0x4d5bb8['BL_USE']]||'',_0x242ec1[_0x443ba7(0x173)]=determineCode({..._0x242ec1,'BL_AREA':_0x54d7ef,'BL_NSTOREY':_0x16ff1c}),_0x242ec1;}),document['getElementById'](_0x4e2d92(0x163))[_0x4e2d92(0x196)][_0x4e2d92(0x187)](_0x4e2d92(0x188));}function determineCode(_0x3ce4a6){const _0x2a4e25=_0x5982f1,{RE_BL_USE:_0x4e48a9,BL_TYPE:_0x478196,BL_NSTOREY:_0x264d56}=_0x3ce4a6,_0x5df70d=parseFloat(_0x3ce4a6['BL_AREA'])||0x0,_0x278c09=_0x3ce4a6[_0x2a4e25(0x14a)];if(_0x278c09>=0x7d0){if(_0x4e48a9==='10'&&_0x5df70d>=0x65&&_0x5df70d<=0x190)return 0x4;if(_0x4e48a9==='10'&&_0x5df70d>=0x191)return 0x5;if(_0x4e48a9==='20'&&_0x5df70d>=0x65&&_0x5df70d<=0x190)return 0x2;if(_0x4e48a9==='20'&&_0x5df70d>=0x191)return 0x3;if(_0x4e48a9==='41'&&_0x5df70d>=0x65&&_0x5df70d<=0x190)return 0x2;if(_0x4e48a9==='41'&&_0x5df70d>=0x191)return 0x3;}if(_0x278c09>=0x3e8&&_0x264d56>=0x5){if(_0x4e48a9==='10'&&_0x5df70d>=0x65&&_0x5df70d<=0x190)return 0x4;if(_0x4e48a9==='10'&&_0x5df70d>=0x191)return 0x5;if(_0x4e48a9==='20'&&_0x5df70d>=0x65&&_0x5df70d<=0x190)return 0x2;if(_0x4e48a9==='20'&&_0x5df70d>=0x191)return 0x3;if(_0x4e48a9==='41'&&_0x5df70d>=0x65&&_0x5df70d<=0x190)return 0x2;if(_0x4e48a9==='41'&&_0x5df70d>=0x191)return 0x3;}if(_0x264d56>=0x8){if(_0x4e48a9==='10'&&_0x5df70d>=0x65&&_0x5df70d<=0x190)return 0x4;if(_0x4e48a9==='10'&&_0x5df70d>=0x191)return 0x5;if(_0x4e48a9==='20'&&_0x5df70d>=0x65&&_0x5df70d<=0x190)return 0x2;if(_0x4e48a9==='20'&&_0x5df70d>=0x191)return 0x3;if(_0x4e48a9==='41'&&_0x5df70d>=0x65&&_0x5df70d<=0x190)return 0x2;if(_0x4e48a9==='41'&&_0x5df70d>=0x191)return 0x3;}if(_0x4e48a9==='10'){if(_0x478196==='1'||_0x478196==='2')return 0x1;if(_0x478196==='3'||_0x478196==='4'||_0x478196==='5')return 0x2;if(_0x478196==='6')return 0x3;}if(_0x4e48a9==='20'||_0x4e48a9==='41')return 0x1;if(_0x4e48a9==='30'){if(_0x5df70d<=0xc8)return 0x1;if(_0x5df70d>0xc8&&_0x5df70d<=0x1f4)return 0x2;if(_0x5df70d>0x1f4&&_0x5df70d<=0x3e8)return 0x3;if(_0x5df70d>0x3e8)return 0x4;}if(_0x4e48a9==='33'){if(_0x5df70d<=0x64)return 0x1;if(_0x5df70d>0x64&&_0x5df70d<=0x1f4)return 0x2;if(_0x5df70d>0x1f4)return 0x3;}if(_0x4e48a9==='80'||_0x4e48a9==='90')return 0x1;return 0x0;}function exportToExcel(){const _0x3c43eb=_0x5982f1,_0x2297ee=XLSX[_0x3c43eb(0x15d)][_0x3c43eb(0x18d)](processedData),_0x4469d3=XLSX['utils']['book_new']();XLSX[_0x3c43eb(0x15d)][_0x3c43eb(0x197)](_0x4469d3,_0x2297ee,'ProcessedData'),XLSX[_0x3c43eb(0x15e)](_0x4469d3,_0x3c43eb(0x171));}function updateFileName(_0x4335ba){const _0x186dd8=_0x5982f1,_0x2f451c=document[_0x186dd8(0x15c)](_0x186dd8(0x157));_0x4335ba[_0x186dd8(0x189)]&&_0x4335ba[_0x186dd8(0x189)][0x0]?_0x2f451c[_0x186dd8(0x14f)]=_0x4335ba[_0x186dd8(0x189)][0x0][_0x186dd8(0x17a)]:_0x2f451c[_0x186dd8(0x14f)]='';}document[_0x5982f1(0x15c)](_0x5982f1(0x154))[_0x5982f1(0x15b)](_0x5982f1(0x167),processExcel),document[_0x5982f1(0x15c)](_0x5982f1(0x163))[_0x5982f1(0x15b)](_0x5982f1(0x167),exportToExcel);
    </script>
</body>
</html>