<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RECLASS BLDG</title>
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" as="style">
    <link rel="preload" href="city.png" as="image">
    
    <!-- Load CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    
    <!-- Defer non-critical scripts -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <style>
        .gradient-bg {
            background: #f8fafc;
            min-height: 100vh;
        }
        
        .main-container {
            display: flex;
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }

        .left-section {
            flex: 1;
            position: relative;
            overflow: hidden;
            max-width: 65%;
        }

        .city-image {
            width: 100%;
            height: 100vh;
            object-fit: cover;
            object-position: center;
        }

        .right-section {
            flex: 1;
            max-width: 35%;
            padding: 2rem 3rem;
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
        }

        .title-container {
            margin-bottom: 2rem;
        }

        .controls-container {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .section-title {
            color: #134e4a;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .file-button {
            width: 100%;
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            color: #64748b;
            border-radius: 4px;
            transition: all 0.3s;
            background: #ffffff;
            text-align: left;
        }

        .process-button {
            width: 100%;
            padding: 0.5rem 1rem;
            background-color: #134e4a;
            color: white;
            border-radius: 4px;
            transition: all 0.3s;
            border: none;
            text-align: center;
        }

        .file-button:hover {
            border-color: #134e4a;
        }

        .process-button:hover {
            background-color: #115e59;
        }

        .fixed-buttons {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            display: flex;
            gap: 1rem;
        }

        .home-button, .landuse-button {
            background-color: #134e4a;
            color: white;
            padding: 0.75rem;
            border-radius: 9999px;
            transition: all 0.3s;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .landuse-button {
            padding: 0.75rem 1.5rem;
            white-space: nowrap;
        }

        .home-button:hover, .landuse-button:hover {
            background-color: #115e59;
            color: white;
        }

        .custom-progress {
            width: 100%;
            background-color: #f0fdfa;
            border-radius: 4px;
            padding: 2px;
            border: 1px solid #134e4a;
        }

        .custom-progress-bar {
            background-color: #134e4a;
            height: 16px;
            border-radius: 2px;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
        }

        .manual-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #134e4a;
            text-decoration: none;
            margin-top: 1rem;
            font-size: 0.9rem;
        }

        .manual-link:hover {
            color: #115e59;
        }

        .main-title {
            color: #134e4a;
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #1f2937;
            font-size: 1.1rem;
        }

        .file-name-display {
            font-size: 0.875rem;
            color: #475569;
            margin-top: 0.5rem;
            min-height: 1.25rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .file-input-container {
            width: 100%;
        }
    </style>
</head>
<body class="gradient-bg">
    <div class="main-container">
        <!-- Left Section -->
        <div class="left-section">
            <img src="city.png" alt="City skyline" class="city-image">
        </div>

        <!-- Right Section -->
        <div class="right-section">
            <div class="title-container">
                <h1 class="main-title">Reclass BLDG</h1>
                <h2 class="subtitle">จัดประเภทข้อมูลอาคาร</h2>
            </div>

            <div class="controls-container">
                <a href="Reclass BLDG Handbook.pdf" class="manual-link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                    </svg>
                    คู่มือการใช้งาน
                </a>

                <div class="mt-4">
                    <div class="section-title">ไฟล์อาคาร (Excel)</div>
                    <div class="file-input-container">
                        <input type="file" id="excelFile" accept=".xlsx, .xls" class="hidden">
                        <button onclick="document.getElementById('excelFile').click()" class="file-button">
                            Choose File
                        </button>
                        <div id="fileName" class="file-name-display"></div>
                    </div>
                </div>

                <button id="processButton" class="process-button">
                    RECLASS
                </button>

                <div id="progressContainer" class="d-none w-full">
                    <div class="custom-progress">
                        <div id="progressBar" class="custom-progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                    </div>
                </div>

                <button id="exportButton" class="process-button d-none">
                    นำออกไฟล์อาคาร (Excel)
                </button>
            </div>
        </div>
    </div>

    <!-- Fixed buttons -->
    <div class="fixed-buttons">
        <a href="index.html" class="home-button">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
            </svg>
        </a>
        <a href="page3.html" class="landuse-button">
            Calculate Landuse
        </a>
    </div>

    <script>
const _0x2476bf=_0x3d63;(function(_0x9c72bb,_0xc10fce){const _0x33ca1b=_0x3d63,_0x220bb3=_0x9c72bb();while(!![]){try{const _0x3f70a1=parseInt(_0x33ca1b(0xf4))/0x1+-parseInt(_0x33ca1b(0x105))/0x2+-parseInt(_0x33ca1b(0x10a))/0x3*(parseInt(_0x33ca1b(0xdd))/0x4)+parseInt(_0x33ca1b(0xcb))/0x5+parseInt(_0x33ca1b(0xcc))/0x6*(parseInt(_0x33ca1b(0xf1))/0x7)+-parseInt(_0x33ca1b(0xd0))/0x8*(parseInt(_0x33ca1b(0xda))/0x9)+parseInt(_0x33ca1b(0x108))/0xa*(parseInt(_0x33ca1b(0xd6))/0xb);if(_0x3f70a1===_0xc10fce)break;else _0x220bb3['push'](_0x220bb3['shift']());}catch(_0x795b71){_0x220bb3['push'](_0x220bb3['shift']());}}}(_0x3ebb,0x7b747));const plBlockPatterns={'อย.':_0x2476bf(0xce),'ย.1':_0x2476bf(0xe3),'ย.2':_0x2476bf(0xe0),'ย.3':'ย.3','ย.4':_0x2476bf(0xd9),'ย.5':'ย.5','ย.6':_0x2476bf(0xdf),'ย.7':'ย.7','ย.8':_0x2476bf(0xc7),'พ.1':_0x2476bf(0xcf),'พ.2':_0x2476bf(0xfa),'พ.3':_0x2476bf(0x100),'พ.4':_0x2476bf(0xc3),'ขก.':_0x2476bf(0xfc),'อ.1':_0x2476bf(0xd4),'อ.2':_0x2476bf(0x10d),'อ.3':_0x2476bf(0xf0),'อ.4':_0x2476bf(0xee),'ก.1':_0x2476bf(0xc8),'ก.2':_0x2476bf(0x10b),'ก.3':'ก.3','ก.4':_0x2476bf(0xea),'ก.5':_0x2476bf(0xf7),'อก.':'อก.','ปก.':_0x2476bf(0xc5),'อท.':'อท.','ล.':'ล.','ลล.':_0x2476bf(0xff),'สล.':'สล.','อป.':_0x2476bf(0xe4),'ศษ.':_0x2476bf(0xef),'ลช.':'ลช.','ลส.':_0x2476bf(0xd5),'อศ.':_0x2476bf(0xc6),'ศน.':_0x2476bf(0xf3),'ส.':'ส.'},reuse2Data={'1000':'10','1100':'10','1101':'10','1102':'10','1103':'10','1121':'10','1122':'10','1123':'10','1131':'10','1132':'10','1200':'10','1300':'10','1310':'10','1320':'10','1330':'10','1340':'10','1350':'10','1800':'90','2000':'20','2100':'20','2200':'20','2210':'20','2220':'20','2230':'20','2231':'20','2232':'20','2233':'20','2234':'20','2240':'20','2241':'20','2250':'20','2251':'20','2260':'20','2270':'20','2280':'20','2300':'20','2301':'20','2302':'20','2400':'20','2410':'20','2420':'20','2480':'20','2500':'20','2800':'20','3000':'30','3100':'30','3110':'30','3120':'30','3300':'33','3310':'33','3311':'33','3321':'33','3322':'33','3800':'30','4100':'41','4110':'41','4120':'41','4121':'41','4122':'41','4123':'41','4180':'41','4200':'30','4300':'30','5000':'90','5130':'90','5140':'90','5150':'90','5160':'90','5180':'90','5200':'90','5210':'90','5220':'90','5230':'90','5300':'90','5310':'90','5320':'90','5330':'90','5400':'90','5410':'90','5420':'90','5430':'90','5440':'90','5500':'90','5510':'90','5520':'90','5800':'90','6000':'90','6100':'90','6105':'90','6110':'90','6120':'90','6130':'90','6140':'90','6141':'90','6142':'90','6143':'90','6150':'90','6160':'90','6180':'90','6200':'90','6210':'90','6220':'90','6230':'90','6240':'90','6250':'90','6260':'90','6270':'90','6280':'90','6300':'90','6310':'90','6320':'90','6330':'90','6340':'90','6350':'90','6360':'90','6370':'90','6380':'90','6381':'90','6382':'90','6383':'90','6400':'90','6500':'90','6510':'90','6530':'90','6580':'90','6600':'90','6610':'90','6620':'90','6630':'90','6640':'90','6650':'90','6660':'90','6800':'90','6830':'90','6831':'90','7000':'90','7200':'90','7210':'90','7220':'90','7300':'90','7310':'90','7320':'90','7321':'90','7322':'90','7323':'90','7324':'90','7330':'90','7380':'90','8000':'80','8170':'80','8180':'80','8190':'80','8310':'80','8500':'80','9991':'90','9993':'90','9998':'90','9999':'90'};let processedData=[];const $fileInput=document[_0x2476bf(0xd7)](_0x2476bf(0xd3)),$fileName=document[_0x2476bf(0xd7)](_0x2476bf(0xe8)),$progressBar=document[_0x2476bf(0xd7)]('progressBar'),$progressContainer=document['getElementById'](_0x2476bf(0xeb)),$exportButton=document[_0x2476bf(0xd7)]('exportButton'),plBlockPatternsArray=Object['entries'](plBlockPatterns),reuse2DataCache=new Map();function checkPlBlock(_0x1838d7){if(!_0x1838d7)return'';_0x1838d7=_0x1838d7['toString']();for(const [_0x16d2bf,_0x4ab8ad]of plBlockPatternsArray){if(_0x1838d7['includes'](_0x16d2bf))return _0x4ab8ad;}return'';}function _0x3d63(_0x463dcf,_0x67b922){const _0x3ebb6d=_0x3ebb();return _0x3d63=function(_0x3d632b,_0x457be2){_0x3d632b=_0x3d632b-0xc2;let _0x40d7f5=_0x3ebb6d[_0x3d632b];return _0x40d7f5;},_0x3d63(_0x463dcf,_0x67b922);}function safeParseFloat(_0xfb4f1b){return _0xfb4f1b?+_0xfb4f1b||0x0:0x0;}let lastProgress=0x0;function updateProgress(_0x1def52,_0x154135){const _0x2bc26f=_0x2476bf,_0x4821ec=Math[_0x2bc26f(0xfb)]((_0x1def52+0x1)/_0x154135*0x64);_0x4821ec!==lastProgress&&(requestAnimationFrame(()=>{const _0x263f9f=_0x2bc26f;$progressBar[_0x263f9f(0xe1)][_0x263f9f(0x104)]=_0x4821ec+'%',$progressBar[_0x263f9f(0xe9)](_0x263f9f(0xdc),_0x4821ec),$progressBar[_0x263f9f(0xf2)]=_0x4821ec+'%';}),lastProgress=_0x4821ec);}function determineCode(_0xe59c1){const {RE_BL_USE:_0x490640,BL_TYPE:_0x4c46d1,BL_NSTOREY:_0x106661}=_0xe59c1,_0x13be75=safeParseFloat(_0xe59c1['BL_AREA']),_0x16304e=_0xe59c1['พื้นที่การใช้ประโยชน์อาคารรวม'];if(_0x16304e>=0x7d0){if(_0x490640==='10'&&_0x13be75>=0x65&&_0x13be75<=0x190)return 0x4;if(_0x490640==='10'&&_0x13be75>=0x191)return 0x5;if(_0x490640==='20'&&_0x13be75>=0x65&&_0x13be75<=0x190)return 0x2;if(_0x490640==='20'&&_0x13be75>=0x191)return 0x3;if(_0x490640==='41'&&_0x13be75>=0x65&&_0x13be75<=0x190)return 0x2;if(_0x490640==='41'&&_0x13be75>=0x191)return 0x3;}if(_0x16304e>=0x3e8&&_0x106661>=0x5){if(_0x490640==='10'&&_0x13be75>=0x65&&_0x13be75<=0x190)return 0x4;if(_0x490640==='10'&&_0x13be75>=0x191)return 0x5;if(_0x490640==='20'&&_0x13be75>=0x65&&_0x13be75<=0x190)return 0x2;if(_0x490640==='20'&&_0x13be75>=0x191)return 0x3;if(_0x490640==='41'&&_0x13be75>=0x65&&_0x13be75<=0x190)return 0x2;if(_0x490640==='41'&&_0x13be75>=0x191)return 0x3;}if(_0x106661>=0x8){if(_0x490640==='10'&&_0x13be75>=0x65&&_0x13be75<=0x190)return 0x4;if(_0x490640==='10'&&_0x13be75>=0x191)return 0x5;if(_0x490640==='20'&&_0x13be75>=0x65&&_0x13be75<=0x190)return 0x2;if(_0x490640==='20'&&_0x13be75>=0x191)return 0x3;if(_0x490640==='41'&&_0x13be75>=0x65&&_0x13be75<=0x190)return 0x2;if(_0x490640==='41'&&_0x13be75>=0x191)return 0x3;}if(_0x490640==='10'){if(_0x4c46d1==='1'||_0x4c46d1==='2')return 0x1;if(_0x4c46d1==='3'||_0x4c46d1==='4'||_0x4c46d1==='5')return 0x2;if(_0x4c46d1==='6')return 0x3;}if(_0x490640==='20'||_0x490640==='41')return 0x1;if(_0x490640==='30'){if(_0x13be75<=0xc8)return 0x1;if(_0x13be75>0xc8&&_0x13be75<=0x1f4)return 0x2;if(_0x13be75>0x1f4&&_0x13be75<=0x3e8)return 0x3;if(_0x13be75>0x3e8)return 0x4;}if(_0x490640==='33'){if(_0x13be75<=0x64)return 0x1;if(_0x13be75>0x64&&_0x13be75<=0x1f4)return 0x2;if(_0x13be75>0x1f4)return 0x3;}if(_0x490640==='80'||_0x490640==='90')return 0x1;return 0x0;}function processData(_0x37ca2e){const _0x31127c=_0x2476bf;$progressContainer['classList'][_0x31127c(0x106)](_0x31127c(0x103));const _0x128d96=_0x37ca2e[_0x31127c(0xde)];processedData=new Array(_0x128d96);for(let _0x56717e=0x0;_0x56717e<_0x128d96;_0x56717e++){const _0xc21c8=_0x37ca2e[_0x56717e];updateProgress(_0x56717e,_0x128d96);const _0x221ab7=safeParseFloat(_0xc21c8[_0x31127c(0xf8)]),_0x5dd682=safeParseFloat(_0xc21c8[_0x31127c(0x10c)]),_0x3fcfbc=_0x221ab7*_0x5dd682;let _0x59e131=reuse2DataCache['get'](_0xc21c8[_0x31127c(0x10f)]);_0x59e131===undefined&&(_0x59e131=reuse2Data[_0xc21c8[_0x31127c(0x10f)]]||'',reuse2DataCache[_0x31127c(0x101)](_0xc21c8[_0x31127c(0x10f)],_0x59e131)),processedData[_0x56717e]={..._0xc21c8,'BL_TYPE':String(_0xc21c8['BL_TYPE']||''),'BL_USE':String(_0xc21c8[_0x31127c(0x10f)]||''),'ACQYEAR':String(_0xc21c8[_0x31127c(0xec)]||''),'PL_BLOCK':String(_0xc21c8[_0x31127c(0xe6)]||''),'PL_USE':String(_0xc21c8[_0x31127c(0xe5)]||''),'PL_BLOCK2':checkPlBlock(_0xc21c8[_0x31127c(0xe6)]),'พื้นที่การใช้ประโยชน์อาคารรวม':_0x3fcfbc,'RE_BL_USE':_0x59e131,'RE_BL_AREA':determineCode({'RE_BL_USE':_0x59e131,'BL_TYPE':String(_0xc21c8[_0x31127c(0xed)]||''),'BL_NSTOREY':_0x5dd682,'BL_AREA':_0x221ab7,'พื้นที่การใช้ประโยชน์อาคารรวม':_0x3fcfbc})};}$exportButton[_0x31127c(0x102)][_0x31127c(0x106)](_0x31127c(0x103));}const excelWorker=new Worker(URL[_0x2476bf(0xe2)](new Blob([_0x2476bf(0xfd)],{'type':_0x2476bf(0x107)})));excelWorker[_0x2476bf(0xc4)]=function(_0x1aebe4){processData(_0x1aebe4['data']);};function processExcel(){const _0x3475fc=_0x2476bf,_0x351459=$fileInput[_0x3475fc(0xc2)][0x0];if(!_0x351459){alert(_0x3475fc(0xd2));return;}const _0x422c6a=new FileReader();_0x422c6a[_0x3475fc(0xdb)]=function(_0x1e7e99){const _0x4b076e=_0x3475fc;excelWorker[_0x4b076e(0xf5)](_0x1e7e99[_0x4b076e(0x10e)][_0x4b076e(0x109)]);},_0x422c6a['readAsArrayBuffer'](_0x351459);}function exportToExcel(){const _0x144edf=_0x2476bf,_0x2f014b=XLSX[_0x144edf(0xca)]['json_to_sheet'](processedData),_0x34078c=XLSX[_0x144edf(0xca)][_0x144edf(0xe7)]();XLSX[_0x144edf(0xca)]['book_append_sheet'](_0x34078c,_0x2f014b,'ProcessedData'),XLSX[_0x144edf(0xd8)](_0x34078c,'bldg_reclass.xlsx');}document[_0x2476bf(0xf9)](_0x2476bf(0xc9),function(){const _0xd82735=_0x2476bf;document[_0xd82735(0xd7)](_0xd82735(0xf6))[_0xd82735(0xf9)](_0xd82735(0xcd),processExcel),document[_0xd82735(0xd7)]('exportButton')[_0xd82735(0xf9)](_0xd82735(0xcd),exportToExcel),$fileInput[_0xd82735(0xf9)](_0xd82735(0xfe),function(){const _0x173cb6=_0xd82735;$fileName[_0x173cb6(0xf2)]=this[_0x173cb6(0xc2)][0x0]?.[_0x173cb6(0xd1)]||'';});});function _0x3ebb(){const _0x2cecff=['3914730LnoWGj','click','อย.','พ.1','5143576CWmeaO','name','กรุณาเลือกไฟล์\x20Excel','excelFile','อ.1','ลส.','88rdtyjy','getElementById','writeFile','ย.4','9qehozO','onload','aria-valuenow','12wscZFT','length','ย.6','ย.2','style','createObjectURL','ย.1','อป.','PL_USE','PL_BLOCK','book_new','fileName','setAttribute','ก.4','progressContainer','ACQYEAR','BL_TYPE','อ.4','ศษ.','อ.3','7MGZxzA','textContent','ศน.','303573ftTAzU','postMessage','processButton','ก.5','BL_AREA','addEventListener','พ.2','round','ขก.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20importScripts(\x27https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onmessage\x20=\x20function(e)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20data\x20=\x20new\x20Uint8Array(e.data);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20workbook\x20=\x20XLSX.read(data,\x20{type:\x20\x27array\x27});\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20worksheet\x20=\x20workbook.Sheets[workbook.SheetNames[0]];\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20jsonData\x20=\x20XLSX.utils.sheet_to_json(worksheet);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20postMessage(jsonData);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20','change','ลล.','พ.3','set','classList','d-none','width','303492Thgnyt','remove','text/javascript','697460CvuNqG','result','575103RjsLOh','ก.2','BL_NSTOREY','อ.2','target','BL_USE','files','พ.4','onmessage','ปก.','อศ.','ย.8','ก.1','DOMContentLoaded','utils','1807355qPOpPr'];_0x3ebb=function(){return _0x2cecff;};return _0x3ebb();}
    </script>
</body>
</html>            