<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculate Landuse</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background-color: rgb(249, 250, 251);
        }
        table { 
            border-collapse: collapse; 
            width: 100%; 
        }
        th, td { 
            border: 1px solid #ddd; 
            padding: 8px; 
            text-align: left; 
        }
        tr:nth-child(even) { 
            background-color: #f2f2f2; 
        }
        .filter-container { 
            margin-bottom: 20px; 
        }
        .checkbox-group { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 10px; 
        }
        .total-row { 
            background-color: #e6f2ff; 
            font-weight: bold; 
        }
        .main-container {
            padding: 1rem;
            min-height: 100vh;
            width: 100%;
        }
        .content-wrapper {
            width: 100%;
        }
        .header-button {
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 500;
            transition: all 0.2s;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 120px;
            white-space: nowrap;
            cursor: pointer;
            border: none;
        }
        .header-button.primary {
            background-color: #1e40af;
            color: white;
        }
        .header-button.primary:hover {
            background-color: #1e3a8a;
        }
        .header-button.home {
            background-color: #1e40af;
            color: white;
            min-width: 40px;
            padding: 8px;
        }
        .header-button.home:hover {
            background-color: #1e3a8a;
        }
        .header-buttons-container {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-left: auto;
            padding: 4px;
        }
        
        input[type="file"] {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            border-radius: 0.375rem;
            width: 100%;
            background-color: white;
        }
        input[type="file"]:hover {
            border-color: #cbd5e0;
        }
        select {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            border-radius: 0.375rem;
            width: 100%;
            max-width: 20rem;
            background-color: white;
        }
        .action-button {
            padding: 8px 16px;
            background-color: #1e40af;
            color: white;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: background-color 0.2s;
        }
        .action-button:hover {
            background-color: #1e3a8a;
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            .header-buttons-container {
                width: 100%;
                justify-content: flex-start;
                margin-left: 0;
            }
            .grid-cols-2 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="content-wrapper">
            <!-- Header Section -->
            <div class="header-container flex justify-between items-center mb-6">
                <div class="flex items-center gap-2">
                    <h1 class="text-2xl font-bold text-blue-700">Calculate Landuse</h1>
                    <h2 class="text-lg text-gray-600">คำนวณพื้นที่การใช้ประโยชน์ที่ดิน</h2>
                </div>
                <div class="header-buttons-container">
                    <button onclick="window.location.href='page2.html'" class="header-button primary">
                        Reclass BLDG
                    </button>
                    <button onclick="window.location.href='page5.html'" class="header-button primary">
                        PREP PLLU
                    </button>
                    <button onclick="window.location.href='index.html'" class="header-button home" aria-label="Home">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                            <polyline points="9 22 9 12 15 12 15 22"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Manual Link -->
            <div class="flex items-center gap-2 mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-700">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                </svg>
                <a href="page.html" class="text-blue-700 hover:underline">
                    คู่มือการใช้งาน
                </a>
            </div>

            <!-- Main Content Card -->
            <div class="bg-white shadow p-6 mb-6">
                <!-- File Upload Section -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">ไฟล์อาคาร (Excel):</label>
                        <input type="file" id="buildingFile" accept=".xlsx, .xls">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">ไฟล์ pllu (Excel):</label>
                        <input type="file" id="plluFile" accept=".xlsx, .xls">
                    </div>
                </div>

                <!-- Info Text -->
                <div class="mb-6 text-sm text-gray-600">
                    กรณีต้องการเรียงรายการตามบริเวณ/ประเภทการใช้ประโยชน์ที่ดิน ให้คลิกปุ่ม PREP PLLU แล้วนำผลลัพธ์ที่ได้มาใส่ในช่อง upload ไฟล์ pllu
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-4 mb-6">
                    <button onclick="processFiles()" class="action-button">
                        Calculate
                    </button>
                    <button onclick="exportToExcel()" class="action-button">
                        นำออกไฟล์ผลการใช้ประโยชน์ที่ดิน (Excel)
                    </button>
                </div>

                <!-- Filter Section -->
                <div class="grid gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">กรองตาม PL_USE:</label>
                        <select id="pl-use-filter">
                            <option value="all">ทั้งหมด</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">กรองตาม ACQYEAR:</label>
                        <div id="acqyear-filter" class="checkbox-group"></div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">กรองตาม RE_BL_USE:</label>
                        <div id="re-bl-use-filter" class="checkbox-group"></div>
                    </div>
                </div>
            </div>

            <!-- Table Container -->
            <div id="tableContainer" class="bg-white shadow w-full"></div>
        </div>
    </div>

    <script>
(function(_0x38265f,_0x28bb7c){const _0x204108=_0x3922,_0x3aff46=_0x38265f();while(!![]){try{const _0x3eeae6=-parseInt(_0x204108(0x237))/0x1+-parseInt(_0x204108(0x1f1))/0x2+parseInt(_0x204108(0x210))/0x3+parseInt(_0x204108(0x234))/0x4*(parseInt(_0x204108(0x22c))/0x5)+parseInt(_0x204108(0x1ea))/0x6*(parseInt(_0x204108(0x1ef))/0x7)+-parseInt(_0x204108(0x1e9))/0x8*(parseInt(_0x204108(0x238))/0x9)+-parseInt(_0x204108(0x23f))/0xa*(-parseInt(_0x204108(0x20e))/0xb);if(_0x3eeae6===_0x28bb7c)break;else _0x3aff46['push'](_0x3aff46['shift']());}catch(_0xf7d07c){_0x3aff46['push'](_0x3aff46['shift']());}}}(_0x11b4,0xdf036));let buildingData,plluData;function processFiles(){const _0x468a5b=_0x3922,_0x2810bd=document['getElementById'](_0x468a5b(0x235))[_0x468a5b(0x206)][0x0],_0x3a9fbd=document[_0x468a5b(0x21e)](_0x468a5b(0x20b))[_0x468a5b(0x206)][0x0];if(!_0x2810bd||!_0x3a9fbd){alert(_0x468a5b(0x1f4));return;}const _0xcc8b35=new FileReader();_0xcc8b35[_0x468a5b(0x20d)]=function(_0x1d8efd){const _0x1d20c9=_0x468a5b,_0x2f496d=new Uint8Array(_0x1d8efd[_0x1d20c9(0x22a)][_0x1d20c9(0x1f9)]),_0x7c60bd=XLSX[_0x1d20c9(0x236)](_0x2f496d,{'type':_0x1d20c9(0x211)});buildingData=XLSX[_0x1d20c9(0x1e8)][_0x1d20c9(0x21b)](_0x7c60bd[_0x1d20c9(0x229)][_0x7c60bd[_0x1d20c9(0x240)][0x0]]);const _0x184d30=new FileReader();_0x184d30['onload']=function(_0x4bb557){const _0x402939=_0x1d20c9,_0x5c155b=new Uint8Array(_0x4bb557[_0x402939(0x22a)][_0x402939(0x1f9)]),_0x156225=XLSX[_0x402939(0x236)](_0x5c155b,{'type':'array'});plluData=XLSX['utils'][_0x402939(0x21b)](_0x156225[_0x402939(0x229)][_0x156225[_0x402939(0x240)][0x0]]),setupFilters(),calculateAndDisplayTable();},_0x184d30[_0x1d20c9(0x225)](_0x3a9fbd);},_0xcc8b35[_0x468a5b(0x225)](_0x2810bd);}function setupFilters(){const _0x4bc062=_0x3922,_0x22f463=document[_0x4bc062(0x21e)](_0x4bc062(0x1ee)),_0x1cb7dd=document[_0x4bc062(0x21e)](_0x4bc062(0x232)),_0x5b487e=document[_0x4bc062(0x21e)]('re-bl-use-filter'),_0x4156b0=[...new Set(plluData[_0x4bc062(0x215)](_0x539b12=>_0x539b12[_0x4bc062(0x20a)]))];_0x4156b0[_0x4bc062(0x220)](_0x3f41fe=>{const _0x543654=_0x4bc062,_0x252868=document['createElement'](_0x543654(0x23b));_0x252868[_0x543654(0x209)]=_0x3f41fe,_0x252868[_0x543654(0x1fd)]=_0x3f41fe,_0x22f463[_0x543654(0x1ff)](_0x252868);});const _0x57cf3e=[...new Set(buildingData['map'](_0x516dcd=>_0x516dcd['ACQYEAR']))];_0x57cf3e[_0x4bc062(0x220)](_0x3e0828=>{const _0x44dbb4=_0x4bc062,_0x4463bc=document[_0x44dbb4(0x1ed)](_0x44dbb4(0x1eb));_0x4463bc['type']='checkbox',_0x4463bc['id']=_0x44dbb4(0x23e)+_0x3e0828,_0x4463bc[_0x44dbb4(0x209)]=_0x3e0828,_0x4463bc[_0x44dbb4(0x21f)]=!![];const _0x91b626=document[_0x44dbb4(0x1ed)](_0x44dbb4(0x1ec));_0x91b626[_0x44dbb4(0x21d)]=_0x44dbb4(0x23e)+_0x3e0828,_0x91b626[_0x44dbb4(0x1fd)]=_0x3e0828,_0x1cb7dd[_0x44dbb4(0x1ff)](_0x4463bc),_0x1cb7dd[_0x44dbb4(0x1ff)](_0x91b626);});const _0x1dd483=[...new Set(buildingData[_0x4bc062(0x215)](_0xfa3634=>_0xfa3634['RE_BL_USE']))]['filter'](_0x5213c2=>_0x5213c2>=0xa);_0x1dd483[_0x4bc062(0x220)](_0x1e6d5c=>{const _0x41793d=_0x4bc062,_0x4dea2b=document[_0x41793d(0x1ed)](_0x41793d(0x1eb));_0x4dea2b[_0x41793d(0x1fb)]=_0x41793d(0x230),_0x4dea2b['id']=_0x41793d(0x222)+_0x1e6d5c,_0x4dea2b[_0x41793d(0x209)]=_0x1e6d5c,_0x4dea2b[_0x41793d(0x21f)]=!![];const _0x2c5d69=document['createElement'](_0x41793d(0x1ec));_0x2c5d69[_0x41793d(0x21d)]=_0x41793d(0x222)+_0x1e6d5c,_0x2c5d69[_0x41793d(0x1fd)]=_0x1e6d5c,_0x5b487e[_0x41793d(0x1ff)](_0x4dea2b),_0x5b487e['appendChild'](_0x2c5d69);}),_0x22f463[_0x4bc062(0x213)](_0x4bc062(0x1e7),calculateAndDisplayTable),_0x1cb7dd[_0x4bc062(0x213)](_0x4bc062(0x1e7),calculateAndDisplayTable),_0x5b487e[_0x4bc062(0x213)](_0x4bc062(0x1e7),calculateAndDisplayTable);}function calculateAndDisplayTable(){const _0x186f87=_0x3922,_0x36195b=document[_0x186f87(0x21e)](_0x186f87(0x1ee))[_0x186f87(0x209)],_0x4219f8=Array['from'](document[_0x186f87(0x201)](_0x186f87(0x217)))['map'](_0x3dcc82=>_0x3dcc82[_0x186f87(0x209)]),_0x1daac1=Array[_0x186f87(0x226)](document[_0x186f87(0x201)](_0x186f87(0x227)))[_0x186f87(0x215)](_0x630547=>_0x630547[_0x186f87(0x209)]),_0x1acc0e=_0x36195b==='all'?plluData:plluData['filter'](_0x591be6=>_0x591be6['PL_USE']===_0x36195b),_0x1e951c=buildingData[_0x186f87(0x1fe)](_0x2e9d4e=>_0x4219f8[_0x186f87(0x1fa)](_0x2e9d4e[_0x186f87(0x1f0)]['toString']())&&_0x1daac1['includes'](_0x2e9d4e['RE_BL_USE'][_0x186f87(0x221)]())&&_0x2e9d4e[_0x186f87(0x241)]>=0xa),_0x456466=_0x1daac1[_0x186f87(0x22b)](_0x222250=>[0x1,0x2,0x3,0x4,0x5]['map'](_0x48b2d4=>_0x222250+'_'+_0x48b2d4))[_0x186f87(0x228)](),_0x3cda79=_0x1acc0e[_0x186f87(0x215)](_0x58c8fd=>{const _0x58264b=_0x186f87,_0x2bc663=_0x1e951c['filter'](_0x161498=>_0x161498['PL_BLOCK']===_0x58c8fd['PL_BLOCK']),_0x7cbf1b={};return _0x456466[_0x58264b(0x220)](_0xe2d09=>{const _0x26a7c0=_0x58264b,[_0x18a944,_0x28914d]=_0xe2d09[_0x26a7c0(0x216)]('_')[_0x26a7c0(0x215)](Number),_0x3713c0=_0x2bc663['filter'](_0x45471c=>_0x45471c[_0x26a7c0(0x241)]==_0x18a944&&_0x45471c['RE_BL_AREA']==_0x28914d);_0x3713c0[_0x26a7c0(0x223)]>0x0&&(_0x7cbf1b[_0xe2d09]={'buildingCount':_0x3713c0[_0x26a7c0(0x223)],'coveredArea':_0x3713c0[_0x26a7c0(0x203)]((_0x431248,_0x4207b9)=>_0x431248+_0x4207b9[_0x26a7c0(0x214)],0x0),'landUseArea':calculateLandUseArea(_0x3713c0,_0x18a944,_0x28914d)});}),{'PL_BLOCK':_0x58c8fd['PL_BLOCK'],'AREA':_0x58c8fd[_0x58264b(0x219)],..._0x7cbf1b};}),_0x33fbde=_0x3cda79['reduce']((_0x27dc93,_0x86a18c)=>{const _0x377aaa=_0x186f87;return _0x27dc93[_0x377aaa(0x219)]+=_0x86a18c[_0x377aaa(0x219)],_0x456466['forEach'](_0x43730f=>{const _0x502956=_0x377aaa;_0x86a18c[_0x43730f]&&(!_0x27dc93[_0x43730f]&&(_0x27dc93[_0x43730f]={'buildingCount':0x0,'coveredArea':0x0,'landUseArea':0x0}),_0x27dc93[_0x43730f]['buildingCount']+=_0x86a18c[_0x43730f][_0x502956(0x239)],_0x27dc93[_0x43730f]['coveredArea']+=_0x86a18c[_0x43730f][_0x502956(0x204)],_0x27dc93[_0x43730f][_0x502956(0x205)]+=_0x86a18c[_0x43730f][_0x502956(0x205)]);}),_0x27dc93;},{'AREA':0x0}),_0x1ec853=document[_0x186f87(0x21e)]('tableContainer');let _0x46ae74=_0x186f87(0x23c);_0x456466['forEach'](_0x4f9037=>{const _0x5883c5=_0x186f87;_0x3cda79[_0x5883c5(0x23d)](_0x14d7a5=>_0x14d7a5[_0x4f9037])&&(_0x46ae74+=_0x5883c5(0x23a)+_0x4f9037+_0x5883c5(0x1f6));}),_0x46ae74+='<th\x20colspan=\x222\x22>รวมพื้นที่อาคารคลุมดิน</th><th\x20colspan=\x222\x22>การใช้ประโยชน์ที่ดิน</th></tr>',_0x46ae74+=_0x186f87(0x208),_0x456466[_0x186f87(0x220)](_0x61db7a=>{const _0x5869b2=_0x186f87;_0x3cda79[_0x5869b2(0x23d)](_0x41aa93=>_0x41aa93[_0x61db7a])&&(_0x46ae74+='<th>จำนวนอาคาร</th><th>พื้นที่อาคารคลุมดินรวม</th><th>พื้นที่การใช้ที่ดินรวม</th>');}),_0x46ae74+='<th>จำนวนอาคาร</th><th>พื้นที่อาคารรวม</th><th>พื้นที่</th><th>ร้อยละพื้นที่</th></tr>',_0x3cda79[_0x186f87(0x220)](_0x3cc72d=>{const _0x5c8afa=_0x186f87;_0x46ae74+=_0x5c8afa(0x1fc)+_0x3cc72d[_0x5c8afa(0x1f7)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x3cc72d[_0x5c8afa(0x219)])+_0x5c8afa(0x218);let _0x24d783=0x0,_0x24de0b=0x0,_0x1cf569=0x0;_0x456466['forEach'](_0x4aed9d=>{const _0x19b6c6=_0x5c8afa;_0x3cda79['some'](_0x3280cc=>_0x3280cc[_0x4aed9d])&&(_0x3cc72d[_0x4aed9d]?(_0x46ae74+=_0x19b6c6(0x21c)+formatNumber(_0x3cc72d[_0x4aed9d][_0x19b6c6(0x239)])+_0x19b6c6(0x231)+formatNumber(_0x3cc72d[_0x4aed9d][_0x19b6c6(0x204)])+_0x19b6c6(0x231)+formatNumber(_0x3cc72d[_0x4aed9d]['landUseArea'])+_0x19b6c6(0x218),_0x24d783+=_0x3cc72d[_0x4aed9d][_0x19b6c6(0x239)],_0x24de0b+=_0x3cc72d[_0x4aed9d][_0x19b6c6(0x204)],_0x1cf569+=_0x3cc72d[_0x4aed9d][_0x19b6c6(0x205)]):_0x46ae74+='<td>0</td><td>0</td><td>0</td>');});const _0x2c4ba9=_0x1cf569/_0x3cc72d[_0x5c8afa(0x219)]*0x64;_0x46ae74+=_0x5c8afa(0x21c)+formatNumber(_0x24d783)+_0x5c8afa(0x233)+formatNumber(_0x24de0b)+_0x5c8afa(0x233)+formatNumber(_0x1cf569)+_0x5c8afa(0x233)+formatNumber(_0x2c4ba9)+_0x5c8afa(0x22e);}),_0x46ae74+=_0x186f87(0x202)+formatNumber(_0x33fbde[_0x186f87(0x219)])+'</td>';let _0x504caf=0x0,_0x31459e=0x0,_0x3d1989=0x0;_0x456466[_0x186f87(0x220)](_0x3d96bb=>{const _0x5e495e=_0x186f87;_0x3cda79[_0x5e495e(0x23d)](_0x590144=>_0x590144[_0x3d96bb])&&(_0x33fbde[_0x3d96bb]?(_0x46ae74+=_0x5e495e(0x21c)+formatNumber(_0x33fbde[_0x3d96bb]['buildingCount'])+_0x5e495e(0x20c)+formatNumber(_0x33fbde[_0x3d96bb][_0x5e495e(0x204)])+_0x5e495e(0x20c)+formatNumber(_0x33fbde[_0x3d96bb][_0x5e495e(0x205)])+'</td>',_0x504caf+=_0x33fbde[_0x3d96bb][_0x5e495e(0x239)],_0x31459e+=_0x33fbde[_0x3d96bb][_0x5e495e(0x204)],_0x3d1989+=_0x33fbde[_0x3d96bb]['landUseArea']):_0x46ae74+=_0x5e495e(0x224));});const _0x22071e=_0x3d1989/_0x33fbde[_0x186f87(0x219)]*0x64;_0x46ae74+='<td>'+formatNumber(_0x504caf)+_0x186f87(0x1f5)+formatNumber(_0x31459e)+_0x186f87(0x1f5)+formatNumber(_0x3d1989)+_0x186f87(0x1f5)+formatNumber(_0x22071e)+_0x186f87(0x22d),_0x46ae74+='</table>',_0x1ec853[_0x186f87(0x212)]=_0x46ae74;}function calculateLandUseArea(_0x970cd0,_0x30c0fa,_0x2bf605){return _0x970cd0['reduce']((_0x1b56fb,_0x260f41)=>{const _0x541fc3=_0x3922;let _0x477615;if(_0x30c0fa==0xa){if(_0x2bf605==0x1)_0x477615=0x32;else{if(_0x2bf605==0x2||_0x2bf605==0x3)_0x477615=0x3c;else{if(_0x2bf605==0x4)_0x477615=0x28;else{if(_0x2bf605==0x5)_0x477615=0x41;}}}}else{if(_0x30c0fa==0x14){if(_0x2bf605==0x1)_0x477615=0x46;else{if(_0x2bf605==0x2)_0x477615=0x28;else{if(_0x2bf605==0x3)_0x477615=0x41;}}}else{if(_0x30c0fa==0x29){if(_0x2bf605==0x1)_0x477615=0x46;else{if(_0x2bf605==0x2)_0x477615=0x28;else{if(_0x2bf605==0x3)_0x477615=0x41;}}}else{if(_0x30c0fa==0x1e){if(_0x2bf605==0x1)_0x477615=0x46;else{if(_0x2bf605==0x2||_0x2bf605==0x4)_0x477615=0x2d;else{if(_0x2bf605==0x3)_0x477615=0x32;}}}else{if(_0x30c0fa==0x21){if(_0x2bf605==0x1)_0x477615=0x14;else{if(_0x2bf605==0x2)_0x477615=0x28;else{if(_0x2bf605==0x3)_0x477615=0x32;}}}else{if(_0x30c0fa==0x50&&_0x2bf605==0x1)_0x477615=0x14;else _0x30c0fa==0x5a&&_0x2bf605==0x1&&(_0x477615=0x46);}}}}}return _0x1b56fb+_0x260f41[_0x541fc3(0x214)]*0x64/_0x477615;},0x0);}function _0x11b4(){const _0x31ea19=['</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','acqyear-filter','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','6474956UYOHgm','buildingFile','read','906442EZIVGk','10467XiQNIL','buildingCount','<th\x20colspan=\x223\x22>','option','<table><tr><th>บริเวณการใช้ประโยชน์ที่ดิน</th><th>พื้นที่\x20block</th>','some','acqyear-','10hgZRcX','SheetNames','RE_BL_USE','change','utils','10408ckhsxf','78nNhZwG','input','label','createElement','pl-use-filter','928228JQnsTu','ACQYEAR','3648282AvUJMA','toLocaleString','querySelector','กรุณาเลือกไฟล์ทั้งสองไฟล์','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','</th>','PL_BLOCK','table','result','includes','type','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','textContent','filter','appendChild','Sheet\x20JS','querySelectorAll','<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวม</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','reduce','coveredArea','landUseArea','files','writeFile','<tr><th></th><th></th>','value','PL_USE','plluFile','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','onload','11126929zZAzxX','en-US','2408934dlvXBi','array','innerHTML','addEventListener','BL_AREA','map','split','#acqyear-filter\x20input:checked','</td>','AREA','land_use_calculation.xlsx','sheet_to_json','<td>','htmlFor','getElementById','checked','forEach','toString','re-bl-use-','length','<td>0</td><td>0</td><td>0</td>','readAsArrayBuffer','from','#re-bl-use-filter\x20input:checked','sort','Sheets','target','flatMap','5sHqCui','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</tr>','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','table_to_book','checkbox'];_0x11b4=function(){return _0x31ea19;};return _0x11b4();}function formatNumber(_0x14e203){const _0x465a81=_0x3922;return _0x14e203[_0x465a81(0x1f2)](_0x465a81(0x20f),{'maximumFractionDigits':0x2});}function _0x3922(_0x29a6b0,_0x2641ec){const _0x11b46d=_0x11b4();return _0x3922=function(_0x392299,_0x10339c){_0x392299=_0x392299-0x1e7;let _0x44bb21=_0x11b46d[_0x392299];return _0x44bb21;},_0x3922(_0x29a6b0,_0x2641ec);}function exportToExcel(){const _0x10bf7e=_0x3922,_0x3fcd9d=document[_0x10bf7e(0x1f3)](_0x10bf7e(0x1f8)),_0x1333fe=XLSX[_0x10bf7e(0x1e8)][_0x10bf7e(0x22f)](_0x3fcd9d,{'sheet':_0x10bf7e(0x200)});XLSX[_0x10bf7e(0x207)](_0x1333fe,_0x10bf7e(0x21a));}
    </script>
</body>
</html>                