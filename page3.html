<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculate Landuse</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background-color: rgb(249, 250, 251);
        }
        
        /* ส่วนของตารางที่ปรับปรุงใหม่ */
        .table-wrapper {
            position: relative;
            overflow: hidden;
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        
        .table-scroll {
            overflow: auto;
            max-height: 600px;
            position: relative;
        }
        
        table { 
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            min-width: 1400px;
            position: relative;
        }
        
        th, td { 
            border: 1px solid #ddd; 
            padding: 8px 12px; 
            text-align: center;
            white-space: nowrap;
            background-color: white;
            min-width: 100px;
        }
        
        /* จัดคอลัมน์แรกให้ชิดซ้าย */
        td:first-child, td:nth-child(2), td:nth-child(3),
        th:first-child, th:nth-child(2), th:nth-child(3) {
            text-align: left;
        }
        
        /* หัวตารางหลัก */
        thead {
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        thead tr:first-child th {
            background-color: #1e40af;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 102;
        }
        
        /* หัวตารางแถวที่ 2 */
        thead tr:nth-child(2) th {
            background-color: #3b82f6;
            color: white;
            position: sticky;
            top: 41px; /* ความสูงของแถวแรก */
            z-index: 101;
        }
        
        /* ปรับการ freeze คอลัมน์ */
        td:first-child,
        th:first-child {
            position: sticky;
            left: 0;
            z-index: 50;
            background-color: white;
            min-width: 120px;
        }
        
        td:nth-child(2),
        th:nth-child(2) {
            position: sticky;
            left: 120px; /* ความกว้างคอลัมน์แรก */
            z-index: 50;
            background-color: white;
            min-width: 120px;
        }
        
        td:nth-child(3),
        th:nth-child(3) {
            position: sticky;
            left: 240px; /* ความกว้างคอลัมน์แรก + คอลัมน์ที่สอง */
            z-index: 50;
            background-color: white;
            min-width: 100px;
        }
        
        /* หัวตารางที่ freeze ทั้งแนวตั้งและแนวนอน */
        thead tr:first-child th:first-child,
        thead tr:first-child th:nth-child(2),
        thead tr:first-child th:nth-child(3) {
            z-index: 103;
        }
        
        thead tr:nth-child(2) th:first-child,
        thead tr:nth-child(2) th:nth-child(2),
        thead tr:nth-child(2) th:nth-child(3) {
            z-index: 103;
        }
        
        /* แถวคู่ */
        tbody tr:nth-child(even) td { 
            background-color: #f9fafb; 
        }
        
        /* แถวคู่ที่ freeze */
        tbody tr:nth-child(even) td:first-child,
        tbody tr:nth-child(even) td:nth-child(2),
        tbody tr:nth-child(even) td:nth-child(3) {
            background-color: #f9fafb;
        }
        
        /* แถวคี่ที่ freeze */
        tbody tr:nth-child(odd) td:first-child,
        tbody tr:nth-child(odd) td:nth-child(2),
        tbody tr:nth-child(odd) td:nth-child(3) {
            background-color: white;
        }
        
        /* แถวผลรวม */
        .total-row td { 
            background-color: #dbeafe !important; 
            font-weight: bold;
        }
        
        /* แถวที่เกินค่ากิจการรอง */
        .exceed-limit-row td {
            background-color: #fecaca !important;
        }
        
        /* แถวผลรวมที่เกินค่ากิจการรอง */
        .total-row.exceed-limit-row td {
            background-color: #f87171 !important;
        }
        
        /* เส้นขอบของเซลล์ */
        th, td {
            border: 1px solid #cbd5e0;
            box-shadow: inset 0 0 0 1px #cbd5e0;
        }
        
        /* ส่วนที่เหลือของสไตล์เดิม */
        .filter-container { 
            margin-bottom: 20px; 
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 0.375rem;
            background-color: #f9fafb;
        }
        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
        }
        .checkbox-group { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 10px; 
        }
        .pluse-filter-group {
            margin-top: 10px;
            padding: 8px;
            border: 1px solid #e5e7eb;
            border-radius: 0.25rem;
            background-color: #ffffff;
        }
        .pluse-filter-header {
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 5px;
        }
        .main-container {
            padding: 1rem;
            min-height: 100vh;
            width: 100%;
        }
        .content-wrapper {
            width: 100%;
        }
        .header-button {
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 500;
            transition: all 0.2s;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 120px;
            white-space: nowrap;
            cursor: pointer;
            border: none;
        }
        .header-button.primary {
            background-color: #1e40af;
            color: white;
        }
        .header-button.primary:hover {
            background-color: #1e3a8a;
        }
        .header-button.home {
            background-color: #1e40af;
            color: white;
            min-width: 40px;
            padding: 8px;
        }
        .header-button.home:hover {
            background-color: #1e3a8a;
        }
        .header-buttons-container {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-left: auto;
            padding: 4px;
        }
        
        input[type="file"] {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            border-radius: 0.375rem;
            width: 100%;
            background-color: white;
        }
        input[type="file"]:hover {
            border-color: #cbd5e0;
        }
        select {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            border-radius: 0.375rem;
            width: 100%;
            max-width: 20rem;
            background-color: white;
        }
        .action-button {
            padding: 8px 16px;
            background-color: #1e40af;
            color: white;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: background-color 0.2s;
            margin-right: 8px;
        }
        .action-button:hover {
            background-color: #1e3a8a;
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            .header-buttons-container {
                width: 100%;
                justify-content: flex-start;
                margin-left: 0;
            }
            .grid-cols-2 {
                grid-template-columns: 1fr;
            }
        }
        
        .toggle-icon {
            transition: transform 0.3s ease;
        }
        
        .collapsed .toggle-icon {
            transform: rotate(-90deg);
        }
        
        .filter-content {
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
            max-height: 1000px;
            opacity: 1;
            overflow: hidden;
        }
        
        .collapsed .filter-content {
            max-height: 0;
            opacity: 0;
        }
        
        .table-section {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin: 20px 0 10px 0;
            color: #1e40af;
        }
        
        .buttons-container {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        
        /* ส่วนที่เพิ่มเติมสำหรับระบบแท็บ */
        .tabs {
            display: flex;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 16px;
        }
        
        .tab {
            padding: 8px 16px;
            cursor: pointer;
            border: 1px solid transparent;
            border-bottom: none;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            margin-right: 4px;
            background-color: #f8fafc;
        }
        
        .tab.active {
            background-color: white;
            border-color: #e2e8f0;
            border-bottom-color: white;
            font-weight: bold;
            color: #1e40af;
            margin-bottom: -1px;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            padding: 16px;
            border: 1px solid #e2e8f0;
            border-top: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* ส่วนสำหรับหน้าต่างการกรอกร้อยละกิจการรอง */
        .secondary-percent-container {
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .secondary-percent-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .secondary-percent-title {
            font-weight: bold;
            color: #1e40af;
        }
        
        .secondary-percent-toggle {
            background-color: #f1f5f9;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .secondary-percent-toggle:hover {
            background-color: #e2e8f0;
        }
        
        .secondary-percent-content {
            max-height: 800px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .secondary-percent-content.collapsed {
            max-height: 0;
        }
        
        .secondary-percent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
        }
        
        .secondary-percent-item {
            display: flex;
            flex-direction: column;
        }
        
        .secondary-percent-label {
            font-size: 0.875rem;
            margin-bottom: 4px;
        }
        
        .secondary-percent-input {
            padding: 6px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="content-wrapper">
            <!-- Header Section -->
            <div class="header-container flex justify-between items-center mb-6">
                <div class="flex items-center gap-2">
                    <h1 class="text-2xl font-bold text-blue-700">Calculate Landuse</h1>
                    <h2 class="text-lg text-gray-600">คำนวณพื้นที่การใช้ประโยชน์ที่ดิน</h2>
                </div>
                <div class="header-buttons-container">
                    <button onclick="window.location.href='page2.html'" class="header-button primary">
                        Reclass BLDG
                    </button>
                    <button onclick="window.location.href='page5.html'" class="header-button primary">
                        PREP PLLU
                    </button>
                    <button onclick="window.location.href='index.html'" class="header-button home" aria-label="Home">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                            <polyline points="9 22 9 12 15 12 15 22"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Manual Link -->
            <div class="flex items-center gap-2 mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-700">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                </svg>
                <a href="page.html" class="text-blue-700 hover:underline">
                    คู่มือการใช้งาน
                </a>
            </div>

            <!-- Main Content Card -->
            <div class="bg-white shadow p-6 mb-6">
                <!-- File Upload Section -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">ไฟล์อาคาร (Excel):</label>
                        <input type="file" id="buildingFile" accept=".xlsx, .xls">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">ไฟล์ pllu (Excel):</label>
                        <input type="file" id="plluFile" accept=".xlsx, .xls">
                    </div>
                </div>

                <!-- Info Text -->
                <div class="mb-6 text-sm text-gray-600">
                    ไฟล์อาคารที่นำมาใช้ต้องเป็นไฟล์อาคารจากฟังก์ชัน Reclass BLDG <br>
                    กรณีต้องการเรียงรายการตามบริเวณ/ประเภทการใช้ประโยชน์ที่ดิน ให้คลิกปุ่ม PREP PLLU แล้วนำผลลัพธ์ที่ได้มาใส่ในช่อง upload ไฟล์ pllu 
                </div>

                <!-- Action Buttons -->
                <div class="buttons-container">
                    <button onclick="processFiles()" class="action-button">
                        Calculate
                    </button>
                    <button onclick="exportToExcel()" class="action-button">
                        นำออกไฟล์ผลการใช้ประโยชน์ที่ดิน (Excel)
                    </button>
                    <button onclick="exportMainActivitiesTableToExcel()" class="action-button">
                        นำออกตารางกิจกรรมที่ทำได้ (Excel)
                    </button>
                    <button onclick="exportSecondaryActivitiesTableToExcel()" class="action-button">
                        นำออกตารางกิจกรรมรอง (Excel)
                    </button>
                </div>

                <!-- Filter Section -->
                <div class="grid gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">กรองตาม PL_USE:</label>
                        <select id="pl-use-filter">
                            <option value="all">ทั้งหมด</option>
                        </select>
                    </div>
                    
                    <!-- Collapsible RE_BL_USE Filter Section -->
                    <div class="filter-container" id="re-bl-use-container">
                        <div class="filter-header" onclick="toggleFilterSection(this)">
                            <label class="block text-sm font-medium">กรองตาม RE_BL_USE:</label>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" 
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" 
                                class="toggle-icon">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="filter-content">
                            <div id="re-bl-use-filters-container">
                                <!-- RE_BL_USE filters will be dynamically inserted here for each PL_USE -->
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">กรองตาม ACQYEAR:</label>
                        <div id="acqyear-filter" class="checkbox-group"></div>
                    </div>
                </div>
            </div>

            <!-- Secondary Percent Container -->
            <div class="secondary-percent-container">
                <div class="secondary-percent-header">
                    <div class="secondary-percent-title">ร้อยละกิจการรอง</div>
                    <button class="secondary-percent-toggle" onclick="toggleSecondaryPercent()">ซ่อน/แสดง</button>
                </div>
                <div class="secondary-percent-content" id="secondaryPercentContent">
                    <div class="secondary-percent-grid" id="secondaryPercentGrid">
                        <!-- จะเพิ่มช่องกรอกร้อยละกิจการรองตาม PL_USE ที่นี่ -->
                    </div>
                </div>
            </div>

            <!-- Tabs Section -->
            <div class="tabs">
                <div class="tab active" onclick="switchTab('originalTable')">ตารางผลการใช้ประโยชน์ที่ดิน</div>
                <div class="tab" onclick="switchTab('mainActivitiesTable')">ตารางกิจกรรมที่ทำได้</div>
                <div class="tab" onclick="switchTab('secondaryActivitiesTable')">ตารางกิจกรรมรอง</div>
            </div>

            <!-- Tab Content -->
            <div id="originalTable" class="tab-content active">
                <div id="tableContainer" class="table-wrapper">
                    <div class="table-scroll"></div>
                </div>
            </div>
            
            <div id="mainActivitiesTable" class="tab-content">
                <div id="mainActivitiesTableContainer" class="table-wrapper">
                    <div class="table-scroll"></div>
                </div>
            </div>
            
            <div id="secondaryActivitiesTable" class="tab-content">
                <div id="secondaryActivitiesTableContainer" class="table-wrapper">
                    <div class="table-scroll"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
const _0x56708b=_0x5424;(function(_0x191a20,_0x45ccef){const _0x25620f=_0x5424,_0x22b3ad=_0x191a20();while(!![]){try{const _0x534385=parseInt(_0x25620f(0xc2))/0x1*(-parseInt(_0x25620f(0x109))/0x2)+parseInt(_0x25620f(0x15f))/0x3+-parseInt(_0x25620f(0xe9))/0x4+parseInt(_0x25620f(0xf2))/0x5+-parseInt(_0x25620f(0x169))/0x6*(parseInt(_0x25620f(0x10e))/0x7)+-parseInt(_0x25620f(0xb5))/0x8+parseInt(_0x25620f(0xe3))/0x9;if(_0x534385===_0x45ccef)break;else _0x22b3ad['push'](_0x22b3ad['shift']());}catch(_0x324d1e){_0x22b3ad['push'](_0x22b3ad['shift']());}}}(_0x142c,0x7488f));let buildingData,plluData,calculationResults,totals,secondaryPercentages={},plluOriginalOrder=[];const reBLUseLabelMap={'10_1':_0x56708b(0x171),'10_2':_0x56708b(0x118),'10_3':_0x56708b(0x10b),'10_4':_0x56708b(0x167),'10_5':_0x56708b(0x15c),'20_1':'พาณิชย์\x20อาคารทั่วไป','20_2':_0x56708b(0x12e),'20_3':'พาณิชย์\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20401\x20ตร.ม.\x20ขึ้นไป)','41_1':_0x56708b(0xcb),'41_2':_0x56708b(0x177),'41_3':_0x56708b(0xc7),'30_1':'อุตสาหกรรม\x20(พื้นที่คลุมดินไม่เกิน\x20200\x20ตร.ม.)','30_2':_0x56708b(0xca),'30_3':_0x56708b(0xdb),'30_4':_0x56708b(0x14c),'33_1':_0x56708b(0x146),'33_2':_0x56708b(0x16d),'33_3':_0x56708b(0x175),'80_1':_0x56708b(0x179),'90_1':_0x56708b(0x130)};function switchTab(_0x309e9d){const _0x115599=_0x56708b;document[_0x115599(0xb4)](_0x115599(0x160))['forEach'](_0x315007=>{const _0x5d569d=_0x115599;_0x315007[_0x5d569d(0x13a)]['remove'](_0x5d569d(0x13b));}),document['querySelectorAll'](_0x115599(0xd1))[_0x115599(0xbf)](_0x1925ce=>{const _0x48f4e1=_0x115599;_0x1925ce[_0x48f4e1(0x13a)]['remove'](_0x48f4e1(0x13b));}),document[_0x115599(0x141)](_0x309e9d)[_0x115599(0x13a)][_0x115599(0xd8)]('active'),document[_0x115599(0x17a)](_0x115599(0xd3)+_0x309e9d+_0x115599(0x125))['classList'][_0x115599(0xd8)](_0x115599(0x13b));if(_0x309e9d==='mainActivitiesTable')calculateMainActivitiesTable();else _0x309e9d===_0x115599(0x164)&&calculateSecondaryActivitiesTable();}function toggleFilterSection(_0x5b7194){const _0x253c9e=_0x56708b,_0x1e9928=_0x5b7194[_0x253c9e(0x163)](_0x253c9e(0x149));_0x1e9928[_0x253c9e(0x13a)]['toggle'](_0x253c9e(0x126));}function toggleSecondaryPercent(){const _0x4976f9=_0x56708b,_0x19820a=document[_0x4976f9(0x141)](_0x4976f9(0x15e));_0x19820a['classList'][_0x4976f9(0x142)](_0x4976f9(0x126));}function roundToTwoDecimals(_0x5343ea){const _0x33e97c=_0x56708b;return Math[_0x33e97c(0x12f)]((_0x5343ea+Number[_0x33e97c(0x148)])*0x64)/0x64;}function processFiles(){const _0x36f4af=_0x56708b,_0x4269a2=document[_0x36f4af(0x141)](_0x36f4af(0x121))[_0x36f4af(0xd7)][0x0],_0xe5cbb4=document[_0x36f4af(0x141)](_0x36f4af(0x114))[_0x36f4af(0xd7)][0x0];if(!_0x4269a2||!_0xe5cbb4){alert(_0x36f4af(0xbb));return;}const _0x2c0248=new FileReader();_0x2c0248[_0x36f4af(0x16e)]=function(_0x170194){const _0xa0ebf9=_0x36f4af,_0x4ad60a=new Uint8Array(_0x170194[_0xa0ebf9(0x174)]['result']),_0x1bda78=XLSX[_0xa0ebf9(0x16a)](_0x4ad60a,{'type':'array'});buildingData=XLSX[_0xa0ebf9(0x102)][_0xa0ebf9(0x11f)](_0x1bda78[_0xa0ebf9(0xe6)][_0x1bda78['SheetNames'][0x0]]),buildingData=buildingData['map'](_0x2a2973=>({..._0x2a2973,'BL_TYPE':String(_0x2a2973[_0xa0ebf9(0xc3)]||''),'BL_USE':String(_0x2a2973[_0xa0ebf9(0x16f)]||''),'ACQYEAR':String(_0x2a2973[_0xa0ebf9(0xbe)]||''),'PL_BLOCK':String(_0x2a2973[_0xa0ebf9(0x101)]||''),'RE_BL_USE':parseFloat(_0x2a2973[_0xa0ebf9(0xef)])||0x0,'RE_BL_AREA':parseFloat(_0x2a2973[_0xa0ebf9(0x156)])||0x0,'BL_AREA':parseFloat(_0x2a2973[_0xa0ebf9(0xd0)])||0x0}));const _0x40c02f=new FileReader();_0x40c02f[_0xa0ebf9(0x16e)]=function(_0x251806){const _0x5c45fa=_0xa0ebf9,_0x2ba336=new Uint8Array(_0x251806[_0x5c45fa(0x174)][_0x5c45fa(0xf1)]),_0x10db3f=XLSX[_0x5c45fa(0x16a)](_0x2ba336,{'type':'array'});plluData=XLSX[_0x5c45fa(0x102)][_0x5c45fa(0x11f)](_0x10db3f[_0x5c45fa(0xe6)][_0x10db3f[_0x5c45fa(0xc4)][0x0]]),plluOriginalOrder=plluData[_0x5c45fa(0x128)]((_0x44bcad,_0x459f7)=>({'PL_BLOCK':String(_0x44bcad['PL_BLOCK']||''),'originalIndex':_0x459f7})),plluData=plluData[_0x5c45fa(0x128)](_0x5d6ff2=>({..._0x5d6ff2,'PL_BLOCK':String(_0x5d6ff2[_0x5c45fa(0x101)]||''),'PL_USE':String(_0x5d6ff2['PL_USE']||''),'AREA':parseFloat(_0x5d6ff2[_0x5c45fa(0xe1)])||0x0})),setupFilters(),setupSecondaryPercentInputs(),calculateAndDisplayTable(),calculateMainActivitiesTable(),calculateSecondaryActivitiesTable();},_0x40c02f[_0xa0ebf9(0x11d)](_0xe5cbb4);},_0x2c0248['readAsArrayBuffer'](_0x4269a2);}function setupFilters(){const _0x2a564f=_0x56708b,_0x2bbdc=document[_0x2a564f(0x141)](_0x2a564f(0x135)),_0x181453=document['getElementById'](_0x2a564f(0xe0)),_0x9b2c88=document['getElementById'](_0x2a564f(0x162));_0x2bbdc[_0x2a564f(0x17b)]=_0x2a564f(0x161),_0x181453['innerHTML']='',_0x9b2c88['innerHTML']='';const _0x3b522e=[...new Set(plluData['map'](_0x5bfeab=>String(_0x5bfeab[_0x2a564f(0xc0)])))][_0x2a564f(0x115)]();_0x3b522e['forEach'](_0x3aa9f1=>{const _0x199503=_0x2a564f,_0x59ce46=document[_0x199503(0x13d)](_0x199503(0xb3));_0x59ce46[_0x199503(0xe8)]=_0x3aa9f1,_0x59ce46['textContent']=_0x3aa9f1,_0x2bbdc[_0x199503(0x11a)](_0x59ce46);}),_0x3b522e[_0x2a564f(0xbf)](_0x26e74d=>{const _0x1b8d2b=_0x2a564f,_0x56cabc=document[_0x1b8d2b(0x13d)](_0x1b8d2b(0x145));_0x56cabc[_0x1b8d2b(0x13a)]['add'](_0x1b8d2b(0xcc)),_0x56cabc[_0x1b8d2b(0xc5)]['plUse']=_0x26e74d;const _0x30ff72=document[_0x1b8d2b(0x13d)](_0x1b8d2b(0x145));_0x30ff72[_0x1b8d2b(0x13a)][_0x1b8d2b(0xd8)](_0x1b8d2b(0xf0)),_0x30ff72[_0x1b8d2b(0x10c)]='PL_USE:\x20'+_0x26e74d,_0x56cabc[_0x1b8d2b(0x11a)](_0x30ff72);const _0x21f1af=document['createElement']('div');_0x21f1af[_0x1b8d2b(0x13a)][_0x1b8d2b(0xd8)](_0x1b8d2b(0x178)),_0x56cabc[_0x1b8d2b(0x11a)](_0x21f1af);const _0x4a7b37=plluData[_0x1b8d2b(0x10a)](_0x12c27e=>String(_0x12c27e[_0x1b8d2b(0xc0)])===_0x26e74d)['map'](_0x5db415=>String(_0x5db415[_0x1b8d2b(0x101)])),_0x4cb51a=buildingData[_0x1b8d2b(0x10a)](_0x1ff17b=>_0x4a7b37[_0x1b8d2b(0x14f)](String(_0x1ff17b['PL_BLOCK']))),_0x230a77=[...new Set(_0x4cb51a[_0x1b8d2b(0x128)](_0x19c764=>parseFloat(_0x19c764['RE_BL_USE']))['filter'](_0x357c17=>!isNaN(_0x357c17)&&_0x357c17>=0xa))][_0x1b8d2b(0x115)]((_0x33ad21,_0x28c0db)=>_0x33ad21-_0x28c0db);_0x230a77['forEach'](_0x65c124=>{const _0xf4202e=_0x1b8d2b,_0x45070f=document[_0xf4202e(0x13d)](_0xf4202e(0x100));_0x45070f[_0xf4202e(0x104)]=_0xf4202e(0xce),_0x45070f['id']='re-bl-use-'+_0x26e74d+'-'+_0x65c124,_0x45070f[_0xf4202e(0xe8)]=_0x65c124,_0x45070f[_0xf4202e(0xc5)][_0xf4202e(0xb7)]=_0x26e74d,_0x45070f[_0xf4202e(0x15b)]=!![],_0x45070f[_0xf4202e(0x143)](_0xf4202e(0xdd),function(){calculateAndDisplayTable(),calculateMainActivitiesTable(),calculateSecondaryActivitiesTable();});const _0xbf562c=document[_0xf4202e(0x13d)](_0xf4202e(0xda));_0xbf562c['htmlFor']=_0xf4202e(0x107)+_0x26e74d+'-'+_0x65c124;const _0x4af9be=_0x65c124+'_1',_0x1efdd0=reBLUseLabelMap[_0x4af9be]?_0x65c124+'\x20('+reBLUseLabelMap[_0x4af9be][_0xf4202e(0x16c)]('\x20')[0x0]+')':''+_0x65c124;_0xbf562c['textContent']=_0x1efdd0,_0x21f1af['appendChild'](_0x45070f),_0x21f1af[_0xf4202e(0x11a)](_0xbf562c);}),_0x181453[_0x1b8d2b(0x11a)](_0x56cabc);}),updateVisiblePLUseFilters();const _0x181fe0=[...new Set(buildingData[_0x2a564f(0x128)](_0x3d18c0=>String(_0x3d18c0[_0x2a564f(0xbe)])))][_0x2a564f(0x115)]();_0x181fe0[_0x2a564f(0xbf)](_0x52b7a7=>{const _0x2bccc9=_0x2a564f,_0x56318f=document[_0x2bccc9(0x13d)]('input');_0x56318f[_0x2bccc9(0x104)]=_0x2bccc9(0xce),_0x56318f['id']=_0x2bccc9(0x127)+_0x52b7a7,_0x56318f[_0x2bccc9(0xe8)]=_0x52b7a7,_0x56318f[_0x2bccc9(0x15b)]=!![],_0x56318f[_0x2bccc9(0x143)]('change',function(){calculateAndDisplayTable(),calculateMainActivitiesTable(),calculateSecondaryActivitiesTable();});const _0x240fad=document[_0x2bccc9(0x13d)](_0x2bccc9(0xda));_0x240fad[_0x2bccc9(0xde)]=_0x2bccc9(0x127)+_0x52b7a7,_0x240fad[_0x2bccc9(0x10c)]=_0x52b7a7,_0x9b2c88[_0x2bccc9(0x11a)](_0x56318f),_0x9b2c88[_0x2bccc9(0x11a)](_0x240fad);}),_0x2bbdc[_0x2a564f(0x143)](_0x2a564f(0xdd),function(){updateVisiblePLUseFilters(),calculateAndDisplayTable(),calculateMainActivitiesTable(),calculateSecondaryActivitiesTable();});}function _0x5424(_0xb705aa,_0x362a3b){const _0x142ce4=_0x142c();return _0x5424=function(_0x5424a5,_0x2aee73){_0x5424a5=_0x5424a5-0xb0;let _0x3acd42=_0x142ce4[_0x5424a5];return _0x3acd42;},_0x5424(_0xb705aa,_0x362a3b);}function setupSecondaryPercentInputs(){const _0x3b3f19=_0x56708b,_0xe2fdfe=document[_0x3b3f19(0x141)](_0x3b3f19(0x136));_0xe2fdfe['innerHTML']='';const _0x3684ec=[...new Set(plluData['map'](_0x1c466e=>String(_0x1c466e[_0x3b3f19(0xc0)])))]['sort']((_0x4c61ee,_0x49acdc)=>{const _0x3231d0=_0x3b3f19,_0x507650=plluData[_0x3231d0(0xb2)](_0x1fa575=>String(_0x1fa575['PL_USE'])===_0x4c61ee),_0x51b879=plluData['findIndex'](_0x41c9fc=>String(_0x41c9fc[_0x3231d0(0xc0)])===_0x49acdc);return _0x507650-_0x51b879;});_0x3684ec['forEach'](_0x16cf43=>{const _0x2718f4=_0x3b3f19,_0x16414b=document[_0x2718f4(0x13d)](_0x2718f4(0x145));_0x16414b[_0x2718f4(0x13a)][_0x2718f4(0xd8)](_0x2718f4(0xf7));const _0x51363c=document[_0x2718f4(0x13d)](_0x2718f4(0xda));_0x51363c[_0x2718f4(0x13a)][_0x2718f4(0xd8)](_0x2718f4(0xf6)),_0x51363c[_0x2718f4(0xde)]=_0x2718f4(0xe2)+_0x16cf43,_0x51363c['textContent']=_0x16cf43+_0x2718f4(0x173);const _0xd7b35e=document[_0x2718f4(0x13d)](_0x2718f4(0x100));_0xd7b35e['type']=_0x2718f4(0x147),_0xd7b35e[_0x2718f4(0x16b)]='0',_0xd7b35e[_0x2718f4(0xe4)]=_0x2718f4(0x123),_0xd7b35e['step']=_0x2718f4(0x14a),_0xd7b35e['id']='secondary-percent-'+_0x16cf43,_0xd7b35e[_0x2718f4(0x13a)][_0x2718f4(0xd8)](_0x2718f4(0x158)),_0xd7b35e[_0x2718f4(0xc9)]=_0x2718f4(0xfb),_0xd7b35e[_0x2718f4(0xe8)]=secondaryPercentages[_0x16cf43]||'',_0xd7b35e[_0x2718f4(0x143)]('change',function(){const _0x5cc5ee=_0x2718f4;secondaryPercentages[_0x16cf43]=roundToTwoDecimals(parseFloat(this['value'])||0x0),this[_0x5cc5ee(0xe8)]=secondaryPercentages[_0x16cf43],calculateSecondaryActivitiesTable();}),_0x16414b[_0x2718f4(0x11a)](_0x51363c),_0x16414b[_0x2718f4(0x11a)](_0xd7b35e),_0xe2fdfe[_0x2718f4(0x11a)](_0x16414b);});}function updateVisiblePLUseFilters(){const _0x265b01=_0x56708b,_0x4db155=document[_0x265b01(0x141)](_0x265b01(0x135))['value'],_0x4a35eb=document['querySelectorAll'](_0x265b01(0x170));_0x4a35eb[_0x265b01(0xbf)](_0x13ab78=>{const _0x4ae8e4=_0x265b01;_0x4db155===_0x4ae8e4(0x15a)||_0x13ab78[_0x4ae8e4(0xc5)][_0x4ae8e4(0xb7)]===_0x4db155?_0x13ab78['style'][_0x4ae8e4(0xeb)]='block':_0x13ab78[_0x4ae8e4(0x116)][_0x4ae8e4(0xeb)]=_0x4ae8e4(0xbd);});}function calculateAndDisplayTable(){const _0xbe74f6=_0x56708b,_0x3ecebf=document[_0xbe74f6(0x141)](_0xbe74f6(0x135))[_0xbe74f6(0xe8)],_0x502497=Array[_0xbe74f6(0x157)](document[_0xbe74f6(0xb4)](_0xbe74f6(0xd4)))[_0xbe74f6(0x128)](_0x412057=>String(_0x412057['value'])),_0x553b61={};if(_0x3ecebf===_0xbe74f6(0x15a)){const _0x52b518=[...new Set(plluData[_0xbe74f6(0x128)](_0x4321a4=>String(_0x4321a4['PL_USE'])))][_0xbe74f6(0x115)]();_0x52b518['forEach'](_0x130f51=>{const _0x567ca5=_0xbe74f6,_0x59207b=document[_0x567ca5(0xb4)](_0x567ca5(0x168)+_0x130f51+'\x22]:checked');_0x553b61[_0x130f51]=Array[_0x567ca5(0x157)](_0x59207b)[_0x567ca5(0x128)](_0x114ed0=>String(_0x114ed0[_0x567ca5(0xe8)]));});}else{const _0x11321c=document[_0xbe74f6(0xb4)](_0xbe74f6(0x168)+_0x3ecebf+_0xbe74f6(0x15d));_0x553b61[_0x3ecebf]=Array[_0xbe74f6(0x157)](_0x11321c)[_0xbe74f6(0x128)](_0x4f0ee2=>String(_0x4f0ee2[_0xbe74f6(0xe8)]));}const _0x26c696=_0x3ecebf===_0xbe74f6(0x15a)?plluData:plluData[_0xbe74f6(0x10a)](_0x1c54dd=>String(_0x1c54dd[_0xbe74f6(0xc0)])===_0x3ecebf),_0x453ea6=Object[_0xbe74f6(0xb9)](_0x553b61)[_0xbe74f6(0x12c)]()[_0xbe74f6(0x10a)]((_0x1eb591,_0x4330df,_0x2778a9)=>_0x2778a9[_0xbe74f6(0x122)](_0x1eb591)===_0x4330df),_0x3d611e=buildingData[_0xbe74f6(0x10a)](_0xaea4ca=>{const _0x2b8681=_0xbe74f6;if(!_0x502497[_0x2b8681(0x14f)](String(_0xaea4ca['ACQYEAR'])))return![];const _0x3ef1ca=String(_0xaea4ca[_0x2b8681(0xef)]),_0x4f63c9=String(_0xaea4ca[_0x2b8681(0x101)]),_0xb0894f=plluData[_0x2b8681(0x11e)](_0xe4c49=>String(_0xe4c49['PL_BLOCK'])===_0x4f63c9)?.['PL_USE'];if(!_0xb0894f||parseFloat(_0xaea4ca[_0x2b8681(0xef)])<0xa)return![];if(_0x3ecebf!==_0x2b8681(0x15a)&&_0xb0894f!==_0x3ecebf)return![];return _0x553b61[_0xb0894f]?.[_0x2b8681(0x14f)](_0x3ef1ca);}),_0x3e1f28=_0x453ea6[_0xbe74f6(0xdc)](_0x109323=>[0x1,0x2,0x3,0x4,0x5][_0xbe74f6(0x128)](_0x558335=>_0x109323+'_'+_0x558335))['sort'](),_0x5b2e8e=_0x26c696[_0xbe74f6(0x128)](_0x328d3f=>{const _0x23a641=_0xbe74f6,_0x2c7e5f=String(_0x328d3f[_0x23a641(0x101)]),_0x4b1af1=String(_0x328d3f[_0x23a641(0xc0)]),_0x159a03=_0x3d611e[_0x23a641(0x10a)](_0x5b2274=>String(_0x5b2274[_0x23a641(0x101)])===_0x2c7e5f),_0x29b5b1={};return _0x3e1f28[_0x23a641(0xbf)](_0x4422e6=>{const _0x42ba43=_0x23a641,[_0x42f649,_0x150a1f]=_0x4422e6[_0x42ba43(0x16c)]('_')['map'](Number);if(_0x553b61[_0x4b1af1]?.[_0x42ba43(0x14f)](String(_0x42f649))){const _0x3a020b=_0x159a03[_0x42ba43(0x10a)](_0x54a822=>parseFloat(_0x54a822[_0x42ba43(0xef)])===_0x42f649&&parseFloat(_0x54a822[_0x42ba43(0x156)])===_0x150a1f);_0x3a020b[_0x42ba43(0x154)]>0x0&&(_0x29b5b1[_0x4422e6]={'buildingCount':_0x3a020b['length'],'coveredArea':_0x3a020b['reduce']((_0x3a796e,_0x3ecac9)=>_0x3a796e+parseFloat(_0x3ecac9[_0x42ba43(0xd0)]),0x0),'landUseArea':calculateLandUseArea(_0x3a020b,_0x42f649,_0x150a1f)});}}),{'PL_BLOCK':_0x328d3f[_0x23a641(0x101)],'PL_USE':_0x328d3f[_0x23a641(0xc0)],'AREA':parseFloat(_0x328d3f[_0x23a641(0xe1)])||0x0,..._0x29b5b1};});calculationResults=_0x5b2e8e,totals=_0x5b2e8e[_0xbe74f6(0x13c)]((_0x393d90,_0x3859b7)=>{const _0x11ae1c=_0xbe74f6;return _0x393d90['AREA']=_0x393d90[_0x11ae1c(0xe1)]+_0x3859b7[_0x11ae1c(0xe1)],!_0x393d90['byPLUse'][_0x3859b7['PL_USE']]&&(_0x393d90[_0x11ae1c(0x105)][_0x3859b7[_0x11ae1c(0xc0)]]={'AREA':0x0}),_0x393d90[_0x11ae1c(0x105)][_0x3859b7[_0x11ae1c(0xc0)]][_0x11ae1c(0xe1)]=_0x393d90[_0x11ae1c(0x105)][_0x3859b7['PL_USE']]['AREA']+_0x3859b7[_0x11ae1c(0xe1)],_0x3e1f28[_0x11ae1c(0xbf)](_0x3d6f65=>{const _0x52b226=_0x11ae1c;_0x3859b7[_0x3d6f65]&&(!_0x393d90[_0x3d6f65]&&(_0x393d90[_0x3d6f65]={'buildingCount':0x0,'coveredArea':0x0,'landUseArea':0x0}),_0x393d90[_0x3d6f65][_0x52b226(0xd2)]+=_0x3859b7[_0x3d6f65][_0x52b226(0xd2)],_0x393d90[_0x3d6f65]['coveredArea']=_0x393d90[_0x3d6f65][_0x52b226(0x153)]+_0x3859b7[_0x3d6f65][_0x52b226(0x153)],_0x393d90[_0x3d6f65]['landUseArea']=_0x393d90[_0x3d6f65]['landUseArea']+_0x3859b7[_0x3d6f65][_0x52b226(0x119)],!_0x393d90[_0x52b226(0x105)][_0x3859b7[_0x52b226(0xc0)]][_0x3d6f65]&&(_0x393d90[_0x52b226(0x105)][_0x3859b7['PL_USE']][_0x3d6f65]={'buildingCount':0x0,'coveredArea':0x0,'landUseArea':0x0}),_0x393d90[_0x52b226(0x105)][_0x3859b7[_0x52b226(0xc0)]][_0x3d6f65][_0x52b226(0xd2)]+=_0x3859b7[_0x3d6f65][_0x52b226(0xd2)],_0x393d90[_0x52b226(0x105)][_0x3859b7[_0x52b226(0xc0)]][_0x3d6f65][_0x52b226(0x153)]=_0x393d90['byPLUse'][_0x3859b7[_0x52b226(0xc0)]][_0x3d6f65][_0x52b226(0x153)]+_0x3859b7[_0x3d6f65][_0x52b226(0x153)],_0x393d90[_0x52b226(0x105)][_0x3859b7[_0x52b226(0xc0)]][_0x3d6f65][_0x52b226(0x119)]=_0x393d90[_0x52b226(0x105)][_0x3859b7['PL_USE']][_0x3d6f65][_0x52b226(0x119)]+_0x3859b7[_0x3d6f65][_0x52b226(0x119)]);}),_0x393d90;},{'AREA':0x0,'byPLUse':{}}),displayTableResults(_0x5b2e8e,totals,_0x3e1f28,_0x3ecebf);}function _0x142c(){const _0x465e55=['คลังสินค้า\x20(พื้นที่คลุมดิน\x20501\x20ตร.ม.\x20ขึ้นไป)','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','พักอาศัยกึ่งพาณิชย์\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20101\x20-\x20400\x20ตร.ม.)','checkbox-group','เกษตรกรรม\x20(พักอาศัย\x20คอกปศุสัตว์\x20ฟาร์ม\x20ยุ้งฉาง)','querySelector','innerHTML','td,\x20th','<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวมทั้งหมด</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','findIndex','option','querySelectorAll','4081152yZKLzn','<th>พื้นที่การใช้ที่ดินรวม</th><th>ร้อยละพื้นที่</th><th>ร้อยละกิจการรอง</th></tr></thead><tbody>','plUse','reBLUseAreas','values','table_to_book','กรุณาเลือกไฟล์ทั้งสองไฟล์','<tr><th></th><th></th><th></th>','none','ACQYEAR','forEach','PL_USE','กรุณาคำนวณและเลือกดูตารางกิจกรรมที่ทำได้ก่อนการนำออกไฟล์\x20Excel','192897pmjarb','BL_TYPE','SheetNames','dataset','<td>0</td><td>0</td><td>0</td>','พักอาศัยกึ่งพาณิชย์\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20401\x20ตร.ม.\x20ขึ้นไป)','keys','placeholder','อุตสาหกรรม\x20(พื้นที่คลุมดิน\x20201\x20-\x20500\x20ตร.ม.)','พักอาศัยกึ่งพาณิชย์\x20อาคารทั่วไป','pluse-filter-group','toFixed','checkbox','mainActivitiesTableContainer','BL_AREA','.tab','buildingCount','.tab[onclick=\x22switchTab(\x27','#acqyear-filter\x20input:checked','exceed-limit-row','main_activities_calculation.xlsx','files','add','<td>','label','อุตสาหกรรม\x20(พื้นที่คลุมดิน\x20501\x20-\x201,000\x20ตร.ม.)','flatMap','change','htmlFor','<tr\x20class=\x22total-row\x20','re-bl-use-filters-container','AREA','secondary-percent-','22667571RFPWpg','max','</td>\x0a\x20\x20\x20\x20\x20\x20\x20<td>','Sheets','landUsePercentage','value','2887260Zylylo','totalLandUseArea','display','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','<th\x20colspan=\x223\x22>ผลรวม</th></tr>','en-US','RE_BL_USE','pluse-filter-header','result','867355MkXeOf','area','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวม\x20','push','secondary-percent-label','secondary-percent-item','<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20<td>ผลรวมทั้งหมด</td>\x0a\x20\x20\x20\x20\x20\x20\x20<td></td>\x0a\x20\x20\x20\x20\x20\x20\x20<td>','Secondary\x20Activities','reBLUseCounts','0.00','toLocaleString','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20</tr>','<th>จำนวนอาคาร</th><th>พื้นที่การใช้ที่ดิน</th>','input','PL_BLOCK','utils','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','type','byPLUse','<th\x20colspan=\x222\x22>รวมพื้นที่อาคารคลุมดิน</th><th\x20colspan=\x222\x22>การใช้ประโยชน์ที่ดิน</th></tr>','re-bl-use-','<th>จำนวนอาคาร</th><th>พื้นที่อาคารรวม</th><th>พื้นที่</th><th>ร้อยละพื้นที่</th></tr></thead><tbody>','6oogoqG','filter','พักอาศัย\x20อาคารพักอาศัยรวม','textContent','ประเภท\x20','7KrlHGB','cloneNode','<th>จำนวนอาคาร</th><th>พื้นที่อาคารคลุมดินรวม</th><th>พื้นที่การใช้ที่ดินรวม</th>','.table-scroll','<tr\x20class=\x22','<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวม\x20','plluFile','sort','style','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','พักอาศัย\x20บ้านแถว\x20ห้องแถว\x20ตึกแถว','landUseArea','appendChild','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>-</td>\x0a\x20\x20\x20\x20\x20\x20\x20</tr>','#mainActivitiesTableContainer\x20table','readAsArrayBuffer','find','sheet_to_json','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','buildingFile','indexOf','100','tableContainer','\x27)\x22]','collapsed','acqyear-','map','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','Main\x20Activities','<th\x20colspan=\x222\x22>','flat','trim','พาณิชย์\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20101\x20-\x20400\x20ตร.ม.)','round','อื่นๆ','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','replace','writeFile','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','pl-use-filter','secondaryPercentGrid','exceedsLimit','block','Sheet\x20JS','classList','active','reduce','createElement','</th>','กรุณาคำนวณข้อมูลก่อนการนำออกไฟล์\x20Excel','<th\x20colspan=\x222\x22>ผลรวม</th></tr>','getElementById','toggle','addEventListener','#tableContainer\x20table','div','คลังสินค้า\x20(พื้นที่คลุมดินไม่เกิน\x20100\x20ตร.ม.)','number','EPSILON','.filter-container','0.01','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','อุตสาหกรรม\x20(พื้นที่คลุมดิน\x201,001\x20ตร.ม.\x20ขึ้นไป)','</tbody></table>','<table><thead><tr><th>บริเวณการใช้ประโยชน์ที่ดิน</th><th>ประเภทการใช้ที่ดิน</th><th>พื้นที่\x20block</th>','includes','กรุณาคำนวณและเลือกดูตารางกิจกรรมรองก่อนการนำออกไฟล์\x20Excel','</td>','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','coveredArea','length','<th>พื้นที่การใช้ที่ดินรวม</th><th>ร้อยละพื้นที่</th></tr></thead><tbody>','RE_BL_AREA','from','secondary-percent-input','entries','all','checked','พักอาศัย\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20401\x20ตร.ม.\x20ขึ้นไป)','\x22]:checked','secondaryPercentContent','762492EQkSmW','.tab-content','<option\x20value=\x22all\x22>ทั้งหมด</option>','acqyear-filter','closest','secondaryActivitiesTable','<p>กรุณาคำนวณข้อมูลก่อนการจัดกลุ่มการใช้ประโยชน์ที่ดิน</p>','%</td>\x0a\x20\x20\x20</tr>','พักอาศัย\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20101\x20-\x20400\x20ตร.ม.)','input[type=\x22checkbox\x22][data-pl-use=\x22','3949662rkrdMJ','read','min','split','คลังสินค้า\x20(พื้นที่คลุมดิน\x20101\x20-\x20500\x20ตร.ม.)','onload','BL_USE','.pluse-filter-group','พักอาศัย\x20บ้านเดี่ยว\x20บ้านแฝด','#secondaryActivitiesTableContainer\x20table','\x20-\x20ร้อยละกิจการรอง:','target'];_0x142c=function(){return _0x465e55;};return _0x142c();}function displayTableResults(_0x3a643b,_0x2827ee,_0x233b32,_0xcd3584){const _0x4dc241=_0x56708b,_0x2efb39=document[_0x4dc241(0x141)](_0x4dc241(0x124)),_0x4ca1bc=_0x2efb39[_0x4dc241(0x17a)](_0x4dc241(0x111));let _0xb44ba4=_0x4dc241(0x14e);const _0x4f7acc=_0x233b32[_0x4dc241(0x10a)](_0x5c5d05=>_0x3a643b['some'](_0x2618c3=>_0x2618c3[_0x5c5d05]));_0x4f7acc[_0x4dc241(0xbf)](_0x31c368=>{const _0x4fb972=reBLUseLabelMap[_0x31c368]||_0x31c368;_0xb44ba4+='<th\x20colspan=\x223\x22>'+_0x4fb972+'</th>';}),_0xb44ba4+=_0x4dc241(0x106),_0xb44ba4+=_0x4dc241(0xbc),_0x4f7acc[_0x4dc241(0xbf)](()=>{const _0x3cbfc6=_0x4dc241;_0xb44ba4+=_0x3cbfc6(0x110);}),_0xb44ba4+=_0x4dc241(0x108);if(_0xcd3584!==_0x4dc241(0x15a)){const _0x52dc37=_0x3a643b[_0x4dc241(0x115)]((_0x161c15,_0x45ea45)=>{const _0x4c7a1a=_0x4dc241,_0x6aa2ff=plluOriginalOrder['findIndex'](_0x315e81=>_0x315e81[_0x4c7a1a(0x101)]===_0x161c15[_0x4c7a1a(0x101)]),_0x191abe=plluOriginalOrder['findIndex'](_0x1d8d6a=>_0x1d8d6a[_0x4c7a1a(0x101)]===_0x45ea45['PL_BLOCK']);return _0x6aa2ff-_0x191abe;});_0x52dc37[_0x4dc241(0xbf)](_0x357dcc=>{const _0x2d449a=_0x4dc241;_0xb44ba4+=_0x2d449a(0x152)+_0x357dcc['PL_BLOCK']+_0x2d449a(0x120)+_0x357dcc[_0x2d449a(0xc0)]+_0x2d449a(0x120)+formatNumberTwoDecimal(_0x357dcc['AREA'])+_0x2d449a(0x151);let _0x95477f=0x0,_0x1de0c8=0x0,_0x123fcf=0x0;_0x4f7acc[_0x2d449a(0xbf)](_0x5d9e3f=>{const _0x70aeea=_0x2d449a;_0x357dcc[_0x5d9e3f]?(_0xb44ba4+='<td>'+formatBuildingCount(_0x357dcc[_0x5d9e3f][_0x70aeea(0xd2)])+_0x70aeea(0x131)+formatNumberTwoDecimal(_0x357dcc[_0x5d9e3f][_0x70aeea(0x153)])+_0x70aeea(0x131)+formatNumberTwoDecimal(_0x357dcc[_0x5d9e3f][_0x70aeea(0x119)])+'</td>',_0x95477f+=_0x357dcc[_0x5d9e3f][_0x70aeea(0xd2)],_0x1de0c8=_0x1de0c8+_0x357dcc[_0x5d9e3f][_0x70aeea(0x153)],_0x123fcf=_0x123fcf+_0x357dcc[_0x5d9e3f][_0x70aeea(0x119)]):_0xb44ba4+=_0x70aeea(0xc6);});const _0x405563=roundToTwoDecimals(_0x123fcf/_0x357dcc[_0x2d449a(0xe1)]*0x64);_0xb44ba4+=_0x2d449a(0xd9)+formatBuildingCount(_0x95477f)+_0x2d449a(0x120)+formatNumberTwoDecimal(_0x1de0c8)+_0x2d449a(0x120)+formatNumberTwoDecimal(_0x123fcf)+_0x2d449a(0x120)+formatNumber(_0x405563)+_0x2d449a(0x176);});}else{const _0x5e3874={};_0x3a643b[_0x4dc241(0xbf)](_0xf8dd20=>{const _0x5c82fe=_0x4dc241,_0x480ea8=_0xf8dd20[_0x5c82fe(0xc0)];!_0x5e3874[_0x480ea8]&&(_0x5e3874[_0x480ea8]=[]),_0x5e3874[_0x480ea8][_0x5c82fe(0xf5)](_0xf8dd20);});const _0x75305=Object[_0x4dc241(0xc8)](_0x5e3874)[_0x4dc241(0x115)]((_0x2b526d,_0x86cb68)=>{const _0x234c9b=_0x4dc241,_0x34cf4c=plluData[_0x234c9b(0xb2)](_0x4e09ee=>String(_0x4e09ee['PL_USE'])===_0x2b526d),_0x473fd4=plluData['findIndex'](_0xe83934=>String(_0xe83934[_0x234c9b(0xc0)])===_0x86cb68);return _0x34cf4c-_0x473fd4;});_0x75305[_0x4dc241(0xbf)](_0x4d6d0f=>{const _0x46bcf0=_0x4dc241,_0x49acb3=_0x5e3874[_0x4d6d0f],_0x22f02e=_0x49acb3['sort']((_0x35e067,_0x3db1a7)=>{const _0x1eb71d=_0x5424,_0x4327a7=plluOriginalOrder[_0x1eb71d(0xb2)](_0x26e4fd=>_0x26e4fd['PL_BLOCK']===_0x35e067['PL_BLOCK']),_0x3b653b=plluOriginalOrder['findIndex'](_0x3b40f4=>_0x3b40f4['PL_BLOCK']===_0x3db1a7[_0x1eb71d(0x101)]);return _0x4327a7-_0x3b653b;});let _0x2758d0=0x0,_0xc4184=0x0,_0x4dc0de=0x0,_0x414e10=0x0;_0x22f02e[_0x46bcf0(0xbf)](_0x1f5162=>{const _0x2ab949=_0x46bcf0;_0x414e10=_0x414e10+_0x1f5162[_0x2ab949(0xe1)],_0x4f7acc[_0x2ab949(0xbf)](_0x5e9b63=>{const _0x5411e7=_0x2ab949;_0x1f5162[_0x5e9b63]&&(_0x2758d0+=_0x1f5162[_0x5e9b63]['buildingCount'],_0xc4184=_0xc4184+_0x1f5162[_0x5e9b63]['coveredArea'],_0x4dc0de=_0x4dc0de+_0x1f5162[_0x5e9b63][_0x5411e7(0x119)]);});}),_0x22f02e[_0x46bcf0(0xbf)]((_0x1ac7a7,_0x5aa423)=>{const _0xc8f113=_0x46bcf0;_0xb44ba4+=_0xc8f113(0xec)+_0x1ac7a7[_0xc8f113(0x101)]+_0xc8f113(0x103)+(_0x5aa423===0x0?_0x1ac7a7['PL_USE']:'')+_0xc8f113(0x103)+formatNumberTwoDecimal(_0x1ac7a7[_0xc8f113(0xe1)])+_0xc8f113(0x151);let _0x693fc3=0x0,_0x47dae2=0x0,_0x5b9956=0x0;_0x4f7acc[_0xc8f113(0xbf)](_0x53e72c=>{const _0xbc46f2=_0xc8f113;_0x1ac7a7[_0x53e72c]?(_0xb44ba4+=_0xbc46f2(0xd9)+formatBuildingCount(_0x1ac7a7[_0x53e72c][_0xbc46f2(0xd2)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x1ac7a7[_0x53e72c][_0xbc46f2(0x153)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x1ac7a7[_0x53e72c][_0xbc46f2(0x119)])+_0xbc46f2(0x151),_0x693fc3+=_0x1ac7a7[_0x53e72c][_0xbc46f2(0xd2)],_0x47dae2=_0x47dae2+_0x1ac7a7[_0x53e72c][_0xbc46f2(0x153)],_0x5b9956=_0x5b9956+_0x1ac7a7[_0x53e72c]['landUseArea']):_0xb44ba4+=_0xbc46f2(0xc6);});const _0x1b2deb=roundToTwoDecimals(_0x5b9956/_0x1ac7a7[_0xc8f113(0xe1)]*0x64);_0xb44ba4+=_0xc8f113(0xd9)+formatBuildingCount(_0x693fc3)+_0xc8f113(0x103)+formatNumberTwoDecimal(_0x47dae2)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x5b9956)+_0xc8f113(0x103)+formatNumber(_0x1b2deb)+_0xc8f113(0x134);});const _0x4d96c1=roundToTwoDecimals(_0x4dc0de/_0x414e10*0x64);_0xb44ba4+=_0x46bcf0(0x113)+_0x4d6d0f+_0x46bcf0(0x129)+formatNumberTwoDecimal(_0x414e10)+_0x46bcf0(0x151),_0x4f7acc[_0x46bcf0(0xbf)](_0x2a5a70=>{const _0x3e9983=_0x46bcf0,_0x665d68=_0x2827ee[_0x3e9983(0x105)][_0x4d6d0f]?.[_0x2a5a70];_0x665d68?_0xb44ba4+=_0x3e9983(0xd9)+formatBuildingCount(_0x665d68[_0x3e9983(0xd2)])+_0x3e9983(0x131)+formatNumberTwoDecimal(_0x665d68[_0x3e9983(0x153)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x665d68[_0x3e9983(0x119)])+_0x3e9983(0x151):_0xb44ba4+=_0x3e9983(0xc6);}),_0xb44ba4+=_0x46bcf0(0xd9)+formatBuildingCount(_0x2758d0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0xc4184)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x4dc0de)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x4d96c1)+_0x46bcf0(0x176);});}let _0x3d38a5=0x0,_0x18c2d8=0x0,_0x28eafe=0x0;_0x4f7acc[_0x4dc241(0xbf)](_0x4780e0=>{const _0x284904=_0x4dc241;_0x2827ee[_0x4780e0]&&(_0x3d38a5+=_0x2827ee[_0x4780e0][_0x284904(0xd2)],_0x18c2d8=_0x18c2d8+_0x2827ee[_0x4780e0]['coveredArea'],_0x28eafe=_0x28eafe+_0x2827ee[_0x4780e0][_0x284904(0x119)]);});const _0x432506=roundToTwoDecimals(_0x28eafe/_0x2827ee[_0x4dc241(0xe1)]*0x64);_0xb44ba4+=_0x4dc241(0xf8)+formatNumberTwoDecimal(_0x2827ee[_0x4dc241(0xe1)])+'</td>',_0x4f7acc[_0x4dc241(0xbf)](_0x2fa849=>{const _0x69f6d1=_0x4dc241;_0x2827ee[_0x2fa849]?_0xb44ba4+=_0x69f6d1(0xd9)+formatBuildingCount(_0x2827ee[_0x2fa849][_0x69f6d1(0xd2)])+_0x69f6d1(0x120)+formatNumberTwoDecimal(_0x2827ee[_0x2fa849]['coveredArea'])+_0x69f6d1(0x120)+formatNumberTwoDecimal(_0x2827ee[_0x2fa849][_0x69f6d1(0x119)])+_0x69f6d1(0x151):_0xb44ba4+=_0x69f6d1(0xc6);}),_0xb44ba4+=_0x4dc241(0xd9)+formatBuildingCount(_0x3d38a5)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x18c2d8)+_0x4dc241(0xe5)+formatNumberTwoDecimal(_0x28eafe)+_0x4dc241(0xe5)+formatNumber(_0x432506)+_0x4dc241(0x166),_0xb44ba4+=_0x4dc241(0x14d),_0x4ca1bc[_0x4dc241(0x17b)]=_0xb44ba4;}function calculateMainActivitiesTable(){const _0x2d845e=_0x56708b;if(!calculationResults||calculationResults[_0x2d845e(0x154)]===0x0){document[_0x2d845e(0x141)](_0x2d845e(0xcf))[_0x2d845e(0x17a)](_0x2d845e(0x111))['innerHTML']=_0x2d845e(0x165);return;}const _0x1bd4f8=document[_0x2d845e(0x141)]('mainActivitiesTableContainer'),_0x1ba02f=_0x1bd4f8[_0x2d845e(0x17a)](_0x2d845e(0x111)),_0x4b0e3e=[0xa,0x14,0x29,0x1e,0x21,0x50,0x5a];let _0xc1a06b=_0x2d845e(0x14e);_0x4b0e3e[_0x2d845e(0xbf)](_0x325f23=>{const _0x2a3d21=_0x2d845e,_0x426b90=_0x325f23+'_1',_0x187feb=reBLUseLabelMap[_0x426b90]?reBLUseLabelMap[_0x426b90][_0x2a3d21(0x16c)]('\x20')[0x0]:_0x2a3d21(0x10d)+_0x325f23;_0xc1a06b+='<th\x20colspan=\x222\x22>'+_0x187feb+_0x2a3d21(0x13e);}),_0xc1a06b+=_0x2d845e(0x140),_0xc1a06b+=_0x2d845e(0xbc),_0x4b0e3e[_0x2d845e(0xbf)](()=>{_0xc1a06b+='<th>จำนวนอาคาร</th><th>พื้นที่การใช้ที่ดิน</th>';}),_0xc1a06b+=_0x2d845e(0x155);const _0x58cb2d=document['getElementById'](_0x2d845e(0x135))[_0x2d845e(0xe8)];if(_0x58cb2d!==_0x2d845e(0x15a)){const _0x1de49c=calculationResults[_0x2d845e(0x115)]((_0x1653e6,_0x59c318)=>{const _0x393099=_0x2d845e,_0x206130=plluOriginalOrder[_0x393099(0xb2)](_0x5d5db7=>_0x5d5db7[_0x393099(0x101)]===_0x1653e6['PL_BLOCK']),_0x24c09d=plluOriginalOrder[_0x393099(0xb2)](_0x2a675f=>_0x2a675f['PL_BLOCK']===_0x59c318[_0x393099(0x101)]);return _0x206130-_0x24c09d;});_0x1de49c[_0x2d845e(0xbf)](_0x4a7e66=>{const _0x2db8b6=_0x2d845e;let _0x54736b=0x0,_0x45445f={},_0x5dc633={};_0x4b0e3e[_0x2db8b6(0xbf)](_0x9f300d=>{const _0x5c9fc0=_0x2db8b6;_0x45445f[_0x9f300d]=0x0,_0x5dc633[_0x9f300d]=0x0;for(let _0x2765f0=0x1;_0x2765f0<=0x5;_0x2765f0++){const _0x16f3b3=_0x9f300d+'_'+_0x2765f0;_0x4a7e66[_0x16f3b3]&&(_0x45445f[_0x9f300d]+=_0x4a7e66[_0x16f3b3][_0x5c9fc0(0xd2)],_0x5dc633[_0x9f300d]=_0x5dc633[_0x9f300d]+_0x4a7e66[_0x16f3b3][_0x5c9fc0(0x119)],_0x54736b=_0x54736b+_0x4a7e66[_0x16f3b3][_0x5c9fc0(0x119)]);}});const _0x2cac23=roundToTwoDecimals(_0x54736b/_0x4a7e66[_0x2db8b6(0xe1)]*0x64);_0xc1a06b+=_0x2db8b6(0x152)+_0x4a7e66['PL_BLOCK']+_0x2db8b6(0x120)+_0x4a7e66[_0x2db8b6(0xc0)]+_0x2db8b6(0x120)+formatNumberTwoDecimal(_0x4a7e66['AREA'])+'</td>',_0x4b0e3e[_0x2db8b6(0xbf)](_0x4c937e=>{const _0x371a1a=_0x2db8b6;_0xc1a06b+='<td>'+formatBuildingCount(_0x45445f[_0x4c937e])+_0x371a1a(0x103)+formatNumberTwoDecimal(_0x5dc633[_0x4c937e])+_0x371a1a(0x151);}),_0xc1a06b+=_0x2db8b6(0xd9)+formatNumberTwoDecimal(_0x54736b)+_0x2db8b6(0x120)+formatNumber(_0x2cac23)+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>';});}else{const _0x4118fe={};calculationResults[_0x2d845e(0xbf)](_0x375061=>{const _0x36d90a=_0x2d845e,_0xdebf84=_0x375061[_0x36d90a(0xc0)];!_0x4118fe[_0xdebf84]&&(_0x4118fe[_0xdebf84]=[]),_0x4118fe[_0xdebf84]['push'](_0x375061);});const _0x3e222d=Object['keys'](_0x4118fe)[_0x2d845e(0x115)]((_0x4d8f18,_0x98e410)=>{const _0x4f3d38=_0x2d845e,_0x411dfe=plluData['findIndex'](_0x1ded1f=>String(_0x1ded1f[_0x4f3d38(0xc0)])===_0x4d8f18),_0x2bb50e=plluData[_0x4f3d38(0xb2)](_0x4f5b88=>String(_0x4f5b88['PL_USE'])===_0x98e410);return _0x411dfe-_0x2bb50e;});_0x3e222d[_0x2d845e(0xbf)](_0x192e40=>{const _0x377e61=_0x2d845e,_0x21c1f9=_0x4118fe[_0x192e40],_0x502b37=_0x21c1f9[_0x377e61(0x115)]((_0xf766ae,_0x5c9b55)=>{const _0x2c5a26=_0x377e61,_0x539eef=plluOriginalOrder['findIndex'](_0xcc917a=>_0xcc917a[_0x2c5a26(0x101)]===_0xf766ae['PL_BLOCK']),_0x64fcae=plluOriginalOrder[_0x2c5a26(0xb2)](_0x437f09=>_0x437f09[_0x2c5a26(0x101)]===_0x5c9b55[_0x2c5a26(0x101)]);return _0x539eef-_0x64fcae;});let _0x8b3de8=0x0;const _0x531d75={};let _0x3a753c=0x0;const _0x89364=[];_0x502b37[_0x377e61(0xbf)](_0x10c3a6=>{const _0x584e92=_0x377e61;_0x8b3de8=_0x8b3de8+_0x10c3a6[_0x584e92(0xe1)];let _0x47691f=0x0,_0x226a55={},_0x107a92={};_0x4b0e3e[_0x584e92(0xbf)](_0xbc9abd=>{const _0x188d96=_0x584e92;_0x226a55[_0xbc9abd]=0x0,_0x107a92[_0xbc9abd]=0x0;for(let _0x1a2b09=0x1;_0x1a2b09<=0x5;_0x1a2b09++){const _0x2ca3e8=_0xbc9abd+'_'+_0x1a2b09;_0x10c3a6[_0x2ca3e8]&&(_0x226a55[_0xbc9abd]+=_0x10c3a6[_0x2ca3e8][_0x188d96(0xd2)],_0x107a92[_0xbc9abd]=_0x107a92[_0xbc9abd]+_0x10c3a6[_0x2ca3e8][_0x188d96(0x119)],_0x47691f=_0x47691f+_0x10c3a6[_0x2ca3e8][_0x188d96(0x119)],!_0x531d75[_0xbc9abd]&&(_0x531d75[_0xbc9abd]={'buildingCount':0x0,'landUseArea':0x0}),_0x531d75[_0xbc9abd]['buildingCount']+=_0x10c3a6[_0x2ca3e8][_0x188d96(0xd2)],_0x531d75[_0xbc9abd]['landUseArea']=_0x531d75[_0xbc9abd][_0x188d96(0x119)]+_0x10c3a6[_0x2ca3e8][_0x188d96(0x119)],_0x3a753c=_0x3a753c+_0x10c3a6[_0x2ca3e8][_0x188d96(0x119)]);}});const _0x5405e8=roundToTwoDecimals(_0x47691f/_0x10c3a6[_0x584e92(0xe1)]*0x64);_0x89364['push']({'block':_0x10c3a6['PL_BLOCK'],'area':_0x10c3a6[_0x584e92(0xe1)],'reBLUseCounts':_0x226a55,'reBLUseAreas':_0x107a92,'totalLandUseArea':_0x47691f,'landUsePercentage':_0x5405e8});}),_0x89364['forEach']((_0x3efd9b,_0x4eaaa7)=>{const _0x36b709=_0x377e61;_0xc1a06b+='<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3efd9b['block']+_0x36b709(0x103)+(_0x4eaaa7===0x0?_0x192e40:'')+_0x36b709(0x103)+formatNumberTwoDecimal(_0x3efd9b[_0x36b709(0xf3)])+_0x36b709(0x151),_0x4b0e3e['forEach'](_0x5a714a=>{const _0x2c9d34=_0x36b709;_0xc1a06b+=_0x2c9d34(0xd9)+formatBuildingCount(_0x3efd9b[_0x2c9d34(0xfa)][_0x5a714a])+_0x2c9d34(0x131)+formatNumberTwoDecimal(_0x3efd9b['reBLUseAreas'][_0x5a714a])+'</td>';}),_0xc1a06b+=_0x36b709(0xd9)+formatNumberTwoDecimal(_0x3efd9b[_0x36b709(0xea)])+_0x36b709(0x103)+formatNumber(_0x3efd9b[_0x36b709(0xe7)])+_0x36b709(0x134);});const _0x4ca318=roundToTwoDecimals(_0x3a753c/_0x8b3de8*0x64);_0xc1a06b+='<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวม\x20'+_0x192e40+_0x377e61(0x129)+formatNumberTwoDecimal(_0x8b3de8)+_0x377e61(0x151),_0x4b0e3e['forEach'](_0x1ba21d=>{const _0x3763a1=_0x377e61,_0x29544b=_0x531d75[_0x1ba21d]||{'buildingCount':0x0,'landUseArea':0x0};_0xc1a06b+=_0x3763a1(0xd9)+formatBuildingCount(_0x29544b['buildingCount'])+_0x3763a1(0x103)+formatNumberTwoDecimal(_0x29544b[_0x3763a1(0x119)])+_0x3763a1(0x151);}),_0xc1a06b+='<td>'+formatNumberTwoDecimal(_0x3a753c)+_0x377e61(0x120)+formatNumber(_0x4ca318)+_0x377e61(0x176);});let _0x336038=0x0;const _0x37a2f4={};let _0x263b0c=0x0;Object['entries'](_0x4118fe)[_0x2d845e(0xbf)](([_0x14970e,_0x2082cc])=>{const _0x54aea0=_0x2d845e;_0x2082cc[_0x54aea0(0xbf)](_0x120236=>{const _0x3194e1=_0x54aea0;_0x336038=_0x336038+_0x120236[_0x3194e1(0xe1)],_0x4b0e3e[_0x3194e1(0xbf)](_0x1de674=>{const _0x366fcc=_0x3194e1;!_0x37a2f4[_0x1de674]&&(_0x37a2f4[_0x1de674]={'buildingCount':0x0,'landUseArea':0x0});for(let _0x2ee6c6=0x1;_0x2ee6c6<=0x5;_0x2ee6c6++){const _0x1d3e48=_0x1de674+'_'+_0x2ee6c6;_0x120236[_0x1d3e48]&&(_0x37a2f4[_0x1de674]['buildingCount']+=_0x120236[_0x1d3e48][_0x366fcc(0xd2)],_0x37a2f4[_0x1de674][_0x366fcc(0x119)]=_0x37a2f4[_0x1de674]['landUseArea']+_0x120236[_0x1d3e48][_0x366fcc(0x119)],_0x263b0c=_0x263b0c+_0x120236[_0x1d3e48][_0x366fcc(0x119)]);}});});});const _0x53d5c0=roundToTwoDecimals(_0x263b0c/_0x336038*0x64);_0xc1a06b+=_0x2d845e(0xb1)+formatNumberTwoDecimal(_0x336038)+_0x2d845e(0x151),_0x4b0e3e[_0x2d845e(0xbf)](_0x5bc8f7=>{const _0x900ac8=_0x2d845e,_0x37c217=_0x37a2f4[_0x5bc8f7]||{'buildingCount':0x0,'landUseArea':0x0};_0xc1a06b+=_0x900ac8(0xd9)+formatBuildingCount(_0x37c217['buildingCount'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x37c217[_0x900ac8(0x119)])+_0x900ac8(0x151);}),_0xc1a06b+=_0x2d845e(0xd9)+formatNumberTwoDecimal(_0x263b0c)+_0x2d845e(0x14b)+formatNumber(_0x53d5c0)+_0x2d845e(0xfe);}_0xc1a06b+=_0x2d845e(0x14d),_0x1ba02f[_0x2d845e(0x17b)]=_0xc1a06b;}function calculateSecondaryActivitiesTable(){const _0x59a152=_0x56708b;if(!calculationResults||calculationResults[_0x59a152(0x154)]===0x0){document[_0x59a152(0x141)]('secondaryActivitiesTableContainer')[_0x59a152(0x17a)]('.table-scroll')[_0x59a152(0x17b)]='<p>กรุณาคำนวณข้อมูลก่อนการจัดกลุ่มการใช้ประโยชน์ที่ดิน</p>';return;}const _0x45e374=document[_0x59a152(0x141)]('secondaryActivitiesTableContainer'),_0x566c5b=_0x45e374[_0x59a152(0x17a)](_0x59a152(0x111)),_0xa0e796=[0xa,0x14,0x29,0x1e,0x21,0x50,0x5a],_0xca27b6=document['getElementById'](_0x59a152(0x135))['value'],_0x23d739={};if(_0xca27b6==='all'){const _0x2ccd2c=[...new Set(plluData[_0x59a152(0x128)](_0x27d12e=>String(_0x27d12e[_0x59a152(0xc0)])))]['sort']();_0x2ccd2c[_0x59a152(0xbf)](_0x4d1445=>{const _0x15730c=_0x59a152,_0x40d859=document[_0x15730c(0xb4)](_0x15730c(0x168)+_0x4d1445+_0x15730c(0x15d)),_0x435166=Array[_0x15730c(0x157)](_0x40d859)[_0x15730c(0x128)](_0x5a1c07=>String(_0x5a1c07[_0x15730c(0xe8)])),_0x261650=document[_0x15730c(0xb4)](_0x15730c(0x168)+_0x4d1445+'\x22]'),_0x171c5b=Array[_0x15730c(0x157)](_0x261650)['map'](_0x3832f0=>String(_0x3832f0[_0x15730c(0xe8)]));_0x23d739[_0x4d1445]=_0x171c5b[_0x15730c(0x10a)](_0x1cb926=>!_0x435166[_0x15730c(0x14f)](_0x1cb926));});}else{const _0x512751=document[_0x59a152(0xb4)](_0x59a152(0x168)+_0xca27b6+'\x22]:checked'),_0x3fbbcc=Array[_0x59a152(0x157)](_0x512751)[_0x59a152(0x128)](_0x4c9b13=>String(_0x4c9b13['value'])),_0x31459f=document[_0x59a152(0xb4)](_0x59a152(0x168)+_0xca27b6+'\x22]'),_0x37c529=Array[_0x59a152(0x157)](_0x31459f)['map'](_0x3b4707=>String(_0x3b4707[_0x59a152(0xe8)]));_0x23d739[_0xca27b6]=_0x37c529['filter'](_0x17187e=>!_0x3fbbcc[_0x59a152(0x14f)](_0x17187e));}const _0x280f71=Array[_0x59a152(0x157)](document[_0x59a152(0xb4)](_0x59a152(0xd4)))[_0x59a152(0x128)](_0x225850=>String(_0x225850[_0x59a152(0xe8)])),_0x526cee=_0xca27b6===_0x59a152(0x15a)?plluData:plluData['filter'](_0x356e64=>String(_0x356e64[_0x59a152(0xc0)])===_0xca27b6),_0x2a7597=buildingData[_0x59a152(0x10a)](_0x561ef9=>{const _0x3df909=_0x59a152;if(!_0x280f71['includes'](String(_0x561ef9[_0x3df909(0xbe)])))return![];const _0x10be00=String(_0x561ef9[_0x3df909(0xef)]),_0x331a89=String(_0x561ef9[_0x3df909(0x101)]),_0x4de354=plluData[_0x3df909(0x11e)](_0x3049c6=>String(_0x3049c6[_0x3df909(0x101)])===_0x331a89)?.[_0x3df909(0xc0)];if(!_0x4de354||parseFloat(_0x561ef9[_0x3df909(0xef)])<0xa)return![];if(_0xca27b6!==_0x3df909(0x15a)&&_0x4de354!==_0xca27b6)return![];return _0x23d739[_0x4de354]?.['includes'](_0x10be00);});let _0x7e24a5=_0x59a152(0x14e);_0xa0e796[_0x59a152(0xbf)](_0x362e57=>{const _0x4d093b=_0x59a152,_0x1c53cc=_0x362e57+'_1',_0x4fc0c2=reBLUseLabelMap[_0x1c53cc]?reBLUseLabelMap[_0x1c53cc]['split']('\x20')[0x0]:_0x4d093b(0x10d)+_0x362e57;_0x7e24a5+=_0x4d093b(0x12b)+_0x4fc0c2+_0x4d093b(0x13e);}),_0x7e24a5+=_0x59a152(0xed),_0x7e24a5+=_0x59a152(0xbc),_0xa0e796[_0x59a152(0xbf)](()=>{const _0x141d2d=_0x59a152;_0x7e24a5+=_0x141d2d(0xff);}),_0x7e24a5+=_0x59a152(0xb6);const _0x500db5=_0x526cee[_0x59a152(0x128)](_0x4827ac=>{const _0x312a45=_0x59a152,_0xd22f28=String(_0x4827ac[_0x312a45(0x101)]),_0x2a1797=String(_0x4827ac[_0x312a45(0xc0)]),_0x4e57d7=_0x2a7597[_0x312a45(0x10a)](_0x3c8b04=>String(_0x3c8b04[_0x312a45(0x101)])===_0xd22f28),_0x188e5d={},_0xde282d=_0x23d739[_0x2a1797]||[],_0x2cda07=_0xde282d[_0x312a45(0xdc)](_0x383ddc=>[0x1,0x2,0x3,0x4,0x5][_0x312a45(0x128)](_0x54fa31=>_0x383ddc+'_'+_0x54fa31))['sort']();return _0x2cda07[_0x312a45(0xbf)](_0x166afc=>{const _0x6290c1=_0x312a45,[_0x1fe560,_0x23ace9]=_0x166afc[_0x6290c1(0x16c)]('_')[_0x6290c1(0x128)](Number),_0x44f4a4=_0x4e57d7[_0x6290c1(0x10a)](_0x35399a=>parseFloat(_0x35399a['RE_BL_USE'])===_0x1fe560&&parseFloat(_0x35399a[_0x6290c1(0x156)])===_0x23ace9);_0x44f4a4[_0x6290c1(0x154)]>0x0&&(_0x188e5d[_0x166afc]={'buildingCount':_0x44f4a4[_0x6290c1(0x154)],'coveredArea':_0x44f4a4[_0x6290c1(0x13c)]((_0x3c4c68,_0x591f46)=>_0x3c4c68+parseFloat(_0x591f46[_0x6290c1(0xd0)]),0x0),'landUseArea':calculateLandUseArea(_0x44f4a4,_0x1fe560,_0x23ace9)});}),{'PL_BLOCK':_0x4827ac[_0x312a45(0x101)],'PL_USE':_0x4827ac[_0x312a45(0xc0)],'AREA':parseFloat(_0x4827ac[_0x312a45(0xe1)])||0x0,..._0x188e5d};});if(_0xca27b6!==_0x59a152(0x15a)){const _0x440abb=_0x500db5[_0x59a152(0x115)]((_0x58aa3d,_0x4336c2)=>{const _0x2be487=_0x59a152,_0x161df2=plluOriginalOrder[_0x2be487(0xb2)](_0x3d6336=>_0x3d6336[_0x2be487(0x101)]===_0x58aa3d['PL_BLOCK']),_0x1c7b55=plluOriginalOrder[_0x2be487(0xb2)](_0x5be651=>_0x5be651[_0x2be487(0x101)]===_0x4336c2[_0x2be487(0x101)]);return _0x161df2-_0x1c7b55;});_0x440abb[_0x59a152(0xbf)](_0x332a98=>{const _0x4d9390=_0x59a152,_0x180fdc=_0x332a98['PL_USE'],_0x2a481a=secondaryPercentages[_0x180fdc]||0x0;let _0x575798=0x0,_0x2d384f={},_0xc65a52={};_0xa0e796['forEach'](_0x4f10bb=>{const _0x1d05b8=_0x5424;_0x2d384f[_0x4f10bb]=0x0,_0xc65a52[_0x4f10bb]=0x0;for(let _0x14a0b5=0x1;_0x14a0b5<=0x5;_0x14a0b5++){const _0x334448=_0x4f10bb+'_'+_0x14a0b5;_0x332a98[_0x334448]&&(_0x2d384f[_0x4f10bb]+=_0x332a98[_0x334448][_0x1d05b8(0xd2)],_0xc65a52[_0x4f10bb]=_0xc65a52[_0x4f10bb]+_0x332a98[_0x334448]['landUseArea'],_0x575798=_0x575798+_0x332a98[_0x334448][_0x1d05b8(0x119)]);}});const _0x351e3d=roundToTwoDecimals(_0x575798/_0x332a98[_0x4d9390(0xe1)]*0x64),_0x3604c5=_0x2a481a>0x0&&_0x351e3d>_0x2a481a;_0x7e24a5+=_0x4d9390(0x112)+(_0x3604c5?_0x4d9390(0xd5):'')+_0x4d9390(0x117)+_0x332a98['PL_BLOCK']+_0x4d9390(0x120)+_0x332a98[_0x4d9390(0xc0)]+_0x4d9390(0x120)+formatNumberTwoDecimal(_0x332a98['AREA'])+_0x4d9390(0x151),_0xa0e796[_0x4d9390(0xbf)](_0x290b4e=>{const _0x331f4a=_0x4d9390;_0x7e24a5+='<td>'+formatBuildingCount(_0x2d384f[_0x290b4e])+_0x331f4a(0x103)+formatNumberTwoDecimal(_0xc65a52[_0x290b4e])+'</td>';}),_0x7e24a5+=_0x4d9390(0xd9)+formatNumberTwoDecimal(_0x575798)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x351e3d)+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x2a481a)+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>';});}else{const _0x552bb3={};_0x500db5[_0x59a152(0xbf)](_0x2468d4=>{const _0x4b0ab2=_0x59a152,_0x240066=_0x2468d4[_0x4b0ab2(0xc0)];!_0x552bb3[_0x240066]&&(_0x552bb3[_0x240066]=[]),_0x552bb3[_0x240066]['push'](_0x2468d4);});const _0x126d08=Object[_0x59a152(0xc8)](_0x552bb3)[_0x59a152(0x115)]((_0x1d7a32,_0x132081)=>{const _0x29948c=_0x59a152,_0x483bad=plluData[_0x29948c(0xb2)](_0xe9cb03=>String(_0xe9cb03[_0x29948c(0xc0)])===_0x1d7a32),_0x4c87b5=plluData[_0x29948c(0xb2)](_0x19ef7d=>String(_0x19ef7d[_0x29948c(0xc0)])===_0x132081);return _0x483bad-_0x4c87b5;});_0x126d08['forEach'](_0x4c16bd=>{const _0xe3a463=_0x59a152,_0x1cb681=_0x552bb3[_0x4c16bd],_0x24cb37=secondaryPercentages[_0x4c16bd]||0x0,_0x245201=_0x1cb681[_0xe3a463(0x115)]((_0x1ea223,_0x3b18c3)=>{const _0x1cc6ef=_0xe3a463,_0x204be1=plluOriginalOrder['findIndex'](_0x32893b=>_0x32893b['PL_BLOCK']===_0x1ea223[_0x1cc6ef(0x101)]),_0x2d5a97=plluOriginalOrder['findIndex'](_0x404535=>_0x404535[_0x1cc6ef(0x101)]===_0x3b18c3['PL_BLOCK']);return _0x204be1-_0x2d5a97;});let _0x51eb28=0x0;const _0x8c977a={};let _0x18a950=0x0;const _0x106598=[];_0x245201[_0xe3a463(0xbf)](_0xf76506=>{const _0x2f1f74=_0xe3a463;_0x51eb28=_0x51eb28+_0xf76506[_0x2f1f74(0xe1)];let _0x1a62ab=0x0,_0x3de393={},_0x57ac69={};_0xa0e796[_0x2f1f74(0xbf)](_0x5d4593=>{const _0x1ec46a=_0x2f1f74;_0x3de393[_0x5d4593]=0x0,_0x57ac69[_0x5d4593]=0x0;for(let _0x268483=0x1;_0x268483<=0x5;_0x268483++){const _0x2a1a56=_0x5d4593+'_'+_0x268483;_0xf76506[_0x2a1a56]&&(_0x3de393[_0x5d4593]+=_0xf76506[_0x2a1a56][_0x1ec46a(0xd2)],_0x57ac69[_0x5d4593]=_0x57ac69[_0x5d4593]+_0xf76506[_0x2a1a56][_0x1ec46a(0x119)],_0x1a62ab=_0x1a62ab+_0xf76506[_0x2a1a56][_0x1ec46a(0x119)],!_0x8c977a[_0x5d4593]&&(_0x8c977a[_0x5d4593]={'buildingCount':0x0,'landUseArea':0x0}),_0x8c977a[_0x5d4593][_0x1ec46a(0xd2)]+=_0xf76506[_0x2a1a56][_0x1ec46a(0xd2)],_0x8c977a[_0x5d4593]['landUseArea']=_0x8c977a[_0x5d4593][_0x1ec46a(0x119)]+_0xf76506[_0x2a1a56][_0x1ec46a(0x119)],_0x18a950=_0x18a950+_0xf76506[_0x2a1a56][_0x1ec46a(0x119)]);}});const _0x46496e=roundToTwoDecimals(_0x1a62ab/_0xf76506[_0x2f1f74(0xe1)]*0x64);_0x106598[_0x2f1f74(0xf5)]({'block':_0xf76506['PL_BLOCK'],'area':_0xf76506[_0x2f1f74(0xe1)],'reBLUseCounts':_0x3de393,'reBLUseAreas':_0x57ac69,'totalLandUseArea':_0x1a62ab,'landUsePercentage':_0x46496e,'exceedsLimit':_0x24cb37>0x0&&_0x46496e>_0x24cb37});}),_0x106598[_0xe3a463(0xbf)]((_0xf2170b,_0x183e07)=>{const _0x22d60b=_0xe3a463;_0x7e24a5+=_0x22d60b(0x112)+(_0xf2170b[_0x22d60b(0x137)]?_0x22d60b(0xd5):'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xf2170b[_0x22d60b(0x138)]+_0x22d60b(0x103)+(_0x183e07===0x0?_0x4c16bd:'')+_0x22d60b(0x103)+formatNumberTwoDecimal(_0xf2170b['area'])+_0x22d60b(0x151),_0xa0e796[_0x22d60b(0xbf)](_0xa54d8d=>{const _0x35940d=_0x22d60b;_0x7e24a5+=_0x35940d(0xd9)+formatBuildingCount(_0xf2170b[_0x35940d(0xfa)][_0xa54d8d])+_0x35940d(0x131)+formatNumberTwoDecimal(_0xf2170b[_0x35940d(0xb8)][_0xa54d8d])+'</td>';}),_0x7e24a5+=_0x22d60b(0xd9)+formatNumberTwoDecimal(_0xf2170b['totalLandUseArea'])+_0x22d60b(0x103)+formatNumber(_0xf2170b[_0x22d60b(0xe7)])+_0x22d60b(0xfd)+formatNumber(_0x24cb37)+_0x22d60b(0x134);});const _0x356329=roundToTwoDecimals(_0x18a950/_0x51eb28*0x64),_0x37a7e4=_0x24cb37>0x0&&_0x356329>_0x24cb37;_0x7e24a5+=_0xe3a463(0xdf)+(_0x37a7e4?_0xe3a463(0xd5):'')+_0xe3a463(0xf4)+_0x4c16bd+_0xe3a463(0x129)+formatNumberTwoDecimal(_0x51eb28)+'</td>',_0xa0e796[_0xe3a463(0xbf)](_0x284b57=>{const _0x1bafd9=_0xe3a463,_0x5a38ab=_0x8c977a[_0x284b57]||{'buildingCount':0x0,'landUseArea':0x0};_0x7e24a5+=_0x1bafd9(0xd9)+formatBuildingCount(_0x5a38ab[_0x1bafd9(0xd2)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x5a38ab['landUseArea'])+_0x1bafd9(0x151);}),_0x7e24a5+='<td>'+formatNumberTwoDecimal(_0x18a950)+_0xe3a463(0x120)+formatNumber(_0x356329)+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x24cb37)+_0xe3a463(0x176);});let _0x311af2=0x0;const _0x2e2b62={};let _0x13d99e=0x0;Object[_0x59a152(0x159)](_0x552bb3)[_0x59a152(0xbf)](([_0x3ac346,_0x4abb4c])=>{_0x4abb4c['forEach'](_0x53cd86=>{const _0x2e2572=_0x5424;_0x311af2=_0x311af2+_0x53cd86[_0x2e2572(0xe1)],_0xa0e796[_0x2e2572(0xbf)](_0x5a29a2=>{const _0x14776b=_0x2e2572;!_0x2e2b62[_0x5a29a2]&&(_0x2e2b62[_0x5a29a2]={'buildingCount':0x0,'landUseArea':0x0});for(let _0x39493a=0x1;_0x39493a<=0x5;_0x39493a++){const _0x2ff779=_0x5a29a2+'_'+_0x39493a;_0x53cd86[_0x2ff779]&&(_0x2e2b62[_0x5a29a2]['buildingCount']+=_0x53cd86[_0x2ff779][_0x14776b(0xd2)],_0x2e2b62[_0x5a29a2]['landUseArea']=_0x2e2b62[_0x5a29a2][_0x14776b(0x119)]+_0x53cd86[_0x2ff779]['landUseArea'],_0x13d99e=_0x13d99e+_0x53cd86[_0x2ff779][_0x14776b(0x119)]);}});});});const _0x4ffd6e=roundToTwoDecimals(_0x13d99e/_0x311af2*0x64);_0x7e24a5+='<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวมทั้งหมด</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x311af2)+'</td>',_0xa0e796[_0x59a152(0xbf)](_0x33f403=>{const _0x50995a=_0x59a152,_0x520509=_0x2e2b62[_0x33f403]||{'buildingCount':0x0,'landUseArea':0x0};_0x7e24a5+=_0x50995a(0xd9)+formatBuildingCount(_0x520509['buildingCount'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x520509['landUseArea'])+_0x50995a(0x151);}),_0x7e24a5+=_0x59a152(0xd9)+formatNumberTwoDecimal(_0x13d99e)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x4ffd6e)+_0x59a152(0x11b);}_0x7e24a5+=_0x59a152(0x14d),_0x566c5b[_0x59a152(0x17b)]=_0x7e24a5;}function calculateLandUseArea(_0x76fa8b,_0x27c5cc,_0x31cc1d){const _0x16db60=_0x56708b,_0x4c1edd=_0x76fa8b[_0x16db60(0x13c)]((_0x5b9b62,_0x13ac4c)=>{let _0x1a345f;const _0x2a62a6=parseFloat(_0x13ac4c['BL_AREA'])||0x0;if(_0x27c5cc==0xa){if(_0x31cc1d==0x1)_0x1a345f=0x32;else{if(_0x31cc1d==0x2||_0x31cc1d==0x3)_0x1a345f=0x3c;else{if(_0x31cc1d==0x4)_0x1a345f=0x28;else{if(_0x31cc1d==0x5)_0x1a345f=0x41;}}}}else{if(_0x27c5cc==0x14){if(_0x31cc1d==0x1)_0x1a345f=0x46;else{if(_0x31cc1d==0x2)_0x1a345f=0x28;else{if(_0x31cc1d==0x3)_0x1a345f=0x41;}}}else{if(_0x27c5cc==0x29){if(_0x31cc1d==0x1)_0x1a345f=0x46;else{if(_0x31cc1d==0x2)_0x1a345f=0x28;else{if(_0x31cc1d==0x3)_0x1a345f=0x41;}}}else{if(_0x27c5cc==0x1e){if(_0x31cc1d==0x1)_0x1a345f=0x46;else{if(_0x31cc1d==0x2||_0x31cc1d==0x4)_0x1a345f=0x2d;else{if(_0x31cc1d==0x3)_0x1a345f=0x32;}}}else{if(_0x27c5cc==0x21){if(_0x31cc1d==0x1)_0x1a345f=0x14;else{if(_0x31cc1d==0x2)_0x1a345f=0x28;else{if(_0x31cc1d==0x3)_0x1a345f=0x32;}}}else{if(_0x27c5cc==0x50&&_0x31cc1d==0x1)_0x1a345f=0x14;else _0x27c5cc==0x5a&&_0x31cc1d==0x1&&(_0x1a345f=0x46);}}}}}return _0x5b9b62+_0x2a62a6*0x64/(_0x1a345f||0x1);},0x0);return _0x4c1edd;}function formatNumber(_0x47fc4f){const _0x18ec82=_0x56708b,_0x805856=roundToTwoDecimals(parseFloat(_0x47fc4f));return _0x805856[_0x18ec82(0xfc)](_0x18ec82(0xee),{'minimumFractionDigits':0x2,'maximumFractionDigits':0x2});}function formatNumberTwoDecimal(_0x3f9c1c){const _0x46f79f=_0x56708b,_0x568727=parseFloat(_0x3f9c1c)[_0x46f79f(0xcd)](0x2);return parseFloat(_0x568727)[_0x46f79f(0xfc)](_0x46f79f(0xee),{'minimumFractionDigits':0x2,'maximumFractionDigits':0x2});}function formatNumberForExcel(_0x3ee28c){return parseFloat(_0x3ee28c);}function formatBuildingCount(_0x12b208){const _0x49f696=_0x56708b;return parseInt(_0x12b208)[_0x49f696(0xfc)](_0x49f696(0xee));}function exportToExcel(){const _0x35d3f8=_0x56708b,_0x4e3f66=document['querySelector'](_0x35d3f8(0x144));if(_0x4e3f66){const _0x150a66=_0x4e3f66[_0x35d3f8(0x10f)](!![]),_0x3e1b9f=_0x150a66[_0x35d3f8(0xb4)]('tr');_0x3e1b9f[_0x35d3f8(0xbf)]((_0x4abe08,_0x4ad722)=>{const _0x45490d=_0x35d3f8,_0x105b82=_0x4abe08[_0x45490d(0xb4)](_0x45490d(0xb0));_0x105b82[_0x45490d(0xbf)]((_0x1c2a6f,_0x211048)=>{const _0x188c59=_0x45490d;if(_0x4ad722>0x1){const _0xdcb04b=_0x1c2a6f[_0x188c59(0x10c)][_0x188c59(0x12d)](),_0x36dcb2=parseFloat(_0xdcb04b['replace'](/,/g,''));!isNaN(_0x36dcb2)&&((_0x211048===0x2||_0xdcb04b[_0x188c59(0x14f)]('.')&&!_0xdcb04b['includes']('%'))&&(_0x1c2a6f[_0x188c59(0x10c)]=_0x36dcb2));}});});const _0x68955e=XLSX[_0x35d3f8(0x102)][_0x35d3f8(0xba)](_0x150a66,{'sheet':_0x35d3f8(0x139)});XLSX[_0x35d3f8(0x133)](_0x68955e,'land_use_calculation.xlsx');}else alert(_0x35d3f8(0x13f));}function exportMainActivitiesTableToExcel(){const _0x5a4744=_0x56708b,_0x4944eb=document[_0x5a4744(0x17a)](_0x5a4744(0x11c));if(_0x4944eb){const _0x170a49=_0x4944eb[_0x5a4744(0x10f)](!![]),_0x55d144=_0x170a49['querySelectorAll']('tr');_0x55d144[_0x5a4744(0xbf)]((_0x212505,_0x4dee2c)=>{const _0x12c726=_0x5a4744,_0x4ed68b=_0x212505[_0x12c726(0xb4)](_0x12c726(0xb0));_0x4ed68b[_0x12c726(0xbf)]((_0x317d69,_0x418ea2)=>{const _0x4e35e1=_0x12c726;if(_0x4dee2c>0x1){const _0x475fa3=_0x317d69[_0x4e35e1(0x10c)]['trim'](),_0x14e270=parseFloat(_0x475fa3[_0x4e35e1(0x132)](/,/g,''));!isNaN(_0x14e270)&&((_0x418ea2===0x2||_0x475fa3[_0x4e35e1(0x14f)]('.')&&!_0x475fa3['includes']('%'))&&(_0x317d69[_0x4e35e1(0x10c)]=_0x14e270));}});});const _0xc54f92=XLSX['utils'][_0x5a4744(0xba)](_0x170a49,{'sheet':_0x5a4744(0x12a)});XLSX[_0x5a4744(0x133)](_0xc54f92,_0x5a4744(0xd6));}else alert(_0x5a4744(0xc1));}function exportSecondaryActivitiesTableToExcel(){const _0x517117=_0x56708b,_0x1a0e6f=document['querySelector'](_0x517117(0x172));if(_0x1a0e6f){const _0xebdc2d=_0x1a0e6f[_0x517117(0x10f)](!![]),_0x236216=_0xebdc2d['querySelectorAll']('tr');_0x236216[_0x517117(0xbf)]((_0x16d2b,_0x5da892)=>{const _0xcefec1=_0x517117,_0x52c5c5=_0x16d2b['querySelectorAll'](_0xcefec1(0xb0));_0x52c5c5[_0xcefec1(0xbf)]((_0x3cab63,_0x3d511a)=>{const _0x32e398=_0xcefec1;if(_0x5da892>0x1){const _0xd100c9=_0x3cab63[_0x32e398(0x10c)][_0x32e398(0x12d)](),_0x28b0df=parseFloat(_0xd100c9['replace'](/,/g,''));!isNaN(_0x28b0df)&&((_0x3d511a===0x2||_0xd100c9['includes']('.')&&!_0xd100c9[_0x32e398(0x14f)]('%'))&&(_0x3cab63['textContent']=_0x28b0df));}});});const _0x4d4b63=XLSX[_0x517117(0x102)][_0x517117(0xba)](_0xebdc2d,{'sheet':_0x517117(0xf9)});XLSX[_0x517117(0x133)](_0x4d4b63,'secondary_activities_calculation.xlsx');}else alert(_0x517117(0x150));}
</script>
</body>
</html>