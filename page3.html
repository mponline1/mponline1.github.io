<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculate Landuse</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background-color: rgb(249, 250, 251);
        }
        
        /* ส่วนของตารางที่ปรับปรุงใหม่ */
        .table-wrapper {
            position: relative;
            overflow: hidden;
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        
        .table-scroll {
            overflow: auto;
            max-height: 600px;
            position: relative;
        }
        
        table { 
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            min-width: 1400px;
            position: relative;
        }
        
        th, td { 
            border: 1px solid #ddd; 
            padding: 8px 12px; 
            text-align: center;
            white-space: nowrap;
            background-color: white;
            min-width: 100px;
        }
        
        /* จัดคอลัมน์แรกให้ชิดซ้าย */
        td:first-child, td:nth-child(2), td:nth-child(3),
        th:first-child, th:nth-child(2), th:nth-child(3) {
            text-align: left;
        }
        
        /* หัวตารางหลัก */
        thead {
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        thead tr:first-child th {
            background-color: #1e40af;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 102;
        }
        
        /* หัวตารางแถวที่ 2 */
        thead tr:nth-child(2) th {
            background-color: #3b82f6;
            color: white;
            position: sticky;
            top: 41px; /* ความสูงของแถวแรก */
            z-index: 101;
        }
        
        /* ปรับการ freeze คอลัมน์ */
        td:first-child,
        th:first-child {
            position: sticky;
            left: 0;
            z-index: 50;
            background-color: white;
            min-width: 120px;
        }
        
        td:nth-child(2),
        th:nth-child(2) {
            position: sticky;
            left: 120px; /* ความกว้างคอลัมน์แรก */
            z-index: 50;
            background-color: white;
            min-width: 120px;
        }
        
        td:nth-child(3),
        th:nth-child(3) {
            position: sticky;
            left: 240px; /* ความกว้างคอลัมน์แรก + คอลัมน์ที่สอง */
            z-index: 50;
            background-color: white;
            min-width: 100px;
        }
        
        /* หัวตารางที่ freeze ทั้งแนวตั้งและแนวนอน */
        thead tr:first-child th:first-child,
        thead tr:first-child th:nth-child(2),
        thead tr:first-child th:nth-child(3) {
            z-index: 103;
        }
        
        thead tr:nth-child(2) th:first-child,
        thead tr:nth-child(2) th:nth-child(2),
        thead tr:nth-child(2) th:nth-child(3) {
            z-index: 103;
        }
        
        /* แถวคู่ */
        tbody tr:nth-child(even) td { 
            background-color: #f9fafb; 
        }
        
        /* แถวคู่ที่ freeze */
        tbody tr:nth-child(even) td:first-child,
        tbody tr:nth-child(even) td:nth-child(2),
        tbody tr:nth-child(even) td:nth-child(3) {
            background-color: #f9fafb;
        }
        
        /* แถวคี่ที่ freeze */
        tbody tr:nth-child(odd) td:first-child,
        tbody tr:nth-child(odd) td:nth-child(2),
        tbody tr:nth-child(odd) td:nth-child(3) {
            background-color: white;
        }
        
        /* แถวผลรวม */
        .total-row td { 
            background-color: #dbeafe !important; 
            font-weight: bold;
        }
        
        /* แถวที่เกินค่ากิจการรอง */
        .exceed-limit-row td {
            background-color: #fecaca !important;
        }
        
        /* แถวผลรวมที่เกินค่ากิจการรอง */
        .total-row.exceed-limit-row td {
            background-color: #f87171 !important;
        }
        
        /* เส้นขอบของเซลล์ */
        th, td {
            border: 1px solid #cbd5e0;
            box-shadow: inset 0 0 0 1px #cbd5e0;
        }
        
        /* ส่วนที่เหลือของสไตล์เดิม */
        .filter-container { 
            margin-bottom: 20px; 
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 0.375rem;
            background-color: #f9fafb;
        }
        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
        }
        .checkbox-group { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 10px; 
        }
        .pluse-filter-group {
            margin-top: 10px;
            padding: 8px;
            border: 1px solid #e5e7eb;
            border-radius: 0.25rem;
            background-color: #ffffff;
        }
        .pluse-filter-header {
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 5px;
        }
        .main-container {
            padding: 1rem;
            min-height: 100vh;
            width: 100%;
        }
        .content-wrapper {
            width: 100%;
        }
        .header-button {
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 500;
            transition: all 0.2s;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 120px;
            white-space: nowrap;
            cursor: pointer;
            border: none;
        }
        .header-button.primary {
            background-color: #1e40af;
            color: white;
        }
        .header-button.primary:hover {
            background-color: #1e3a8a;
        }
        .header-button.home {
            background-color: #1e40af;
            color: white;
            min-width: 40px;
            padding: 8px;
        }
        .header-button.home:hover {
            background-color: #1e3a8a;
        }
        .header-buttons-container {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-left: auto;
            padding: 4px;
        }
        
        input[type="file"] {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            border-radius: 0.375rem;
            width: 100%;
            background-color: white;
        }
        input[type="file"]:hover {
            border-color: #cbd5e0;
        }
        select {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            border-radius: 0.375rem;
            width: 100%;
            max-width: 20rem;
            background-color: white;
        }
        .action-button {
            padding: 8px 16px;
            background-color: #1e40af;
            color: white;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: background-color 0.2s;
            margin-right: 8px;
        }
        .action-button:hover {
            background-color: #1e3a8a;
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            .header-buttons-container {
                width: 100%;
                justify-content: flex-start;
                margin-left: 0;
            }
            .grid-cols-2 {
                grid-template-columns: 1fr;
            }
        }
        
        .toggle-icon {
            transition: transform 0.3s ease;
        }
        
        .collapsed .toggle-icon {
            transform: rotate(-90deg);
        }
        
        .filter-content {
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
            max-height: 1000px;
            opacity: 1;
            overflow: hidden;
        }
        
        .collapsed .filter-content {
            max-height: 0;
            opacity: 0;
        }
        
        .table-section {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin: 20px 0 10px 0;
            color: #1e40af;
        }
        
        .buttons-container {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        
        /* ส่วนที่เพิ่มเติมสำหรับระบบแท็บ */
        .tabs {
            display: flex;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 16px;
        }
        
        .tab {
            padding: 8px 16px;
            cursor: pointer;
            border: 1px solid transparent;
            border-bottom: none;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            margin-right: 4px;
            background-color: #f8fafc;
        }
        
        .tab.active {
            background-color: white;
            border-color: #e2e8f0;
            border-bottom-color: white;
            font-weight: bold;
            color: #1e40af;
            margin-bottom: -1px;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            padding: 16px;
            border: 1px solid #e2e8f0;
            border-top: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* ส่วนสำหรับหน้าต่างการกรอกร้อยละกิจการรอง */
        .secondary-percent-container {
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .secondary-percent-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .secondary-percent-title {
            font-weight: bold;
            color: #1e40af;
        }
        
        .secondary-percent-toggle {
            background-color: #f1f5f9;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .secondary-percent-toggle:hover {
            background-color: #e2e8f0;
        }
        
        .secondary-percent-content {
            max-height: 800px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .secondary-percent-content.collapsed {
            max-height: 0;
        }
        
        .secondary-percent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
        }
        
        .secondary-percent-item {
            display: flex;
            flex-direction: column;
        }
        
        .secondary-percent-label {
            font-size: 0.875rem;
            margin-bottom: 4px;
        }
        
        .secondary-percent-input {
            padding: 6px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="content-wrapper">
            <!-- Header Section -->
            <div class="header-container flex justify-between items-center mb-6">
                <div class="flex items-center gap-2">
                    <h1 class="text-2xl font-bold text-blue-700">Calculate Landuse</h1>
                    <h2 class="text-lg text-gray-600">คำนวณพื้นที่การใช้ประโยชน์ที่ดิน</h2>
                </div>
                <div class="header-buttons-container">
                    <button onclick="window.location.href='page2.html'" class="header-button primary">
                        Reclass BLDG
                    </button>
                    <button onclick="window.location.href='page5.html'" class="header-button primary">
                        PREP PLLU
                    </button>
                    <button onclick="window.location.href='index.html'" class="header-button home" aria-label="Home">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                            <polyline points="9 22 9 12 15 12 15 22"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Manual Link -->
            <div class="flex items-center gap-2 mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-700">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                </svg>
                <a href="page.html" class="text-blue-700 hover:underline">
                    คู่มือการใช้งาน
                </a>
            </div>

            <!-- Main Content Card -->
            <div class="bg-white shadow p-6 mb-6">
                <!-- File Upload Section -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">ไฟล์อาคาร (Excel):</label>
                        <input type="file" id="buildingFile" accept=".xlsx, .xls">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">ไฟล์ pllu (Excel):</label>
                        <input type="file" id="plluFile" accept=".xlsx, .xls">
                    </div>
                </div>

                <!-- Info Text -->
                <div class="mb-6 text-sm text-gray-600">
                    ไฟล์อาคารที่นำมาใช้ต้องเป็นไฟล์อาคารจากฟังก์ชัน Reclass BLDG <br>
                    กรณีต้องการเรียงรายการตามบริเวณ/ประเภทการใช้ประโยชน์ที่ดิน ให้คลิกปุ่ม PREP PLLU แล้วนำผลลัพธ์ที่ได้มาใส่ในช่อง upload ไฟล์ pllu 
                </div>

                <!-- Action Buttons -->
                <div class="buttons-container">
                    <button onclick="processFiles()" class="action-button">
                        Calculate
                    </button>
                    <button onclick="exportToExcel()" class="action-button">
                        นำออกไฟล์ผลการใช้ประโยชน์ที่ดิน (Excel)
                    </button>
                    <button onclick="exportMainActivitiesTableToExcel()" class="action-button">
                        นำออกตารางกิจกรรมที่ทำได้ (Excel)
                    </button>
                    <button onclick="exportSecondaryActivitiesTableToExcel()" class="action-button">
                        นำออกตารางกิจกรรมรอง (Excel)
                    </button>
                </div>

                <!-- Filter Section -->
                <div class="grid gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">กรองตาม PL_USE:</label>
                        <select id="pl-use-filter">
                            <option value="all">ทั้งหมด</option>
                        </select>
                    </div>
                    
                    <!-- Collapsible RE_BL_USE Filter Section -->
                    <div class="filter-container" id="re-bl-use-container">
                        <div class="filter-header" onclick="toggleFilterSection(this)">
                            <label class="block text-sm font-medium">กรองตาม RE_BL_USE:</label>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" 
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" 
                                class="toggle-icon">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="filter-content">
                            <div id="re-bl-use-filters-container">
                                <!-- RE_BL_USE filters will be dynamically inserted here for each PL_USE -->
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">กรองตาม ACQYEAR:</label>
                        <div id="acqyear-filter" class="checkbox-group"></div>
                    </div>
                </div>
            </div>

            <!-- Secondary Percent Container -->
            <div class="secondary-percent-container">
                <div class="secondary-percent-header">
                    <div class="secondary-percent-title">ร้อยละกิจการรอง</div>
                    <button class="secondary-percent-toggle" onclick="toggleSecondaryPercent()">ซ่อน/แสดง</button>
                </div>
                <div class="secondary-percent-content" id="secondaryPercentContent">
                    <div class="secondary-percent-grid" id="secondaryPercentGrid">
                        <!-- จะเพิ่มช่องกรอกร้อยละกิจการรองตาม PL_USE ที่นี่ -->
                    </div>
                </div>
            </div>

            <!-- Tabs Section -->
            <div class="tabs">
                <div class="tab active" onclick="switchTab('originalTable')">ตารางผลการใช้ประโยชน์ที่ดิน</div>
                <div class="tab" onclick="switchTab('mainActivitiesTable')">ตารางกิจกรรมที่ทำได้</div>
                <div class="tab" onclick="switchTab('secondaryActivitiesTable')">ตารางกิจกรรมรอง</div>
            </div>

            <!-- Tab Content -->
            <div id="originalTable" class="tab-content active">
                <div id="tableContainer" class="table-wrapper">
                    <div class="table-scroll"></div>
                </div>
            </div>
            
            <div id="mainActivitiesTable" class="tab-content">
                <div id="mainActivitiesTableContainer" class="table-wrapper">
                    <div class="table-scroll"></div>
                </div>
            </div>
            
            <div id="secondaryActivitiesTable" class="tab-content">
                <div id="secondaryActivitiesTableContainer" class="table-wrapper">
                    <div class="table-scroll"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
const _0x4f8d7b=_0x5e4e;function _0x5e4e(_0x6dc068,_0xd53501){const _0x2635b3=_0x2635();return _0x5e4e=function(_0x5e4e8f,_0x34c007){_0x5e4e8f=_0x5e4e8f-0x1e5;let _0x468912=_0x2635b3[_0x5e4e8f];return _0x468912;},_0x5e4e(_0x6dc068,_0xd53501);}(function(_0x47987d,_0x37789b){const _0x1c5483=_0x5e4e,_0x5a6a5c=_0x47987d();while(!![]){try{const _0x222764=parseInt(_0x1c5483(0x21d))/0x1+-parseInt(_0x1c5483(0x213))/0x2*(parseInt(_0x1c5483(0x249))/0x3)+-parseInt(_0x1c5483(0x26a))/0x4+-parseInt(_0x1c5483(0x204))/0x5*(parseInt(_0x1c5483(0x26f))/0x6)+-parseInt(_0x1c5483(0x207))/0x7*(parseInt(_0x1c5483(0x265))/0x8)+parseInt(_0x1c5483(0x1e7))/0x9+-parseInt(_0x1c5483(0x21e))/0xa*(-parseInt(_0x1c5483(0x295))/0xb);if(_0x222764===_0x37789b)break;else _0x5a6a5c['push'](_0x5a6a5c['shift']());}catch(_0x3d5f5b){_0x5a6a5c['push'](_0x5a6a5c['shift']());}}}(_0x2635,0xb195b));let buildingData,plluData,calculationResults,totals,secondaryPercentages={},plluOriginalOrder=[];const reBLUseLabelMap={'10_1':_0x4f8d7b(0x294),'10_2':'พักอาศัย\x20บ้านแถว\x20ห้องแถว\x20ตึกแถว','10_3':'พักอาศัย\x20อาคารพักอาศัยรวม','10_4':_0x4f8d7b(0x280),'10_5':_0x4f8d7b(0x20c),'20_1':_0x4f8d7b(0x22f),'20_2':_0x4f8d7b(0x27d),'20_3':_0x4f8d7b(0x252),'41_1':_0x4f8d7b(0x20e),'41_2':'พักอาศัยกึ่งพาณิชย์\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20101\x20-\x20400\x20ตร.ม.)','41_3':'พักอาศัยกึ่งพาณิชย์\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20401\x20ตร.ม.\x20ขึ้นไป)','30_1':'อุตสาหกรรม\x20(พื้นที่คลุมดินไม่เกิน\x20200\x20ตร.ม.)','30_2':_0x4f8d7b(0x29f),'30_3':_0x4f8d7b(0x28c),'30_4':_0x4f8d7b(0x28a),'33_1':'คลังสินค้า\x20(พื้นที่คลุมดินไม่เกิน\x20100\x20ตร.ม.)','33_2':_0x4f8d7b(0x23c),'33_3':_0x4f8d7b(0x1f6),'80_1':_0x4f8d7b(0x20f),'90_1':'อื่นๆ'};function switchTab(_0x2dd922){const _0x2513bb=_0x4f8d7b;document['querySelectorAll'](_0x2513bb(0x203))[_0x2513bb(0x1f5)](_0x1b8913=>{const _0x50c110=_0x2513bb;_0x1b8913[_0x50c110(0x1ea)][_0x50c110(0x20b)](_0x50c110(0x20a));}),document[_0x2513bb(0x271)](_0x2513bb(0x264))[_0x2513bb(0x1f5)](_0x1e410e=>{const _0x2dd335=_0x2513bb;_0x1e410e[_0x2dd335(0x1ea)][_0x2dd335(0x20b)]('active');}),document[_0x2513bb(0x226)](_0x2dd922)[_0x2513bb(0x1ea)][_0x2513bb(0x27f)](_0x2513bb(0x20a)),document['querySelector'](_0x2513bb(0x229)+_0x2dd922+_0x2513bb(0x258))['classList'][_0x2513bb(0x27f)](_0x2513bb(0x20a));if(_0x2dd922===_0x2513bb(0x284))calculateMainActivitiesTable();else _0x2dd922===_0x2513bb(0x269)&&calculateSecondaryActivitiesTable();}function toggleFilterSection(_0x35992d){const _0x2ceeb2=_0x4f8d7b,_0x4986ad=_0x35992d[_0x2ceeb2(0x235)]('.filter-container');_0x4986ad[_0x2ceeb2(0x1ea)]['toggle'](_0x2ceeb2(0x298));}function toggleSecondaryPercent(){const _0x5f527d=_0x4f8d7b,_0x3e6f12=document[_0x5f527d(0x226)](_0x5f527d(0x227));_0x3e6f12[_0x5f527d(0x1ea)]['toggle']('collapsed');}function roundToTwoDecimals(_0x53b007){const _0xd45804=_0x4f8d7b;return Math[_0xd45804(0x260)]((_0x53b007+Number['EPSILON'])*0x64)/0x64;}function processFiles(){const _0x28b7a7=_0x4f8d7b,_0x2ee9d2=document[_0x28b7a7(0x226)](_0x28b7a7(0x262))[_0x28b7a7(0x1ec)][0x0],_0x463936=document[_0x28b7a7(0x226)](_0x28b7a7(0x259))[_0x28b7a7(0x1ec)][0x0];if(!_0x2ee9d2||!_0x463936){alert('กรุณาเลือกไฟล์ทั้งสองไฟล์');return;}const _0x35eb1a=new FileReader();_0x35eb1a[_0x28b7a7(0x299)]=function(_0x3637c3){const _0x2ebf1f=_0x28b7a7,_0x4d96e0=new Uint8Array(_0x3637c3['target'][_0x2ebf1f(0x1ff)]),_0x587997=XLSX['read'](_0x4d96e0,{'type':'array'});buildingData=XLSX[_0x2ebf1f(0x200)][_0x2ebf1f(0x216)](_0x587997[_0x2ebf1f(0x1f4)][_0x587997[_0x2ebf1f(0x261)][0x0]]),buildingData=buildingData[_0x2ebf1f(0x286)](_0x172e90=>({..._0x172e90,'BL_TYPE':String(_0x172e90[_0x2ebf1f(0x293)]||''),'BL_USE':String(_0x172e90['BL_USE']||''),'ACQYEAR':String(_0x172e90['ACQYEAR']||''),'PL_BLOCK':String(_0x172e90[_0x2ebf1f(0x25e)]||''),'RE_BL_USE':parseFloat(_0x172e90[_0x2ebf1f(0x24f)])||0x0,'RE_BL_AREA':parseFloat(_0x172e90[_0x2ebf1f(0x211)])||0x0,'BL_AREA':parseFloat(_0x172e90[_0x2ebf1f(0x1f9)])||0x0}));const _0x2a2564=new FileReader();_0x2a2564[_0x2ebf1f(0x299)]=function(_0x3f0575){const _0xb4ba2c=_0x2ebf1f,_0x2408d0=new Uint8Array(_0x3f0575[_0xb4ba2c(0x29c)][_0xb4ba2c(0x1ff)]),_0x14077f=XLSX['read'](_0x2408d0,{'type':_0xb4ba2c(0x28e)});plluData=XLSX['utils'][_0xb4ba2c(0x216)](_0x14077f[_0xb4ba2c(0x1f4)][_0x14077f[_0xb4ba2c(0x261)][0x0]]),plluOriginalOrder=plluData[_0xb4ba2c(0x286)]((_0x53470d,_0x283f90)=>({'PL_BLOCK':String(_0x53470d[_0xb4ba2c(0x25e)]||''),'originalIndex':_0x283f90})),plluData=plluData['map'](_0x4113da=>({..._0x4113da,'PL_BLOCK':String(_0x4113da[_0xb4ba2c(0x25e)]||''),'PL_USE':String(_0x4113da[_0xb4ba2c(0x248)]||''),'AREA':parseFloat(_0x4113da['AREA'])||0x0})),setupFilters(),setupSecondaryPercentInputs(),calculateAndDisplayTable(),calculateMainActivitiesTable(),calculateSecondaryActivitiesTable();},_0x2a2564['readAsArrayBuffer'](_0x463936);},_0x35eb1a[_0x28b7a7(0x288)](_0x2ee9d2);}function setupFilters(){const _0x6c297b=_0x4f8d7b,_0x1fdc4e=document[_0x6c297b(0x226)](_0x6c297b(0x206)),_0x2e944d=document[_0x6c297b(0x226)](_0x6c297b(0x273)),_0x3f1196=document['getElementById']('acqyear-filter');_0x1fdc4e[_0x6c297b(0x22e)]='<option\x20value=\x22all\x22>ทั้งหมด</option>',_0x2e944d['innerHTML']='',_0x3f1196['innerHTML']='';const _0x1b508e=[...new Set(plluData['map'](_0x1b9661=>String(_0x1b9661[_0x6c297b(0x248)])))][_0x6c297b(0x277)]();_0x1b508e['forEach'](_0x1bc03d=>{const _0x3e6a8e=_0x6c297b,_0x59cdf1=document[_0x3e6a8e(0x22b)]('option');_0x59cdf1[_0x3e6a8e(0x285)]=_0x1bc03d,_0x59cdf1[_0x3e6a8e(0x228)]=_0x1bc03d,_0x1fdc4e[_0x3e6a8e(0x21a)](_0x59cdf1);}),_0x1b508e[_0x6c297b(0x1f5)](_0x283aa5=>{const _0x1b1ef1=_0x6c297b,_0x579e1d=document[_0x1b1ef1(0x22b)]('div');_0x579e1d[_0x1b1ef1(0x1ea)][_0x1b1ef1(0x27f)]('pluse-filter-group'),_0x579e1d['dataset'][_0x1b1ef1(0x21b)]=_0x283aa5;const _0x1d10eb=document[_0x1b1ef1(0x22b)](_0x1b1ef1(0x253));_0x1d10eb[_0x1b1ef1(0x1ea)][_0x1b1ef1(0x27f)]('pluse-filter-header'),_0x1d10eb[_0x1b1ef1(0x228)]=_0x1b1ef1(0x230)+_0x283aa5,_0x579e1d[_0x1b1ef1(0x21a)](_0x1d10eb);const _0x118fce=document[_0x1b1ef1(0x22b)]('div');_0x118fce[_0x1b1ef1(0x1ea)][_0x1b1ef1(0x27f)](_0x1b1ef1(0x22d)),_0x579e1d['appendChild'](_0x118fce);const _0x2958f=plluData[_0x1b1ef1(0x1fd)](_0x585607=>String(_0x585607[_0x1b1ef1(0x248)])===_0x283aa5)[_0x1b1ef1(0x286)](_0x21bea6=>String(_0x21bea6[_0x1b1ef1(0x25e)])),_0x335789=buildingData[_0x1b1ef1(0x1fd)](_0x2b7fb4=>_0x2958f[_0x1b1ef1(0x275)](String(_0x2b7fb4['PL_BLOCK']))),_0x1796b5=[...new Set(_0x335789['map'](_0x1a3b92=>parseFloat(_0x1a3b92[_0x1b1ef1(0x24f)]))[_0x1b1ef1(0x1fd)](_0x3ed4ca=>!isNaN(_0x3ed4ca)&&_0x3ed4ca>=0xa))][_0x1b1ef1(0x277)]((_0x2ead42,_0x3a4c9a)=>_0x2ead42-_0x3a4c9a);_0x1796b5[_0x1b1ef1(0x1f5)](_0x2faf99=>{const _0x62bf88=_0x1b1ef1,_0x50fbf4=document[_0x62bf88(0x22b)](_0x62bf88(0x26b));_0x50fbf4[_0x62bf88(0x282)]=_0x62bf88(0x234),_0x50fbf4['id']=_0x62bf88(0x270)+_0x283aa5+'-'+_0x2faf99,_0x50fbf4['value']=_0x2faf99,_0x50fbf4[_0x62bf88(0x210)][_0x62bf88(0x21b)]=_0x283aa5,_0x50fbf4[_0x62bf88(0x241)]=!![],_0x50fbf4['addEventListener']('change',function(){calculateAndDisplayTable(),calculateMainActivitiesTable(),calculateSecondaryActivitiesTable();});const _0x128aca=document[_0x62bf88(0x22b)]('label');_0x128aca[_0x62bf88(0x214)]='re-bl-use-'+_0x283aa5+'-'+_0x2faf99;const _0x3aee09=_0x2faf99+'_1',_0x5e8eb2=reBLUseLabelMap[_0x3aee09]?_0x2faf99+'\x20('+reBLUseLabelMap[_0x3aee09][_0x62bf88(0x21c)]('\x20')[0x0]+')':''+_0x2faf99;_0x128aca['textContent']=_0x5e8eb2,_0x118fce[_0x62bf88(0x21a)](_0x50fbf4),_0x118fce[_0x62bf88(0x21a)](_0x128aca);}),_0x2e944d[_0x1b1ef1(0x21a)](_0x579e1d);}),updateVisiblePLUseFilters();const _0x670685=[...new Set(buildingData['map'](_0xb7547f=>String(_0xb7547f['ACQYEAR'])))][_0x6c297b(0x277)]();_0x670685[_0x6c297b(0x1f5)](_0x474ee0=>{const _0x3eba3a=_0x6c297b,_0xb7137f=document[_0x3eba3a(0x22b)](_0x3eba3a(0x26b));_0xb7137f[_0x3eba3a(0x282)]=_0x3eba3a(0x234),_0xb7137f['id']=_0x3eba3a(0x209)+_0x474ee0,_0xb7137f['value']=_0x474ee0,_0xb7137f[_0x3eba3a(0x241)]=!![],_0xb7137f[_0x3eba3a(0x297)](_0x3eba3a(0x29e),function(){calculateAndDisplayTable(),calculateMainActivitiesTable(),calculateSecondaryActivitiesTable();});const _0x3af43c=document[_0x3eba3a(0x22b)](_0x3eba3a(0x218));_0x3af43c[_0x3eba3a(0x214)]='acqyear-'+_0x474ee0,_0x3af43c[_0x3eba3a(0x228)]=_0x474ee0,_0x3f1196[_0x3eba3a(0x21a)](_0xb7137f),_0x3f1196[_0x3eba3a(0x21a)](_0x3af43c);}),_0x1fdc4e[_0x6c297b(0x297)]('change',function(){updateVisiblePLUseFilters(),calculateAndDisplayTable(),calculateMainActivitiesTable(),calculateSecondaryActivitiesTable();});}function setupSecondaryPercentInputs(){const _0x20a142=_0x4f8d7b,_0x429ffe=document[_0x20a142(0x226)]('secondaryPercentGrid');_0x429ffe[_0x20a142(0x22e)]='';const _0x5bbb1a=[...new Set(plluData[_0x20a142(0x286)](_0x5b1296=>String(_0x5b1296[_0x20a142(0x248)])))][_0x20a142(0x277)]((_0x1ebdb5,_0x5a00bf)=>{const _0x1b9aec=_0x20a142,_0x1b1944=plluData['findIndex'](_0x8b83e=>String(_0x8b83e[_0x1b9aec(0x248)])===_0x1ebdb5),_0x2d94e6=plluData[_0x1b9aec(0x25d)](_0x38f4b8=>String(_0x38f4b8[_0x1b9aec(0x248)])===_0x5a00bf);return _0x1b1944-_0x2d94e6;});_0x5bbb1a[_0x20a142(0x1f5)](_0x472e9e=>{const _0xc190a7=_0x20a142,_0x1e35c7=document[_0xc190a7(0x22b)](_0xc190a7(0x253));_0x1e35c7['classList'][_0xc190a7(0x27f)](_0xc190a7(0x237));const _0x59afaf=document[_0xc190a7(0x22b)](_0xc190a7(0x218));_0x59afaf[_0xc190a7(0x1ea)][_0xc190a7(0x27f)]('secondary-percent-label'),_0x59afaf[_0xc190a7(0x214)]='secondary-percent-'+_0x472e9e,_0x59afaf[_0xc190a7(0x228)]=_0x472e9e+_0xc190a7(0x255);const _0x2d23f6=document['createElement'](_0xc190a7(0x26b));_0x2d23f6['type']=_0xc190a7(0x1f2),_0x2d23f6[_0xc190a7(0x289)]='0',_0x2d23f6[_0xc190a7(0x268)]=_0xc190a7(0x225),_0x2d23f6['step']=_0xc190a7(0x25c),_0x2d23f6['id']=_0xc190a7(0x1fa)+_0x472e9e,_0x2d23f6['classList'][_0xc190a7(0x27f)](_0xc190a7(0x217)),_0x2d23f6[_0xc190a7(0x24e)]='0.00',_0x2d23f6[_0xc190a7(0x285)]=secondaryPercentages[_0x472e9e]||'',_0x2d23f6[_0xc190a7(0x297)](_0xc190a7(0x29e),function(){const _0x2f1521=_0xc190a7;secondaryPercentages[_0x472e9e]=roundToTwoDecimals(parseFloat(this[_0x2f1521(0x285)])||0x0),this['value']=secondaryPercentages[_0x472e9e],calculateSecondaryActivitiesTable();}),_0x1e35c7[_0xc190a7(0x21a)](_0x59afaf),_0x1e35c7['appendChild'](_0x2d23f6),_0x429ffe[_0xc190a7(0x21a)](_0x1e35c7);});}function updateVisiblePLUseFilters(){const _0xd63c2b=_0x4f8d7b,_0x533e33=document[_0xd63c2b(0x226)](_0xd63c2b(0x206))[_0xd63c2b(0x285)],_0xb821dd=document[_0xd63c2b(0x271)]('.pluse-filter-group');_0xb821dd['forEach'](_0x5de976=>{const _0x15a692=_0xd63c2b;_0x533e33===_0x15a692(0x278)||_0x5de976['dataset'][_0x15a692(0x21b)]===_0x533e33?_0x5de976[_0x15a692(0x22c)]['display']='block':_0x5de976['style']['display']=_0x15a692(0x23f);});}function calculateAndDisplayTable(){const _0x506460=_0x4f8d7b,_0x1b3a16=document[_0x506460(0x226)](_0x506460(0x206))[_0x506460(0x285)],_0x286048=Array[_0x506460(0x27b)](document['querySelectorAll'](_0x506460(0x201)))[_0x506460(0x286)](_0x591415=>String(_0x591415[_0x506460(0x285)])),_0xd09da5={};if(_0x1b3a16==='all'){const _0x3925f0=[...new Set(plluData['map'](_0x39ed28=>String(_0x39ed28[_0x506460(0x248)])))][_0x506460(0x277)]();_0x3925f0[_0x506460(0x1f5)](_0x48e6e0=>{const _0x4f8457=_0x506460,_0x36072c=document['querySelectorAll'](_0x4f8457(0x240)+_0x48e6e0+'\x22]:checked');_0xd09da5[_0x48e6e0]=Array[_0x4f8457(0x27b)](_0x36072c)['map'](_0xfbc522=>String(_0xfbc522[_0x4f8457(0x285)]));});}else{const _0x12dfa7=document['querySelectorAll'](_0x506460(0x240)+_0x1b3a16+_0x506460(0x236));_0xd09da5[_0x1b3a16]=Array[_0x506460(0x27b)](_0x12dfa7)[_0x506460(0x286)](_0x5838e6=>String(_0x5838e6[_0x506460(0x285)]));}const _0x378537=_0x1b3a16===_0x506460(0x278)?plluData:plluData['filter'](_0x83e8e8=>String(_0x83e8e8[_0x506460(0x248)])===_0x1b3a16),_0x58c5c9=Object[_0x506460(0x1f0)](_0xd09da5)[_0x506460(0x26e)]()['filter']((_0x3c224b,_0x45577a,_0x40d8a3)=>_0x40d8a3[_0x506460(0x290)](_0x3c224b)===_0x45577a),_0x2b60c2=buildingData[_0x506460(0x1fd)](_0x448709=>{const _0x1f9abb=_0x506460;if(!_0x286048[_0x1f9abb(0x275)](String(_0x448709[_0x1f9abb(0x274)])))return![];const _0x16605c=String(_0x448709[_0x1f9abb(0x24f)]),_0xceff8d=String(_0x448709[_0x1f9abb(0x25e)]),_0x3e7380=plluData[_0x1f9abb(0x25b)](_0x2f1e2c=>String(_0x2f1e2c[_0x1f9abb(0x25e)])===_0xceff8d)?.[_0x1f9abb(0x248)];if(!_0x3e7380||parseFloat(_0x448709[_0x1f9abb(0x24f)])<0xa)return![];if(_0x1b3a16!==_0x1f9abb(0x278)&&_0x3e7380!==_0x1b3a16)return![];return _0xd09da5[_0x3e7380]?.[_0x1f9abb(0x275)](_0x16605c);}),_0x4d1dd1=_0x58c5c9[_0x506460(0x1ef)](_0x1e1a6=>[0x1,0x2,0x3,0x4,0x5][_0x506460(0x286)](_0x30cc80=>_0x1e1a6+'_'+_0x30cc80))[_0x506460(0x277)](),_0x12a53d=_0x378537['map'](_0x5c52ab=>{const _0x3c55df=_0x506460,_0x4bcfaa=String(_0x5c52ab[_0x3c55df(0x25e)]),_0xb45620=String(_0x5c52ab[_0x3c55df(0x248)]),_0x49a05e=_0x2b60c2[_0x3c55df(0x1fd)](_0x1bf63e=>String(_0x1bf63e[_0x3c55df(0x25e)])===_0x4bcfaa),_0x4704f2={};return _0x4d1dd1[_0x3c55df(0x1f5)](_0x86be8=>{const _0x4ebaa0=_0x3c55df,[_0x59beea,_0x16f500]=_0x86be8[_0x4ebaa0(0x21c)]('_')[_0x4ebaa0(0x286)](Number);if(_0xd09da5[_0xb45620]?.[_0x4ebaa0(0x275)](String(_0x59beea))){const _0x40b793=_0x49a05e[_0x4ebaa0(0x1fd)](_0xf44bb3=>parseFloat(_0xf44bb3[_0x4ebaa0(0x24f)])===_0x59beea&&parseFloat(_0xf44bb3[_0x4ebaa0(0x211)])===_0x16f500);_0x40b793[_0x4ebaa0(0x27c)]>0x0&&(_0x4704f2[_0x86be8]={'buildingCount':_0x40b793[_0x4ebaa0(0x27c)],'coveredArea':_0x40b793['reduce']((_0x395b58,_0x46c448)=>_0x395b58+parseFloat(_0x46c448[_0x4ebaa0(0x1f9)]),0x0),'landUseArea':calculateLandUseArea(_0x40b793,_0x59beea,_0x16f500)});}}),{'PL_BLOCK':_0x5c52ab[_0x3c55df(0x25e)],'PL_USE':_0x5c52ab[_0x3c55df(0x248)],'AREA':parseFloat(_0x5c52ab[_0x3c55df(0x1f8)])||0x0,..._0x4704f2};});calculationResults=_0x12a53d,totals=_0x12a53d[_0x506460(0x239)]((_0x7a7f47,_0x14f913)=>{const _0x55ce38=_0x506460;return _0x7a7f47[_0x55ce38(0x1f8)]=_0x7a7f47['AREA']+_0x14f913[_0x55ce38(0x1f8)],!_0x7a7f47['byPLUse'][_0x14f913[_0x55ce38(0x248)]]&&(_0x7a7f47['byPLUse'][_0x14f913[_0x55ce38(0x248)]]={'AREA':0x0}),_0x7a7f47[_0x55ce38(0x281)][_0x14f913[_0x55ce38(0x248)]]['AREA']=_0x7a7f47[_0x55ce38(0x281)][_0x14f913[_0x55ce38(0x248)]][_0x55ce38(0x1f8)]+_0x14f913[_0x55ce38(0x1f8)],_0x4d1dd1['forEach'](_0x3f3136=>{const _0x35688c=_0x55ce38;_0x14f913[_0x3f3136]&&(!_0x7a7f47[_0x3f3136]&&(_0x7a7f47[_0x3f3136]={'buildingCount':0x0,'coveredArea':0x0,'landUseArea':0x0}),_0x7a7f47[_0x3f3136][_0x35688c(0x1fe)]+=_0x14f913[_0x3f3136][_0x35688c(0x1fe)],_0x7a7f47[_0x3f3136][_0x35688c(0x25f)]=_0x7a7f47[_0x3f3136][_0x35688c(0x25f)]+_0x14f913[_0x3f3136][_0x35688c(0x25f)],_0x7a7f47[_0x3f3136]['landUseArea']=_0x7a7f47[_0x3f3136][_0x35688c(0x202)]+_0x14f913[_0x3f3136]['landUseArea'],!_0x7a7f47[_0x35688c(0x281)][_0x14f913[_0x35688c(0x248)]][_0x3f3136]&&(_0x7a7f47[_0x35688c(0x281)][_0x14f913['PL_USE']][_0x3f3136]={'buildingCount':0x0,'coveredArea':0x0,'landUseArea':0x0}),_0x7a7f47['byPLUse'][_0x14f913[_0x35688c(0x248)]][_0x3f3136][_0x35688c(0x1fe)]+=_0x14f913[_0x3f3136][_0x35688c(0x1fe)],_0x7a7f47[_0x35688c(0x281)][_0x14f913['PL_USE']][_0x3f3136][_0x35688c(0x25f)]=_0x7a7f47[_0x35688c(0x281)][_0x14f913[_0x35688c(0x248)]][_0x3f3136][_0x35688c(0x25f)]+_0x14f913[_0x3f3136][_0x35688c(0x25f)],_0x7a7f47[_0x35688c(0x281)][_0x14f913[_0x35688c(0x248)]][_0x3f3136]['landUseArea']=_0x7a7f47['byPLUse'][_0x14f913[_0x35688c(0x248)]][_0x3f3136][_0x35688c(0x202)]+_0x14f913[_0x3f3136][_0x35688c(0x202)]);}),_0x7a7f47;},{'AREA':0x0,'byPLUse':{}}),displayTableResults(_0x12a53d,totals,_0x4d1dd1,_0x1b3a16);}function displayTableResults(_0x1621d5,_0x2b0f4a,_0x4a8e2d,_0x4b3cfb){const _0x306c3f=_0x4f8d7b,_0xd1e53c=document['getElementById'](_0x306c3f(0x220)),_0x534c50=_0xd1e53c[_0x306c3f(0x1f3)]('.table-scroll');let _0x828d68=_0x306c3f(0x29d);const _0x3a49ad=_0x4a8e2d[_0x306c3f(0x1fd)](_0x28207b=>_0x1621d5['some'](_0x24118a=>_0x24118a[_0x28207b]));_0x3a49ad[_0x306c3f(0x1f5)](_0x1d096f=>{const _0x4fc2e2=_0x306c3f,_0x392cf1=reBLUseLabelMap[_0x1d096f]||_0x1d096f;_0x828d68+='<th\x20colspan=\x223\x22>'+_0x392cf1+_0x4fc2e2(0x251);}),_0x828d68+=_0x306c3f(0x28d),_0x828d68+=_0x306c3f(0x245),_0x3a49ad[_0x306c3f(0x1f5)](()=>{const _0x58358c=_0x306c3f;_0x828d68+=_0x58358c(0x221);}),_0x828d68+=_0x306c3f(0x1e8);if(_0x4b3cfb!==_0x306c3f(0x278)){const _0x9cef8=_0x1621d5[_0x306c3f(0x277)]((_0x181971,_0x5828b4)=>{const _0x14d05f=_0x306c3f,_0x106709=plluOriginalOrder['findIndex'](_0x2c64e4=>_0x2c64e4[_0x14d05f(0x25e)]===_0x181971[_0x14d05f(0x25e)]),_0x55d28c=plluOriginalOrder[_0x14d05f(0x25d)](_0x407e3f=>_0x407e3f[_0x14d05f(0x25e)]===_0x5828b4[_0x14d05f(0x25e)]);return _0x106709-_0x55d28c;});_0x9cef8[_0x306c3f(0x1f5)](_0x4050d6=>{const _0x18a103=_0x306c3f;_0x828d68+='<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4050d6[_0x18a103(0x25e)]+_0x18a103(0x272)+_0x4050d6[_0x18a103(0x248)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x4050d6[_0x18a103(0x1f8)])+'</td>';let _0x25a95d=0x0,_0x19eea5=0x0,_0xb9b616=0x0;_0x3a49ad['forEach'](_0x1d6867=>{const _0x2df100=_0x18a103;_0x4050d6[_0x1d6867]?(_0x828d68+=_0x2df100(0x24d)+formatBuildingCount(_0x4050d6[_0x1d6867][_0x2df100(0x1fe)])+_0x2df100(0x20d)+formatNumberTwoDecimal(_0x4050d6[_0x1d6867][_0x2df100(0x25f)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x4050d6[_0x1d6867]['landUseArea'])+_0x2df100(0x263),_0x25a95d+=_0x4050d6[_0x1d6867][_0x2df100(0x1fe)],_0x19eea5=_0x19eea5+_0x4050d6[_0x1d6867][_0x2df100(0x25f)],_0xb9b616=_0xb9b616+_0x4050d6[_0x1d6867][_0x2df100(0x202)]):_0x828d68+=_0x2df100(0x212);});const _0x1ccc7a=roundToTwoDecimals(_0xb9b616/_0x4050d6[_0x18a103(0x1f8)]*0x64);_0x828d68+=_0x18a103(0x24d)+formatBuildingCount(_0x25a95d)+_0x18a103(0x272)+formatNumberTwoDecimal(_0x19eea5)+_0x18a103(0x272)+formatNumberTwoDecimal(_0xb9b616)+_0x18a103(0x272)+formatNumber(_0x1ccc7a)+_0x18a103(0x254);});}else{const _0x5ab194={};_0x1621d5['forEach'](_0x55ff95=>{const _0x19a5ba=_0x306c3f,_0x9b08d3=_0x55ff95['PL_USE'];!_0x5ab194[_0x9b08d3]&&(_0x5ab194[_0x9b08d3]=[]),_0x5ab194[_0x9b08d3][_0x19a5ba(0x24c)](_0x55ff95);});const _0x3055bf=Object[_0x306c3f(0x291)](_0x5ab194)[_0x306c3f(0x277)]((_0x6994fc,_0x9188df)=>{const _0x46811e=_0x306c3f,_0x1698c7=plluData[_0x46811e(0x25d)](_0x4538c0=>String(_0x4538c0['PL_USE'])===_0x6994fc),_0x5a6e75=plluData['findIndex'](_0x260b38=>String(_0x260b38[_0x46811e(0x248)])===_0x9188df);return _0x1698c7-_0x5a6e75;});_0x3055bf[_0x306c3f(0x1f5)](_0x182bc4=>{const _0x52469c=_0x306c3f,_0x59fc41=_0x5ab194[_0x182bc4],_0x2978bb=_0x59fc41[_0x52469c(0x277)]((_0x47dcfd,_0x318835)=>{const _0x4f46fa=_0x52469c,_0x2b46ed=plluOriginalOrder[_0x4f46fa(0x25d)](_0x21f31d=>_0x21f31d[_0x4f46fa(0x25e)]===_0x47dcfd['PL_BLOCK']),_0x1673e1=plluOriginalOrder[_0x4f46fa(0x25d)](_0x246cf2=>_0x246cf2[_0x4f46fa(0x25e)]===_0x318835[_0x4f46fa(0x25e)]);return _0x2b46ed-_0x1673e1;});let _0x313b41=0x0,_0x522460=0x0,_0x212c57=0x0,_0x3f84c9=0x0;_0x2978bb[_0x52469c(0x1f5)](_0x5935d8=>{const _0x2cd3a1=_0x52469c;_0x3f84c9=_0x3f84c9+_0x5935d8[_0x2cd3a1(0x1f8)],_0x3a49ad['forEach'](_0x539d0e=>{const _0x38fff6=_0x2cd3a1;_0x5935d8[_0x539d0e]&&(_0x313b41+=_0x5935d8[_0x539d0e][_0x38fff6(0x1fe)],_0x522460=_0x522460+_0x5935d8[_0x539d0e][_0x38fff6(0x25f)],_0x212c57=_0x212c57+_0x5935d8[_0x539d0e]['landUseArea']);});}),_0x2978bb[_0x52469c(0x1f5)]((_0x3c3682,_0x1e1f44)=>{const _0x35e1b=_0x52469c;_0x828d68+=_0x35e1b(0x28f)+_0x3c3682[_0x35e1b(0x25e)]+_0x35e1b(0x267)+(_0x1e1f44===0x0?_0x3c3682[_0x35e1b(0x248)]:'')+_0x35e1b(0x267)+formatNumberTwoDecimal(_0x3c3682['AREA'])+_0x35e1b(0x263);let _0x11948a=0x0,_0x29f613=0x0,_0x2c043c=0x0;_0x3a49ad['forEach'](_0x38fc35=>{const _0xaf53d9=_0x35e1b;_0x3c3682[_0x38fc35]?(_0x828d68+=_0xaf53d9(0x24d)+formatBuildingCount(_0x3c3682[_0x38fc35][_0xaf53d9(0x1fe)])+_0xaf53d9(0x29b)+formatNumberTwoDecimal(_0x3c3682[_0x38fc35]['coveredArea'])+_0xaf53d9(0x29b)+formatNumberTwoDecimal(_0x3c3682[_0x38fc35][_0xaf53d9(0x202)])+'</td>',_0x11948a+=_0x3c3682[_0x38fc35][_0xaf53d9(0x1fe)],_0x29f613=_0x29f613+_0x3c3682[_0x38fc35][_0xaf53d9(0x25f)],_0x2c043c=_0x2c043c+_0x3c3682[_0x38fc35][_0xaf53d9(0x202)]):_0x828d68+=_0xaf53d9(0x212);});const _0x2bff02=roundToTwoDecimals(_0x2c043c/_0x3c3682[_0x35e1b(0x1f8)]*0x64);_0x828d68+=_0x35e1b(0x24d)+formatBuildingCount(_0x11948a)+_0x35e1b(0x267)+formatNumberTwoDecimal(_0x29f613)+_0x35e1b(0x267)+formatNumberTwoDecimal(_0x2c043c)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x2bff02)+_0x35e1b(0x287);});const _0x49326a=roundToTwoDecimals(_0x212c57/_0x3f84c9*0x64);_0x828d68+='<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวม\x20'+_0x182bc4+_0x52469c(0x238)+formatNumberTwoDecimal(_0x3f84c9)+_0x52469c(0x263),_0x3a49ad[_0x52469c(0x1f5)](_0x3a5fa9=>{const _0xa4abef=_0x52469c,_0x30d9d0=_0x2b0f4a[_0xa4abef(0x281)][_0x182bc4]?.[_0x3a5fa9];_0x30d9d0?_0x828d68+='<td>'+formatBuildingCount(_0x30d9d0[_0xa4abef(0x1fe)])+_0xa4abef(0x20d)+formatNumberTwoDecimal(_0x30d9d0[_0xa4abef(0x25f)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x30d9d0[_0xa4abef(0x202)])+_0xa4abef(0x263):_0x828d68+='<td>0</td><td>0</td><td>0</td>';}),_0x828d68+=_0x52469c(0x24d)+formatBuildingCount(_0x313b41)+_0x52469c(0x272)+formatNumberTwoDecimal(_0x522460)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x212c57)+_0x52469c(0x272)+formatNumber(_0x49326a)+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>';});}let _0x4d05d7=0x0,_0x166da9=0x0,_0x4bb2a1=0x0;_0x3a49ad[_0x306c3f(0x1f5)](_0x128dfd=>{const _0x16bad5=_0x306c3f;_0x2b0f4a[_0x128dfd]&&(_0x4d05d7+=_0x2b0f4a[_0x128dfd]['buildingCount'],_0x166da9=_0x166da9+_0x2b0f4a[_0x128dfd][_0x16bad5(0x25f)],_0x4bb2a1=_0x4bb2a1+_0x2b0f4a[_0x128dfd][_0x16bad5(0x202)]);});const _0x16f3b7=roundToTwoDecimals(_0x4bb2a1/_0x2b0f4a['AREA']*0x64);_0x828d68+=_0x306c3f(0x247)+formatNumberTwoDecimal(_0x2b0f4a[_0x306c3f(0x1f8)])+_0x306c3f(0x263),_0x3a49ad[_0x306c3f(0x1f5)](_0x31f226=>{const _0x16aa01=_0x306c3f;_0x2b0f4a[_0x31f226]?_0x828d68+=_0x16aa01(0x24d)+formatBuildingCount(_0x2b0f4a[_0x31f226][_0x16aa01(0x1fe)])+_0x16aa01(0x272)+formatNumberTwoDecimal(_0x2b0f4a[_0x31f226][_0x16aa01(0x25f)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x2b0f4a[_0x31f226]['landUseArea'])+_0x16aa01(0x263):_0x828d68+=_0x16aa01(0x212);}),_0x828d68+='<td>'+formatBuildingCount(_0x4d05d7)+_0x306c3f(0x1ee)+formatNumberTwoDecimal(_0x166da9)+_0x306c3f(0x1ee)+formatNumberTwoDecimal(_0x4bb2a1)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x16f3b7)+_0x306c3f(0x26c),_0x828d68+='</tbody></table>',_0x534c50[_0x306c3f(0x22e)]=_0x828d68;}function calculateMainActivitiesTable(){const _0x130cd2=_0x4f8d7b;if(!calculationResults||calculationResults[_0x130cd2(0x27c)]===0x0){document[_0x130cd2(0x226)](_0x130cd2(0x24a))[_0x130cd2(0x1f3)]('.table-scroll')[_0x130cd2(0x22e)]=_0x130cd2(0x205);return;}const _0x2d058e=document['getElementById'](_0x130cd2(0x24a)),_0x21ac56=_0x2d058e[_0x130cd2(0x1f3)]('.table-scroll'),_0xac3e65=[0xa,0x14,0x29,0x1e,0x21,0x50,0x5a];let _0x3de42d=_0x130cd2(0x29d);_0xac3e65[_0x130cd2(0x1f5)](_0x1aa763=>{const _0x40b941=_0x130cd2,_0x2fac79=_0x1aa763+'_1',_0x20cfd9=reBLUseLabelMap[_0x2fac79]?reBLUseLabelMap[_0x2fac79][_0x40b941(0x21c)]('\x20')[0x0]:_0x40b941(0x279)+_0x1aa763;_0x3de42d+=_0x40b941(0x283)+_0x20cfd9+'</th>';}),_0x3de42d+=_0x130cd2(0x257),_0x3de42d+=_0x130cd2(0x245),_0xac3e65['forEach'](()=>{const _0xd77712=_0x130cd2;_0x3de42d+=_0xd77712(0x1fb);}),_0x3de42d+='<th>พื้นที่การใช้ที่ดินรวม</th><th>ร้อยละพื้นที่</th></tr></thead><tbody>';const _0x28f046=document[_0x130cd2(0x226)](_0x130cd2(0x206))[_0x130cd2(0x285)];if(_0x28f046!==_0x130cd2(0x278)){const _0x53dc3c=calculationResults[_0x130cd2(0x277)]((_0x4ab03f,_0x388512)=>{const _0x143f9d=_0x130cd2,_0xa72d94=plluOriginalOrder[_0x143f9d(0x25d)](_0x96ccb5=>_0x96ccb5[_0x143f9d(0x25e)]===_0x4ab03f['PL_BLOCK']),_0x4a9695=plluOriginalOrder[_0x143f9d(0x25d)](_0x441489=>_0x441489[_0x143f9d(0x25e)]===_0x388512[_0x143f9d(0x25e)]);return _0xa72d94-_0x4a9695;});_0x53dc3c[_0x130cd2(0x1f5)](_0x1eb6b9=>{const _0x504744=_0x130cd2;let _0x272803=0x0,_0x3f7398={},_0x5058db={};_0xac3e65[_0x504744(0x1f5)](_0x1af318=>{const _0x317a82=_0x504744;_0x3f7398[_0x1af318]=0x0,_0x5058db[_0x1af318]=0x0;for(let _0x37eddb=0x1;_0x37eddb<=0x5;_0x37eddb++){const _0x3dd381=_0x1af318+'_'+_0x37eddb;_0x1eb6b9[_0x3dd381]&&(_0x3f7398[_0x1af318]+=_0x1eb6b9[_0x3dd381][_0x317a82(0x1fe)],_0x5058db[_0x1af318]=_0x5058db[_0x1af318]+_0x1eb6b9[_0x3dd381][_0x317a82(0x202)],_0x272803=_0x272803+_0x1eb6b9[_0x3dd381]['landUseArea']);}});const _0x19ec7b=roundToTwoDecimals(_0x272803/_0x1eb6b9['AREA']*0x64);_0x3de42d+=_0x504744(0x292)+_0x1eb6b9[_0x504744(0x25e)]+_0x504744(0x272)+_0x1eb6b9['PL_USE']+_0x504744(0x272)+formatNumberTwoDecimal(_0x1eb6b9[_0x504744(0x1f8)])+_0x504744(0x263),_0xac3e65[_0x504744(0x1f5)](_0x3b834b=>{const _0x33d375=_0x504744;_0x3de42d+=_0x33d375(0x24d)+formatBuildingCount(_0x3f7398[_0x3b834b])+_0x33d375(0x267)+formatNumberTwoDecimal(_0x5058db[_0x3b834b])+_0x33d375(0x263);}),_0x3de42d+=_0x504744(0x24d)+formatNumberTwoDecimal(_0x272803)+_0x504744(0x272)+formatNumber(_0x19ec7b)+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>';});}else{const _0x9d6553={};calculationResults[_0x130cd2(0x1f5)](_0x33eeec=>{const _0x4fe885=_0x130cd2,_0x4dcd1f=_0x33eeec[_0x4fe885(0x248)];!_0x9d6553[_0x4dcd1f]&&(_0x9d6553[_0x4dcd1f]=[]),_0x9d6553[_0x4dcd1f][_0x4fe885(0x24c)](_0x33eeec);});const _0x17d0db=Object[_0x130cd2(0x291)](_0x9d6553)[_0x130cd2(0x277)]((_0x3f5e0e,_0x3a316c)=>{const _0x58a642=_0x130cd2,_0x161a79=plluData['findIndex'](_0x17ae52=>String(_0x17ae52[_0x58a642(0x248)])===_0x3f5e0e),_0x2c2269=plluData[_0x58a642(0x25d)](_0x39f454=>String(_0x39f454[_0x58a642(0x248)])===_0x3a316c);return _0x161a79-_0x2c2269;});_0x17d0db[_0x130cd2(0x1f5)](_0x5d4458=>{const _0x35afce=_0x130cd2,_0x584466=_0x9d6553[_0x5d4458],_0x42fdf2=_0x584466[_0x35afce(0x277)]((_0x548c2a,_0x26e1a9)=>{const _0x465b86=_0x35afce,_0x479c0f=plluOriginalOrder[_0x465b86(0x25d)](_0x4a3a6e=>_0x4a3a6e['PL_BLOCK']===_0x548c2a[_0x465b86(0x25e)]),_0x4dfb97=plluOriginalOrder[_0x465b86(0x25d)](_0x291b8a=>_0x291b8a[_0x465b86(0x25e)]===_0x26e1a9[_0x465b86(0x25e)]);return _0x479c0f-_0x4dfb97;});let _0x512dda=0x0;const _0x50578a={};let _0x4f229f=0x0;const _0x257410=[];_0x42fdf2[_0x35afce(0x1f5)](_0x3b1486=>{const _0x554119=_0x35afce;_0x512dda=_0x512dda+_0x3b1486[_0x554119(0x1f8)];let _0x218795=0x0,_0xc77e39={},_0x334f9e={};_0xac3e65[_0x554119(0x1f5)](_0x14fb64=>{const _0x184ec1=_0x554119;_0xc77e39[_0x14fb64]=0x0,_0x334f9e[_0x14fb64]=0x0;for(let _0x1d7d2b=0x1;_0x1d7d2b<=0x5;_0x1d7d2b++){const _0xe726f1=_0x14fb64+'_'+_0x1d7d2b;_0x3b1486[_0xe726f1]&&(_0xc77e39[_0x14fb64]+=_0x3b1486[_0xe726f1][_0x184ec1(0x1fe)],_0x334f9e[_0x14fb64]=_0x334f9e[_0x14fb64]+_0x3b1486[_0xe726f1][_0x184ec1(0x202)],_0x218795=_0x218795+_0x3b1486[_0xe726f1][_0x184ec1(0x202)],!_0x50578a[_0x14fb64]&&(_0x50578a[_0x14fb64]={'buildingCount':0x0,'landUseArea':0x0}),_0x50578a[_0x14fb64][_0x184ec1(0x1fe)]+=_0x3b1486[_0xe726f1][_0x184ec1(0x1fe)],_0x50578a[_0x14fb64][_0x184ec1(0x202)]=_0x50578a[_0x14fb64]['landUseArea']+_0x3b1486[_0xe726f1][_0x184ec1(0x202)],_0x4f229f=_0x4f229f+_0x3b1486[_0xe726f1][_0x184ec1(0x202)]);}});const _0x31ef24=roundToTwoDecimals(_0x218795/_0x3b1486[_0x554119(0x1f8)]*0x64);_0x257410[_0x554119(0x24c)]({'block':_0x3b1486[_0x554119(0x25e)],'area':_0x3b1486[_0x554119(0x1f8)],'reBLUseCounts':_0xc77e39,'reBLUseAreas':_0x334f9e,'totalLandUseArea':_0x218795,'landUsePercentage':_0x31ef24});}),_0x257410['forEach']((_0x1f5b15,_0x4f319d)=>{const _0x39ad38=_0x35afce;_0x3de42d+='<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1f5b15[_0x39ad38(0x242)]+_0x39ad38(0x267)+(_0x4f319d===0x0?_0x5d4458:'')+_0x39ad38(0x267)+formatNumberTwoDecimal(_0x1f5b15[_0x39ad38(0x250)])+_0x39ad38(0x263),_0xac3e65[_0x39ad38(0x1f5)](_0x499cbe=>{const _0x5b5f34=_0x39ad38;_0x3de42d+=_0x5b5f34(0x24d)+formatBuildingCount(_0x1f5b15[_0x5b5f34(0x215)][_0x499cbe])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x1f5b15[_0x5b5f34(0x1f7)][_0x499cbe])+_0x5b5f34(0x263);}),_0x3de42d+=_0x39ad38(0x24d)+formatNumberTwoDecimal(_0x1f5b15[_0x39ad38(0x23e)])+_0x39ad38(0x267)+formatNumber(_0x1f5b15[_0x39ad38(0x1e6)])+_0x39ad38(0x287);});const _0x47e5f5=roundToTwoDecimals(_0x4f229f/_0x512dda*0x64);_0x3de42d+=_0x35afce(0x223)+_0x5d4458+_0x35afce(0x238)+formatNumberTwoDecimal(_0x512dda)+_0x35afce(0x263),_0xac3e65[_0x35afce(0x1f5)](_0x3a765a=>{const _0x3bd5da=_0x35afce,_0x4fc31c=_0x50578a[_0x3a765a]||{'buildingCount':0x0,'landUseArea':0x0};_0x3de42d+=_0x3bd5da(0x24d)+formatBuildingCount(_0x4fc31c[_0x3bd5da(0x1fe)])+_0x3bd5da(0x267)+formatNumberTwoDecimal(_0x4fc31c[_0x3bd5da(0x202)])+_0x3bd5da(0x263);}),_0x3de42d+='<td>'+formatNumberTwoDecimal(_0x4f229f)+_0x35afce(0x272)+formatNumber(_0x47e5f5)+_0x35afce(0x254);});let _0x36cc0e=0x0;const _0x339db7={};let _0x36a2cc=0x0;Object[_0x130cd2(0x27e)](_0x9d6553)[_0x130cd2(0x1f5)](([_0x1496a6,_0xb03c00])=>{const _0x2f7e57=_0x130cd2;_0xb03c00[_0x2f7e57(0x1f5)](_0x4b2b6a=>{_0x36cc0e=_0x36cc0e+_0x4b2b6a['AREA'],_0xac3e65['forEach'](_0x3ddd2c=>{const _0x1c1cf7=_0x5e4e;!_0x339db7[_0x3ddd2c]&&(_0x339db7[_0x3ddd2c]={'buildingCount':0x0,'landUseArea':0x0});for(let _0xdce1d6=0x1;_0xdce1d6<=0x5;_0xdce1d6++){const _0x544de4=_0x3ddd2c+'_'+_0xdce1d6;_0x4b2b6a[_0x544de4]&&(_0x339db7[_0x3ddd2c][_0x1c1cf7(0x1fe)]+=_0x4b2b6a[_0x544de4][_0x1c1cf7(0x1fe)],_0x339db7[_0x3ddd2c][_0x1c1cf7(0x202)]=_0x339db7[_0x3ddd2c]['landUseArea']+_0x4b2b6a[_0x544de4][_0x1c1cf7(0x202)],_0x36a2cc=_0x36a2cc+_0x4b2b6a[_0x544de4][_0x1c1cf7(0x202)]);}});});});const _0x582ff8=roundToTwoDecimals(_0x36a2cc/_0x36cc0e*0x64);_0x3de42d+=_0x130cd2(0x233)+formatNumberTwoDecimal(_0x36cc0e)+_0x130cd2(0x263),_0xac3e65[_0x130cd2(0x1f5)](_0x8c295b=>{const _0x247955=_0x130cd2,_0x5574ff=_0x339db7[_0x8c295b]||{'buildingCount':0x0,'landUseArea':0x0};_0x3de42d+=_0x247955(0x24d)+formatBuildingCount(_0x5574ff[_0x247955(0x1fe)])+_0x247955(0x272)+formatNumberTwoDecimal(_0x5574ff[_0x247955(0x202)])+'</td>';}),_0x3de42d+=_0x130cd2(0x24d)+formatNumberTwoDecimal(_0x36a2cc)+_0x130cd2(0x1fc)+formatNumber(_0x582ff8)+_0x130cd2(0x23a);}_0x3de42d+='</tbody></table>',_0x21ac56[_0x130cd2(0x22e)]=_0x3de42d;}function _0x2635(){const _0x3838a3=['reduce','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20</tr>','Main\x20Activities','คลังสินค้า\x20(พื้นที่คลุมดิน\x20101\x20-\x20500\x20ตร.ม.)','.table-scroll','totalLandUseArea','none','input[type=\x22checkbox\x22][data-pl-use=\x22','checked','block','trim','table_to_book','<tr><th></th><th></th><th></th>','<tr\x20class=\x22','<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20<td>ผลรวมทั้งหมด</td>\x0a\x20\x20\x20\x20\x20\x20\x20<td></td>\x0a\x20\x20\x20\x20\x20\x20\x20<td>','PL_USE','3hXdrPz','mainActivitiesTableContainer','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวม\x20','push','<td>','placeholder','RE_BL_USE','area','</th>','พาณิชย์\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20401\x20ตร.ม.\x20ขึ้นไป)','div','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','\x20-\x20ร้อยละกิจการรอง:','กรุณาคำนวณและเลือกดูตารางกิจกรรมที่ทำได้ก่อนการนำออกไฟล์\x20Excel','<th\x20colspan=\x222\x22>ผลรวม</th></tr>','\x27)\x22]','plluFile','en-US','find','0.01','findIndex','PL_BLOCK','coveredArea','round','SheetNames','buildingFile','</td>','.tab','16xKupjQ','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','max','secondaryActivitiesTable','184940MpwLeQ','input','%</td>\x0a\x20\x20\x20</tr>','</tbody></table>','flat','504IAlCFs','re-bl-use-','querySelectorAll','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','re-bl-use-filters-container','ACQYEAR','includes','td,\x20th','sort','all','ประเภท\x20','replace','from','length','พาณิชย์\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20101\x20-\x20400\x20ตร.ม.)','entries','add','พักอาศัย\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20101\x20-\x20400\x20ตร.ม.)','byPLUse','type','<th\x20colspan=\x222\x22>','mainActivitiesTable','value','map','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','readAsArrayBuffer','min','อุตสาหกรรม\x20(พื้นที่คลุมดิน\x201,001\x20ตร.ม.\x20ขึ้นไป)','<tr\x20class=\x22total-row\x20','อุตสาหกรรม\x20(พื้นที่คลุมดิน\x20501\x20-\x201,000\x20ตร.ม.)','<th\x20colspan=\x222\x22>รวมพื้นที่อาคารคลุมดิน</th><th\x20colspan=\x222\x22>การใช้ประโยชน์ที่ดิน</th></tr>','array','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','indexOf','keys','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','BL_TYPE','พักอาศัย\x20บ้านเดี่ยว\x20บ้านแฝด','11pIEODT','exceed-limit-row','addEventListener','collapsed','onload','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>-</td>\x0a\x20\x20\x20\x20\x20\x20\x20</tr>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','target','<table><thead><tr><th>บริเวณการใช้ประโยชน์ที่ดิน</th><th>ประเภทการใช้ที่ดิน</th><th>พื้นที่\x20block</th>','change','อุตสาหกรรม\x20(พื้นที่คลุมดิน\x20201\x20-\x20500\x20ตร.ม.)','#secondaryActivitiesTableContainer\x20table','landUsePercentage','233595zssCyW','<th>จำนวนอาคาร</th><th>พื้นที่อาคารรวม</th><th>พื้นที่</th><th>ร้อยละพื้นที่</th></tr></thead><tbody>','cloneNode','classList','<th\x20colspan=\x223\x22>ผลรวม</th></tr>','files','#mainActivitiesTableContainer\x20table','</td>\x0a\x20\x20\x20\x20\x20\x20\x20<td>','flatMap','values','Secondary\x20Activities','number','querySelector','Sheets','forEach','คลังสินค้า\x20(พื้นที่คลุมดิน\x20501\x20ตร.ม.\x20ขึ้นไป)','reBLUseAreas','AREA','BL_AREA','secondary-percent-','<th>จำนวนอาคาร</th><th>พื้นที่การใช้ที่ดิน</th>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','filter','buildingCount','result','utils','#acqyear-filter\x20input:checked','landUseArea','.tab-content','1270sJmmFI','<p>กรุณาคำนวณข้อมูลก่อนการจัดกลุ่มการใช้ประโยชน์ที่ดิน</p>','pl-use-filter','4515917bPoPdH','secondaryActivitiesTableContainer','acqyear-','active','remove','พักอาศัย\x20อาคารขนาดใหญ่และสูง\x20(พื้นที่คลุมดิน\x20401\x20ตร.ม.\x20ขึ้นไป)','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','พักอาศัยกึ่งพาณิชย์\x20อาคารทั่วไป','เกษตรกรรม\x20(พักอาศัย\x20คอกปศุสัตว์\x20ฟาร์ม\x20ยุ้งฉาง)','dataset','RE_BL_AREA','<td>0</td><td>0</td><td>0</td>','1397188PqMnhW','htmlFor','reBLUseCounts','sheet_to_json','secondary-percent-input','label','writeFile','appendChild','plUse','split','1122670iYjAQU','16351890mFIiCz','exceedsLimit','tableContainer','<th>จำนวนอาคาร</th><th>พื้นที่อาคารคลุมดินรวม</th><th>พื้นที่การใช้ที่ดินรวม</th>','toLocaleString','<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวม\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','100','getElementById','secondaryPercentContent','textContent','.tab[onclick=\x22switchTab(\x27','Sheet\x20JS','createElement','style','checkbox-group','innerHTML','พาณิชย์\x20อาคารทั่วไป','PL_USE:\x20','กรุณาคำนวณข้อมูลก่อนการนำออกไฟล์\x20Excel','กรุณาคำนวณและเลือกดูตารางกิจกรรมรองก่อนการนำออกไฟล์\x20Excel','<tr\x20class=\x22total-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>ผลรวมทั้งหมด</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','checkbox','closest','\x22]:checked','secondary-percent-item','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'];_0x2635=function(){return _0x3838a3;};return _0x2635();}function calculateSecondaryActivitiesTable(){const _0x747722=_0x4f8d7b;if(!calculationResults||calculationResults[_0x747722(0x27c)]===0x0){document[_0x747722(0x226)]('secondaryActivitiesTableContainer')[_0x747722(0x1f3)](_0x747722(0x23d))[_0x747722(0x22e)]='<p>กรุณาคำนวณข้อมูลก่อนการจัดกลุ่มการใช้ประโยชน์ที่ดิน</p>';return;}const _0xb78f26=document[_0x747722(0x226)](_0x747722(0x208)),_0x524573=_0xb78f26['querySelector'](_0x747722(0x23d)),_0x47a2ed=[0xa,0x14,0x29,0x1e,0x21,0x50,0x5a],_0x1c57fb=document[_0x747722(0x226)]('pl-use-filter')['value'],_0x55afbe={};if(_0x1c57fb===_0x747722(0x278)){const _0x56821a=[...new Set(plluData[_0x747722(0x286)](_0x5ca2e3=>String(_0x5ca2e3[_0x747722(0x248)])))][_0x747722(0x277)]();_0x56821a['forEach'](_0x1cff80=>{const _0x3b89bc=_0x747722,_0x235335=document[_0x3b89bc(0x271)](_0x3b89bc(0x240)+_0x1cff80+_0x3b89bc(0x236)),_0x542ee5=Array[_0x3b89bc(0x27b)](_0x235335)[_0x3b89bc(0x286)](_0x344265=>String(_0x344265['value'])),_0x425075=document[_0x3b89bc(0x271)](_0x3b89bc(0x240)+_0x1cff80+'\x22]'),_0x25c3ec=Array[_0x3b89bc(0x27b)](_0x425075)[_0x3b89bc(0x286)](_0x2a6cef=>String(_0x2a6cef['value']));_0x55afbe[_0x1cff80]=_0x25c3ec[_0x3b89bc(0x1fd)](_0x304be2=>!_0x542ee5[_0x3b89bc(0x275)](_0x304be2));});}else{const _0x351bde=document['querySelectorAll'](_0x747722(0x240)+_0x1c57fb+_0x747722(0x236)),_0x3cff66=Array[_0x747722(0x27b)](_0x351bde)['map'](_0x289852=>String(_0x289852[_0x747722(0x285)])),_0x31e4d8=document[_0x747722(0x271)]('input[type=\x22checkbox\x22][data-pl-use=\x22'+_0x1c57fb+'\x22]'),_0x228a20=Array[_0x747722(0x27b)](_0x31e4d8)[_0x747722(0x286)](_0x53366d=>String(_0x53366d['value']));_0x55afbe[_0x1c57fb]=_0x228a20[_0x747722(0x1fd)](_0x3af0a6=>!_0x3cff66[_0x747722(0x275)](_0x3af0a6));}const _0x30bf79=Array[_0x747722(0x27b)](document['querySelectorAll'](_0x747722(0x201)))['map'](_0x8a9c75=>String(_0x8a9c75[_0x747722(0x285)])),_0x261b65=_0x1c57fb===_0x747722(0x278)?plluData:plluData[_0x747722(0x1fd)](_0x149f63=>String(_0x149f63[_0x747722(0x248)])===_0x1c57fb),_0x44df99=buildingData[_0x747722(0x1fd)](_0x409d6e=>{const _0x425c6d=_0x747722;if(!_0x30bf79[_0x425c6d(0x275)](String(_0x409d6e['ACQYEAR'])))return![];const _0x28c59d=String(_0x409d6e[_0x425c6d(0x24f)]),_0x5495b0=String(_0x409d6e[_0x425c6d(0x25e)]),_0x5654f2=plluData[_0x425c6d(0x25b)](_0x50bb4a=>String(_0x50bb4a[_0x425c6d(0x25e)])===_0x5495b0)?.['PL_USE'];if(!_0x5654f2||parseFloat(_0x409d6e[_0x425c6d(0x24f)])<0xa)return![];if(_0x1c57fb!==_0x425c6d(0x278)&&_0x5654f2!==_0x1c57fb)return![];return _0x55afbe[_0x5654f2]?.[_0x425c6d(0x275)](_0x28c59d);});let _0x3ca948=_0x747722(0x29d);_0x47a2ed['forEach'](_0x5d4de1=>{const _0x48cf37=_0x747722,_0x3948a8=_0x5d4de1+'_1',_0x1899d9=reBLUseLabelMap[_0x3948a8]?reBLUseLabelMap[_0x3948a8][_0x48cf37(0x21c)]('\x20')[0x0]:_0x48cf37(0x279)+_0x5d4de1;_0x3ca948+=_0x48cf37(0x283)+_0x1899d9+_0x48cf37(0x251);}),_0x3ca948+=_0x747722(0x1eb),_0x3ca948+=_0x747722(0x245),_0x47a2ed[_0x747722(0x1f5)](()=>{const _0x419172=_0x747722;_0x3ca948+=_0x419172(0x1fb);}),_0x3ca948+='<th>พื้นที่การใช้ที่ดินรวม</th><th>ร้อยละพื้นที่</th><th>ร้อยละกิจการรอง</th></tr></thead><tbody>';const _0x16d83d=_0x261b65['map'](_0x365de5=>{const _0x3908a1=_0x747722,_0x3f400d=String(_0x365de5[_0x3908a1(0x25e)]),_0x1a8233=String(_0x365de5[_0x3908a1(0x248)]),_0x28f44d=_0x44df99[_0x3908a1(0x1fd)](_0x4786c9=>String(_0x4786c9[_0x3908a1(0x25e)])===_0x3f400d),_0x1b6bac={},_0x31ece9=_0x55afbe[_0x1a8233]||[],_0x54de99=_0x31ece9['flatMap'](_0x477ffb=>[0x1,0x2,0x3,0x4,0x5][_0x3908a1(0x286)](_0x19501a=>_0x477ffb+'_'+_0x19501a))[_0x3908a1(0x277)]();return _0x54de99[_0x3908a1(0x1f5)](_0x55bab7=>{const _0x13b25f=_0x3908a1,[_0x1eea21,_0x36056f]=_0x55bab7['split']('_')['map'](Number),_0x44a4fb=_0x28f44d['filter'](_0x2f9ecf=>parseFloat(_0x2f9ecf[_0x13b25f(0x24f)])===_0x1eea21&&parseFloat(_0x2f9ecf[_0x13b25f(0x211)])===_0x36056f);_0x44a4fb[_0x13b25f(0x27c)]>0x0&&(_0x1b6bac[_0x55bab7]={'buildingCount':_0x44a4fb['length'],'coveredArea':_0x44a4fb[_0x13b25f(0x239)]((_0xf06a42,_0x3bd259)=>_0xf06a42+parseFloat(_0x3bd259[_0x13b25f(0x1f9)]),0x0),'landUseArea':calculateLandUseArea(_0x44a4fb,_0x1eea21,_0x36056f)});}),{'PL_BLOCK':_0x365de5[_0x3908a1(0x25e)],'PL_USE':_0x365de5[_0x3908a1(0x248)],'AREA':parseFloat(_0x365de5[_0x3908a1(0x1f8)])||0x0,..._0x1b6bac};});if(_0x1c57fb!=='all'){const _0x2a7527=_0x16d83d[_0x747722(0x277)]((_0x2835b8,_0x5d9458)=>{const _0x39807f=_0x747722,_0x1c81be=plluOriginalOrder['findIndex'](_0x31ea8f=>_0x31ea8f['PL_BLOCK']===_0x2835b8['PL_BLOCK']),_0x6bbcb8=plluOriginalOrder[_0x39807f(0x25d)](_0x53ba9b=>_0x53ba9b[_0x39807f(0x25e)]===_0x5d9458[_0x39807f(0x25e)]);return _0x1c81be-_0x6bbcb8;});_0x2a7527[_0x747722(0x1f5)](_0x30d735=>{const _0x4feaa7=_0x747722,_0x3220d5=_0x30d735[_0x4feaa7(0x248)],_0x1496eb=secondaryPercentages[_0x3220d5]||0x0;let _0x229440=0x0,_0xe2c992={},_0x210353={};_0x47a2ed[_0x4feaa7(0x1f5)](_0x4601a4=>{const _0x52c34d=_0x4feaa7;_0xe2c992[_0x4601a4]=0x0,_0x210353[_0x4601a4]=0x0;for(let _0x2e9650=0x1;_0x2e9650<=0x5;_0x2e9650++){const _0x5223eb=_0x4601a4+'_'+_0x2e9650;_0x30d735[_0x5223eb]&&(_0xe2c992[_0x4601a4]+=_0x30d735[_0x5223eb][_0x52c34d(0x1fe)],_0x210353[_0x4601a4]=_0x210353[_0x4601a4]+_0x30d735[_0x5223eb][_0x52c34d(0x202)],_0x229440=_0x229440+_0x30d735[_0x5223eb][_0x52c34d(0x202)]);}});const _0x4e481b=roundToTwoDecimals(_0x229440/_0x30d735['AREA']*0x64),_0x58f7a8=_0x1496eb>0x0&&_0x4e481b>_0x1496eb;_0x3ca948+=_0x4feaa7(0x246)+(_0x58f7a8?_0x4feaa7(0x296):'')+_0x4feaa7(0x224)+_0x30d735[_0x4feaa7(0x25e)]+_0x4feaa7(0x272)+_0x30d735['PL_USE']+_0x4feaa7(0x272)+formatNumberTwoDecimal(_0x30d735[_0x4feaa7(0x1f8)])+_0x4feaa7(0x263),_0x47a2ed[_0x4feaa7(0x1f5)](_0x4ef567=>{_0x3ca948+='<td>'+formatBuildingCount(_0xe2c992[_0x4ef567])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumberTwoDecimal(_0x210353[_0x4ef567])+'</td>';}),_0x3ca948+=_0x4feaa7(0x24d)+formatNumberTwoDecimal(_0x229440)+_0x4feaa7(0x272)+formatNumber(_0x4e481b)+_0x4feaa7(0x266)+formatNumber(_0x1496eb)+_0x4feaa7(0x254);});}else{const _0x361a8b={};_0x16d83d[_0x747722(0x1f5)](_0x50199d=>{const _0x3361d2=_0x747722,_0x108ea1=_0x50199d[_0x3361d2(0x248)];!_0x361a8b[_0x108ea1]&&(_0x361a8b[_0x108ea1]=[]),_0x361a8b[_0x108ea1][_0x3361d2(0x24c)](_0x50199d);});const _0x42754a=Object['keys'](_0x361a8b)[_0x747722(0x277)]((_0x46e743,_0x48f80c)=>{const _0x4f6fa5=_0x747722,_0x2fcf41=plluData[_0x4f6fa5(0x25d)](_0xf5881a=>String(_0xf5881a[_0x4f6fa5(0x248)])===_0x46e743),_0x19715e=plluData[_0x4f6fa5(0x25d)](_0x144e70=>String(_0x144e70[_0x4f6fa5(0x248)])===_0x48f80c);return _0x2fcf41-_0x19715e;});_0x42754a[_0x747722(0x1f5)](_0x52a434=>{const _0x1d632a=_0x747722,_0x27e675=_0x361a8b[_0x52a434],_0x1cde19=secondaryPercentages[_0x52a434]||0x0,_0x3daf30=_0x27e675[_0x1d632a(0x277)]((_0x3e96af,_0x43b61a)=>{const _0x2e82c9=_0x1d632a,_0x597d0f=plluOriginalOrder[_0x2e82c9(0x25d)](_0xe8283a=>_0xe8283a[_0x2e82c9(0x25e)]===_0x3e96af[_0x2e82c9(0x25e)]),_0x52dc97=plluOriginalOrder['findIndex'](_0x358302=>_0x358302['PL_BLOCK']===_0x43b61a[_0x2e82c9(0x25e)]);return _0x597d0f-_0x52dc97;});let _0x8f55ad=0x0;const _0x4b2891={};let _0x1224fd=0x0;const _0x350da6=[];_0x3daf30[_0x1d632a(0x1f5)](_0x4213c3=>{const _0x518fbf=_0x1d632a;_0x8f55ad=_0x8f55ad+_0x4213c3[_0x518fbf(0x1f8)];let _0x1588e4=0x0,_0xa97513={},_0x4cfa51={};_0x47a2ed[_0x518fbf(0x1f5)](_0x1c614b=>{const _0x46d033=_0x518fbf;_0xa97513[_0x1c614b]=0x0,_0x4cfa51[_0x1c614b]=0x0;for(let _0x1a544d=0x1;_0x1a544d<=0x5;_0x1a544d++){const _0x1a72bd=_0x1c614b+'_'+_0x1a544d;_0x4213c3[_0x1a72bd]&&(_0xa97513[_0x1c614b]+=_0x4213c3[_0x1a72bd][_0x46d033(0x1fe)],_0x4cfa51[_0x1c614b]=_0x4cfa51[_0x1c614b]+_0x4213c3[_0x1a72bd]['landUseArea'],_0x1588e4=_0x1588e4+_0x4213c3[_0x1a72bd][_0x46d033(0x202)],!_0x4b2891[_0x1c614b]&&(_0x4b2891[_0x1c614b]={'buildingCount':0x0,'landUseArea':0x0}),_0x4b2891[_0x1c614b][_0x46d033(0x1fe)]+=_0x4213c3[_0x1a72bd]['buildingCount'],_0x4b2891[_0x1c614b][_0x46d033(0x202)]=_0x4b2891[_0x1c614b][_0x46d033(0x202)]+_0x4213c3[_0x1a72bd][_0x46d033(0x202)],_0x1224fd=_0x1224fd+_0x4213c3[_0x1a72bd][_0x46d033(0x202)]);}});const _0x11ea30=roundToTwoDecimals(_0x1588e4/_0x4213c3['AREA']*0x64);_0x350da6['push']({'block':_0x4213c3[_0x518fbf(0x25e)],'area':_0x4213c3[_0x518fbf(0x1f8)],'reBLUseCounts':_0xa97513,'reBLUseAreas':_0x4cfa51,'totalLandUseArea':_0x1588e4,'landUsePercentage':_0x11ea30,'exceedsLimit':_0x1cde19>0x0&&_0x11ea30>_0x1cde19});}),_0x350da6['forEach']((_0x1e6e18,_0x332df8)=>{const _0x4b70cb=_0x1d632a;_0x3ca948+=_0x4b70cb(0x246)+(_0x1e6e18[_0x4b70cb(0x21f)]?_0x4b70cb(0x296):'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1e6e18[_0x4b70cb(0x242)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x332df8===0x0?_0x52a434:'')+_0x4b70cb(0x267)+formatNumberTwoDecimal(_0x1e6e18[_0x4b70cb(0x250)])+'</td>',_0x47a2ed[_0x4b70cb(0x1f5)](_0x4ed995=>{const _0x540f75=_0x4b70cb;_0x3ca948+=_0x540f75(0x24d)+formatBuildingCount(_0x1e6e18['reBLUseCounts'][_0x4ed995])+_0x540f75(0x20d)+formatNumberTwoDecimal(_0x1e6e18[_0x540f75(0x1f7)][_0x4ed995])+_0x540f75(0x263);}),_0x3ca948+=_0x4b70cb(0x24d)+formatNumberTwoDecimal(_0x1e6e18[_0x4b70cb(0x23e)])+_0x4b70cb(0x267)+formatNumber(_0x1e6e18[_0x4b70cb(0x1e6)])+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x1cde19)+_0x4b70cb(0x287);});const _0x5432cb=roundToTwoDecimals(_0x1224fd/_0x8f55ad*0x64),_0x497271=_0x1cde19>0x0&&_0x5432cb>_0x1cde19;_0x3ca948+=_0x1d632a(0x28b)+(_0x497271?_0x1d632a(0x296):'')+_0x1d632a(0x24b)+_0x52a434+_0x1d632a(0x238)+formatNumberTwoDecimal(_0x8f55ad)+_0x1d632a(0x263),_0x47a2ed[_0x1d632a(0x1f5)](_0x53214c=>{const _0x16022a=_0x1d632a,_0x186e8a=_0x4b2891[_0x53214c]||{'buildingCount':0x0,'landUseArea':0x0};_0x3ca948+=_0x16022a(0x24d)+formatBuildingCount(_0x186e8a['buildingCount'])+_0x16022a(0x267)+formatNumberTwoDecimal(_0x186e8a[_0x16022a(0x202)])+'</td>';}),_0x3ca948+=_0x1d632a(0x24d)+formatNumberTwoDecimal(_0x1224fd)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x5432cb)+_0x1d632a(0x266)+formatNumber(_0x1cde19)+_0x1d632a(0x254);});let _0x574e85=0x0;const _0x23d084={};let _0x4b08fb=0x0;Object[_0x747722(0x27e)](_0x361a8b)[_0x747722(0x1f5)](([_0x47e90f,_0x53f681])=>{const _0x4329d9=_0x747722;_0x53f681[_0x4329d9(0x1f5)](_0xb57016=>{const _0x59e02e=_0x4329d9;_0x574e85=_0x574e85+_0xb57016[_0x59e02e(0x1f8)],_0x47a2ed[_0x59e02e(0x1f5)](_0x450515=>{const _0x57f702=_0x59e02e;!_0x23d084[_0x450515]&&(_0x23d084[_0x450515]={'buildingCount':0x0,'landUseArea':0x0});for(let _0x22d836=0x1;_0x22d836<=0x5;_0x22d836++){const _0x534c91=_0x450515+'_'+_0x22d836;_0xb57016[_0x534c91]&&(_0x23d084[_0x450515][_0x57f702(0x1fe)]+=_0xb57016[_0x534c91][_0x57f702(0x1fe)],_0x23d084[_0x450515][_0x57f702(0x202)]=_0x23d084[_0x450515][_0x57f702(0x202)]+_0xb57016[_0x534c91]['landUseArea'],_0x4b08fb=_0x4b08fb+_0xb57016[_0x534c91]['landUseArea']);}});});});const _0x4ea5da=roundToTwoDecimals(_0x4b08fb/_0x574e85*0x64);_0x3ca948+=_0x747722(0x233)+formatNumberTwoDecimal(_0x574e85)+_0x747722(0x263),_0x47a2ed[_0x747722(0x1f5)](_0x2c676b=>{const _0x2313de=_0x747722,_0x2595e6=_0x23d084[_0x2c676b]||{'buildingCount':0x0,'landUseArea':0x0};_0x3ca948+=_0x2313de(0x24d)+formatBuildingCount(_0x2595e6['buildingCount'])+_0x2313de(0x272)+formatNumberTwoDecimal(_0x2595e6['landUseArea'])+'</td>';}),_0x3ca948+='<td>'+formatNumberTwoDecimal(_0x4b08fb)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+formatNumber(_0x4ea5da)+_0x747722(0x29a);}_0x3ca948+=_0x747722(0x26d),_0x524573['innerHTML']=_0x3ca948;}function calculateLandUseArea(_0x41101d,_0x553bf0,_0x3f5f32){const _0x12efaa=_0x4f8d7b,_0x490fe4=_0x41101d[_0x12efaa(0x239)]((_0x3bded2,_0x2eb26e)=>{const _0x49043a=_0x12efaa;let _0x538b67;const _0x41c529=parseFloat(_0x2eb26e[_0x49043a(0x1f9)])||0x0;if(_0x553bf0==0xa){if(_0x3f5f32==0x1)_0x538b67=0x32;else{if(_0x3f5f32==0x2||_0x3f5f32==0x3)_0x538b67=0x3c;else{if(_0x3f5f32==0x4)_0x538b67=0x28;else{if(_0x3f5f32==0x5)_0x538b67=0x41;}}}}else{if(_0x553bf0==0x14){if(_0x3f5f32==0x1)_0x538b67=0x46;else{if(_0x3f5f32==0x2)_0x538b67=0x28;else{if(_0x3f5f32==0x3)_0x538b67=0x41;}}}else{if(_0x553bf0==0x29){if(_0x3f5f32==0x1)_0x538b67=0x46;else{if(_0x3f5f32==0x2)_0x538b67=0x28;else{if(_0x3f5f32==0x3)_0x538b67=0x41;}}}else{if(_0x553bf0==0x1e){if(_0x3f5f32==0x1)_0x538b67=0x46;else{if(_0x3f5f32==0x2||_0x3f5f32==0x4)_0x538b67=0x2d;else{if(_0x3f5f32==0x3)_0x538b67=0x32;}}}else{if(_0x553bf0==0x21){if(_0x3f5f32==0x1)_0x538b67=0x14;else{if(_0x3f5f32==0x2)_0x538b67=0x28;else{if(_0x3f5f32==0x3)_0x538b67=0x32;}}}else{if(_0x553bf0==0x50&&_0x3f5f32==0x1)_0x538b67=0x14;else _0x553bf0==0x5a&&_0x3f5f32==0x1&&(_0x538b67=0x46);}}}}}return _0x3bded2+_0x41c529*0x64/(_0x538b67||0x1);},0x0);return _0x490fe4;}function formatNumber(_0x1b2e8){const _0x6dd97b=roundToTwoDecimals(parseFloat(_0x1b2e8));return _0x6dd97b['toLocaleString']('en-US',{'minimumFractionDigits':0x2,'maximumFractionDigits':0x2});}function formatNumberTwoDecimal(_0x39f0f1){const _0x28f594=_0x4f8d7b;return parseFloat(_0x39f0f1)[_0x28f594(0x222)](_0x28f594(0x25a),{'minimumFractionDigits':0x2,'maximumFractionDigits':0x14});}function formatNumberForExcel(_0x349d03){return parseFloat(_0x349d03);}function formatBuildingCount(_0x23969f){const _0xca7d18=_0x4f8d7b;return parseInt(_0x23969f)[_0xca7d18(0x222)](_0xca7d18(0x25a));}function exportToExcel(){const _0x1ad8cc=_0x4f8d7b,_0xb78ade=document['querySelector']('#tableContainer\x20table');if(_0xb78ade){const _0xe8f451=_0xb78ade[_0x1ad8cc(0x1e9)](!![]),_0x27d052=_0xe8f451[_0x1ad8cc(0x271)]('tr');_0x27d052['forEach']((_0x4253d0,_0x431499)=>{const _0x7e6f2a=_0x1ad8cc,_0xfd2cde=_0x4253d0[_0x7e6f2a(0x271)]('td,\x20th');_0xfd2cde[_0x7e6f2a(0x1f5)]((_0x4fca97,_0x82636f)=>{const _0x1a6878=_0x7e6f2a;if(_0x431499>0x1){const _0x55e9be=_0x4fca97[_0x1a6878(0x228)][_0x1a6878(0x243)]();if(_0x55e9be[_0x1a6878(0x275)]('.')&&!_0x55e9be[_0x1a6878(0x275)]('%')){const _0xbef96e=parseFloat(_0x55e9be[_0x1a6878(0x27a)](/,/g,''));!isNaN(_0xbef96e)&&(_0x4fca97['textContent']=_0xbef96e);}else{if(_0x82636f===0x2){const _0x3c8ad1=parseFloat(_0x55e9be[_0x1a6878(0x27a)](/,/g,''));!isNaN(_0x3c8ad1)&&(_0x4fca97[_0x1a6878(0x228)]=_0x3c8ad1);}}}});});const _0x116eae={'sheet':_0x1ad8cc(0x22a),'cellDates':!![],'rawNumbers':!![]},_0x4c8bf4=XLSX['utils']['table_to_book'](_0xe8f451,_0x116eae);XLSX[_0x1ad8cc(0x219)](_0x4c8bf4,'land_use_calculation.xlsx');}else alert(_0x1ad8cc(0x231));}function exportMainActivitiesTableToExcel(){const _0x597c28=_0x4f8d7b,_0x9a0e95=document[_0x597c28(0x1f3)](_0x597c28(0x1ed));if(_0x9a0e95){const _0x2f1224=_0x9a0e95[_0x597c28(0x1e9)](!![]),_0x42fec7=_0x2f1224[_0x597c28(0x271)]('tr');_0x42fec7[_0x597c28(0x1f5)]((_0x7ec9b3,_0x566c6f)=>{const _0x33f13c=_0x597c28,_0x441e03=_0x7ec9b3['querySelectorAll'](_0x33f13c(0x276));_0x441e03[_0x33f13c(0x1f5)]((_0x25dfe8,_0x2310fc)=>{const _0x25e967=_0x33f13c;if(_0x566c6f>0x1){const _0x30a976=_0x25dfe8[_0x25e967(0x228)][_0x25e967(0x243)]();if(_0x30a976['includes']('.')&&!_0x30a976[_0x25e967(0x275)]('%')){const _0x1dd09c=parseFloat(_0x30a976[_0x25e967(0x27a)](/,/g,''));!isNaN(_0x1dd09c)&&(_0x25dfe8[_0x25e967(0x228)]=_0x1dd09c);}else{if(_0x2310fc===0x2){const _0x1e26dc=parseFloat(_0x30a976['replace'](/,/g,''));!isNaN(_0x1e26dc)&&(_0x25dfe8['textContent']=_0x1e26dc);}}}});});const _0x2840bf={'sheet':_0x597c28(0x23b),'cellDates':!![],'rawNumbers':!![]},_0x258425=XLSX[_0x597c28(0x200)]['table_to_book'](_0x2f1224,_0x2840bf);XLSX['writeFile'](_0x258425,'main_activities_calculation.xlsx');}else alert(_0x597c28(0x256));}function exportSecondaryActivitiesTableToExcel(){const _0x2429a1=_0x4f8d7b,_0x2ed0fa=document[_0x2429a1(0x1f3)](_0x2429a1(0x1e5));if(_0x2ed0fa){const _0x341c6a=_0x2ed0fa[_0x2429a1(0x1e9)](!![]),_0x4a982b=_0x341c6a['querySelectorAll']('tr');_0x4a982b[_0x2429a1(0x1f5)]((_0x256e7b,_0x56d7fe)=>{const _0x341fa7=_0x2429a1,_0x171d1c=_0x256e7b[_0x341fa7(0x271)]('td,\x20th');_0x171d1c[_0x341fa7(0x1f5)]((_0x1b57aa,_0x2fc1a2)=>{const _0xd37320=_0x341fa7;if(_0x56d7fe>0x1){const _0x482e07=_0x1b57aa['textContent'][_0xd37320(0x243)]();if(_0x482e07[_0xd37320(0x275)]('.')&&!_0x482e07['includes']('%')){const _0x596f51=parseFloat(_0x482e07['replace'](/,/g,''));!isNaN(_0x596f51)&&(_0x1b57aa[_0xd37320(0x228)]=_0x596f51);}else{if(_0x2fc1a2===0x2){const _0x2eabcc=parseFloat(_0x482e07[_0xd37320(0x27a)](/,/g,''));!isNaN(_0x2eabcc)&&(_0x1b57aa[_0xd37320(0x228)]=_0x2eabcc);}}}});});const _0xb9203={'sheet':_0x2429a1(0x1f1),'cellDates':!![],'rawNumbers':!![]},_0x11afda=XLSX[_0x2429a1(0x200)][_0x2429a1(0x244)](_0x341c6a,_0xb9203);XLSX[_0x2429a1(0x219)](_0x11afda,'secondary_activities_calculation.xlsx');}else alert(_0x2429a1(0x232));}
</script>
    <script data-goatcounter="https://mponline.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script> 
</body>
</html>
