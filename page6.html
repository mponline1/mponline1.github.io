<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบคำนวณประชากร</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .input-section {
            margin-bottom: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        input[type="file"],
        input[type="number"],
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 5px;
        }

        input[type="number"] {
            width: 200px;
        }

        .table-container {
            overflow-x: auto;
            display: none;
            margin-top: 20px;
            background-color: #fff;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
            font-size: 14px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px 8px;
            text-align: center;
        }

        th {
            background-color: #f8f9fa;
            color: #333;
            font-weight: bold;
            white-space: nowrap;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tr:nth-child(odd) {
            background-color: #ffffff;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .total-row {
            background-color: #e9ecef !important;
            font-weight: bold;
        }

        .filter-section {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .button-container {
            margin: 20px 0;
            text-align: center;
        }

        .button {
            padding: 12px 24px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .process-button {
            background-color: #007bff;
            color: white;
        }

        .process-button:hover {
            background-color: #0056b3;
        }

        .export-button {
            background-color: #28a745;
            color: white;
        }

        .export-button:hover {
            background-color: #218838;
        }

        .status-message {
            margin: 10px 0;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
            display: none;
        }

        .error {
            background-color: #fff3f3;
            color: #dc3545;
            border: 1px solid #f5c6cb;
        }

        .success {
            background-color: #f0fff0;
            color: #28a745;
            border: 1px solid #c3e6cb;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 6px 4px;
            }

            .button {
                width: 100%;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ระบบคำนวณประชากร</h1>
        
        <div class="input-section">
            <div class="input-group">
                <label for="buildingFile">ไฟล์อาคาร (Excel):</label>
                <input type="file" id="buildingFile" accept=".xlsx,.xls">
            </div>
            
            <div class="input-group">
                <label for="plluFile">ไฟล์ PLLU (Excel):</label>
                <input type="file" id="plluFile" accept=".xlsx,.xls">
            </div>
            
            <div class="input-group">
                <label for="householdSize">ขนาดครัวเรือนเฉลี่ย:</label>
                <input type="number" id="householdSize" step="0.01" value="3.0">
            </div>

            <div class="filter-section">
                <label for="plluFilter">กรองตาม PL_USE:</label>
                <select id="plluFilter">
                    <option value="all">ทั้งหมด</option>
                </select>
            </div>
        </div>

        <div id="statusMessage" class="status-message"></div>

        <div class="button-container">
            <button class="button process-button" onclick="processData()">ประมวลผล</button>
            <button class="button export-button" onclick="exportToExcel()" style="display: none;">Export to Excel</button>
        </div>

        <div class="table-container" id="tableContainer">
            <table id="resultTable">
                <thead>
                    <tr>
                        <th rowspan="2">การใช้ประโยชน์ที่ดินบริเวณหมายเลข</th>
                        <th colspan="2">บ้านเดี่ยว/อาคารเดี่ยว</th>
                        <th colspan="2">บ้านแฝด</th>
                        <th colspan="2">ทาวน์เฮาส์</th>
                        <th colspan="2">ห้องแถว</th>
                        <th colspan="2">ตึกแถว</th>
                        <th colspan="2">เรือนแพ</th>
                        <th colspan="3">อาคารพักอาศัย</th>
                        <th colspan="2">อื่นๆ</th>
                        <th rowspan="2">จำนวนอาคารรวม</th>
                        <th rowspan="2">ประชากรรวม</th>
                        <th rowspan="2">พื้นที่ทั้งหมด(ไร่)</th>
                        <th rowspan="2">ความหนาแน่นประชากร(คน/ไร่)</th>
                    </tr>
                    <tr>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>จำนวนห้อง</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script>
const _0x1ca38c=_0x43e1;(function(_0x3b62fd,_0x40308e){const _0x317ce6=_0x43e1,_0x5bfbac=_0x3b62fd();while(!![]){try{const _0x4dc167=parseInt(_0x317ce6(0xa9))/0x1*(parseInt(_0x317ce6(0x83))/0x2)+parseInt(_0x317ce6(0xbc))/0x3*(-parseInt(_0x317ce6(0xf2))/0x4)+-parseInt(_0x317ce6(0x96))/0x5*(-parseInt(_0x317ce6(0xe7))/0x6)+-parseInt(_0x317ce6(0xe2))/0x7*(-parseInt(_0x317ce6(0xc4))/0x8)+-parseInt(_0x317ce6(0xb6))/0x9+parseInt(_0x317ce6(0x95))/0xa+-parseInt(_0x317ce6(0x8b))/0xb*(parseInt(_0x317ce6(0xc7))/0xc);if(_0x4dc167===_0x40308e)break;else _0x5bfbac['push'](_0x5bfbac['shift']());}catch(_0x7ae6e0){_0x5bfbac['push'](_0x5bfbac['shift']());}}}(_0x387c,0xdd626));let buildingData=[],plluData=[],filteredData=[];document[_0x1ca38c(0x80)](_0x1ca38c(0xe9))[_0x1ca38c(0xa2)](_0x1ca38c(0x88),handleBuildingFile),document[_0x1ca38c(0x80)]('plluFile')[_0x1ca38c(0xa2)](_0x1ca38c(0x88),handlePlluFile),document['getElementById'](_0x1ca38c(0xeb))['addEventListener'](_0x1ca38c(0x88),filterData),document[_0x1ca38c(0x80)]('householdSize')['addEventListener']('keypress',function(_0x2ef9a5){const _0x4e5481=_0x1ca38c;_0x2ef9a5[_0x4e5481(0x85)]===_0x4e5481(0xb5)&&processData();});async function handleBuildingFile(_0x4bf87c){const _0x210a5d=_0x1ca38c;try{const _0x1daa13=_0x4bf87c[_0x210a5d(0xe0)][_0x210a5d(0x91)][0x0];buildingData=await readExcelFile(_0x1daa13),showStatus('อัพโหลดไฟล์อาคารสำเร็จ',_0x210a5d(0xf0));}catch(_0x399a13){handleError(_0x399a13,_0x210a5d(0xd1));}}async function handlePlluFile(_0x27e7d4){const _0x33a14a=_0x1ca38c;try{const _0x3b31b0=_0x27e7d4[_0x33a14a(0xe0)][_0x33a14a(0x91)][0x0];plluData=await readExcelFile(_0x3b31b0),updatePlluFilter(),showStatus(_0x33a14a(0xc9),'success');}catch(_0xea7a7d){handleError(_0xea7a7d,_0x33a14a(0xef));}}function _0x43e1(_0xef459e,_0x18189c){const _0x387c43=_0x387c();return _0x43e1=function(_0x43e137,_0x12f41e){_0x43e137=_0x43e137-0x80;let _0x504465=_0x387c43[_0x43e137];return _0x504465;},_0x43e1(_0xef459e,_0x18189c);}async function readExcelFile(_0x227c3c){return new Promise((_0x2bcc4a,_0x2cb636)=>{const _0x54a29a=_0x43e1,_0x1dd9e3=new FileReader();_0x1dd9e3[_0x54a29a(0x94)]=_0x6ed7e=>{const _0x2b7cbc=_0x54a29a;try{const _0x413ae9=_0x6ed7e[_0x2b7cbc(0xe0)][_0x2b7cbc(0xd9)],_0x28ee9a=XLSX[_0x2b7cbc(0xe8)](_0x413ae9,{'type':_0x2b7cbc(0x93)}),_0xd47bf5=_0x28ee9a['SheetNames'][0x0],_0x1e3233=_0x28ee9a[_0x2b7cbc(0xea)][_0xd47bf5],_0x2acf00=XLSX[_0x2b7cbc(0xca)][_0x2b7cbc(0xc3)](_0x1e3233);_0x2bcc4a(_0x2acf00);}catch(_0xf8b11){_0x2cb636(_0xf8b11);}},_0x1dd9e3['onerror']=_0x2cb636,_0x1dd9e3['readAsBinaryString'](_0x227c3c);});}function updatePlluFilter(){const _0x5a60ea=_0x1ca38c,_0x4c2cac=document[_0x5a60ea(0x80)]('plluFilter'),_0x170c9d=new Set(plluData[_0x5a60ea(0x9d)](_0x460dad=>_0x460dad[_0x5a60ea(0xba)]));_0x4c2cac[_0x5a60ea(0xce)]=_0x5a60ea(0xc6),[..._0x170c9d][_0x5a60ea(0xe5)]()[_0x5a60ea(0x9a)](_0x170477=>{const _0x1105ab=_0x5a60ea;_0x4c2cac[_0x1105ab(0xce)]+=_0x1105ab(0xc8)+_0x170477+'\x22>'+_0x170477+'</option>';});}function filterData(){const _0x4f0e74=_0x1ca38c,_0x46534a=document[_0x4f0e74(0x80)](_0x4f0e74(0xeb))[_0x4f0e74(0xb3)];filteredData=_0x46534a==='all'?[...plluData]:plluData[_0x4f0e74(0xbe)](_0x565e3d=>_0x565e3d[_0x4f0e74(0xba)]==_0x46534a),buildingData['length']>0x0&&plluData[_0x4f0e74(0xc0)]>0x0&&processData();}function showStatus(_0x3d01f7,_0x57eccd){const _0x286517=_0x1ca38c,_0x55e945=document[_0x286517(0x80)]('statusMessage');_0x55e945[_0x286517(0xae)]=_0x3d01f7,_0x55e945[_0x286517(0x90)]=_0x286517(0xaf)+_0x57eccd,_0x55e945[_0x286517(0xa5)]['display']=_0x286517(0xde),setTimeout(()=>{const _0x497583=_0x286517;_0x55e945[_0x497583(0xa5)][_0x497583(0xf1)]=_0x497583(0xd2);},0xbb8);}function _0x387c(){const _0x55e5e5=['householdSize','83930priGAF','#,##0.00','toISOString','BL_NUNIT','odd-row','className','files','จำนวนอาคาร\x20(ทาวน์เฮาส์)','binary','onload','13645610OEgoOU','1339510eBdvjG','กรุณากรอกขนาดครัวเรือนเฉลี่ยให้ถูกต้อง','จำนวนอาคาร\x20(อาคารพักอาศัย)','กรุณาอัพโหลดไฟล์ให้ครบถ้วน','forEach','book_new','aoa_to_sheet','map','total-row','population_calculation_','PL_BLOCK','townhouse','addEventListener','.xlsx','houseboat','style','reduce','area','buildings','7IXPiaz','insertRow','shophouse','density','BL_TYPE','textContent','status-message\x20','จำนวนอาคาร\x20(ตึกแถว)','plBlock','stats','value','totalPopulation','Enter','10444491EkuDch','จำนวนอาคาร\x20(ห้องแถว)','count','จำนวนอาคาร\x20(อื่นๆ)','PL_USE','error','18666LRADeA','writeFile','filter','getElementsByTagName','length','การใช้ประโยชน์ที่ดินบริเวณหมายเลข','others','sheet_to_json','16mFwvqc','insertCell','<option\x20value=\x22all\x22>ทั้งหมด</option>','1848MiYxPa','<option\x20value=\x22','อัพโหลดไฟล์\x20PLLU\x20สำเร็จ','utils','จำนวนอาคาร\x20(เรือนแพ)','totalBuildings','AREA(rai)','innerHTML','population','includes','เกิดข้อผิดพลาดในการอ่านไฟล์อาคาร','none','values','commercial','wch','พื้นที่ทั้งหมด(ไร่)','apartment','จำนวนอาคารรวม','result','รวม','จำนวนห้อง\x20(อาคารพักอาศัย)','singleHouse','จำนวนอาคาร\x20(บ้านแฝด)','block','ข้อมูลประชากร','target','duplexHouse','5260759TOKvkj','split','inline-block','sort','even-row','18DyxOdl','read','buildingFile','Sheets','plluFilter','rows','tbody','cells','เกิดข้อผิดพลาดในการอ่านไฟล์\x20PLLU','success','display','468ULHBsU','getElementById','toFixed','ประชากร\x20(บ้านเดี่ยว)','85412fNGRAw','ส่งออกข้อมูลสำเร็จ','key','resultTable','push','change','rooms'];_0x387c=function(){return _0x55e5e5;};return _0x387c();}function handleError(_0x153332,_0x1ce845){const _0x1ad4e6=_0x1ca38c;console[_0x1ad4e6(0xbb)](_0x153332),showStatus(_0x1ce845,_0x1ad4e6(0xbb));}function processData(){const _0x1ee79e=_0x1ca38c;try{if(!buildingData[_0x1ee79e(0xc0)]||!plluData[_0x1ee79e(0xc0)]){showStatus(_0x1ee79e(0x99),_0x1ee79e(0xbb));return;}const _0x191b30=parseFloat(document[_0x1ee79e(0x80)](_0x1ee79e(0x8a))[_0x1ee79e(0xb3)]);if(!_0x191b30||_0x191b30<=0x0){showStatus(_0x1ee79e(0x97),_0x1ee79e(0xbb));return;}!filteredData[_0x1ee79e(0xc0)]&&(filteredData=[...plluData]),calculatePopulation(),document[_0x1ee79e(0x80)]('tableContainer')[_0x1ee79e(0xa5)][_0x1ee79e(0xf1)]=_0x1ee79e(0xde),document['querySelector']('.export-button')[_0x1ee79e(0xa5)]['display']=_0x1ee79e(0xe4),showStatus('ประมวลผลข้อมูลสำเร็จ',_0x1ee79e(0xf0));}catch(_0x3d0999){handleError(_0x3d0999,'เกิดข้อผิดพลาดในการประมวลผลข้อมูล');}}function calculatePopulation(){const _0xbd8c8a=_0x1ca38c,_0x562e82=parseFloat(document[_0xbd8c8a(0x80)](_0xbd8c8a(0x8a))[_0xbd8c8a(0xb3)]),_0x5dafe9=document[_0xbd8c8a(0x80)](_0xbd8c8a(0x86))['getElementsByTagName'](_0xbd8c8a(0xed))[0x0];_0x5dafe9[_0xbd8c8a(0xce)]='';const _0x55c750=[0x3e8,0x44c,0x44d,0x44e,0x44f,0x461,0x462,0x463,0x46b,0x46c,0x4b0,0x514,0x51e,0x528,0x532,0x53c,0x546,0x1004,0x100e,0x1018,0x1019,0x101a,0x101b,0x1054,0x10cc],_0x18fe19=filteredData['map'](_0x48536f=>{const _0xdd08e1=_0xbd8c8a,_0xb6188c=buildingData[_0xdd08e1(0xbe)](_0x1efac=>_0x1efac[_0xdd08e1(0xa0)]===_0x48536f['PL_BLOCK']&&_0x55c750[_0xdd08e1(0xd0)](_0x1efac['BL_USE'])),_0xddbd09=_0xbd42fb=>{const _0x1735a0=_0xdd08e1,_0x239218=_0xb6188c[_0x1735a0(0xbe)](_0x6c4635=>_0x6c4635[_0x1735a0(0xad)]===_0xbd42fb),_0x3a553f=_0x239218[_0x1735a0(0xc0)];let _0x5ca06c=0x0;switch(_0xbd42fb){case 0x1:_0x5ca06c=_0x3a553f*(_0x562e82+0.15);break;case 0x2:_0x5ca06c=_0x3a553f*_0x562e82;break;case 0x3:case 0x4:case 0x5:_0x5ca06c=_0x3a553f*(_0x562e82-0.1);break;case 0x7:_0x5ca06c=_0x3a553f*(_0x562e82+0.15);break;case 0x6:const _0x4ee7c2=_0x239218['reduce']((_0x3c4c66,_0x52bd98)=>_0x3c4c66+(_0x52bd98[_0x1735a0(0x8e)]||0x0),0x0);_0x5ca06c=_0x3a553f*(_0x4ee7c2*0x2);return{'count':_0x3a553f,'rooms':_0x4ee7c2,'population':_0x5ca06c};case 0x8:case 0x62:_0x5ca06c=_0x3a553f*_0x562e82*0x2;break;}return{'count':_0x3a553f,'population':_0x5ca06c};},_0x281a93={'singleHouse':_0xddbd09(0x1),'duplexHouse':_0xddbd09(0x2),'townhouse':_0xddbd09(0x3),'shophouse':_0xddbd09(0x4),'commercial':_0xddbd09(0x5),'houseboat':_0xddbd09(0x7),'apartment':_0xddbd09(0x6),'others':{'count':_0xb6188c[_0xdd08e1(0xbe)](_0x3470dd=>[0x8,0x62][_0xdd08e1(0xd0)](_0x3470dd[_0xdd08e1(0xad)]))[_0xdd08e1(0xc0)],'population':_0xb6188c[_0xdd08e1(0xbe)](_0xdbc8b7=>[0x8,0x62]['includes'](_0xdbc8b7[_0xdd08e1(0xad)]))['length']*_0x562e82*0x2}},_0x2fbdbd=Object[_0xdd08e1(0xd3)](_0x281a93)[_0xdd08e1(0xa6)]((_0x379934,_0x48e501)=>_0x379934+_0x48e501[_0xdd08e1(0xb8)],0x0),_0x2be4ad=Object[_0xdd08e1(0xd3)](_0x281a93)[_0xdd08e1(0xa6)]((_0x1eb141,_0x3b4950)=>_0x1eb141+_0x3b4950[_0xdd08e1(0xcf)],0x0),_0x1ba6b4=_0x2be4ad/_0x48536f[_0xdd08e1(0xcd)];return{'plBlock':_0x48536f[_0xdd08e1(0xa0)],'stats':_0x281a93,'totalBuildings':_0x2fbdbd,'totalPopulation':_0x2be4ad,'area':_0x48536f[_0xdd08e1(0xcd)],'density':_0x1ba6b4};});_0x18fe19[_0xbd8c8a(0x9a)]((_0x1c0f6c,_0x4e4b11)=>{const _0x264969=_0xbd8c8a,_0x9d73fa=_0x5dafe9[_0x264969(0xaa)]();_0x9d73fa[_0x264969(0x90)]=_0x4e4b11%0x2===0x0?_0x264969(0xe6):_0x264969(0x8f),_0x9d73fa[_0x264969(0xc5)]()['textContent']=_0x1c0f6c[_0x264969(0xb1)],_0x9d73fa['insertCell']()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xdc)][_0x264969(0xb8)],_0x9d73fa[_0x264969(0xc5)]()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xdc)][_0x264969(0xcf)][_0x264969(0x81)](0x2),_0x9d73fa[_0x264969(0xc5)]()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xe1)][_0x264969(0xb8)],_0x9d73fa[_0x264969(0xc5)]()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xe1)]['population'][_0x264969(0x81)](0x2),_0x9d73fa['insertCell']()['textContent']=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xa1)][_0x264969(0xb8)],_0x9d73fa['insertCell']()[_0x264969(0xae)]=_0x1c0f6c['stats'][_0x264969(0xa1)]['population'][_0x264969(0x81)](0x2),_0x9d73fa[_0x264969(0xc5)]()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xab)][_0x264969(0xb8)],_0x9d73fa['insertCell']()[_0x264969(0xae)]=_0x1c0f6c['stats'][_0x264969(0xab)][_0x264969(0xcf)][_0x264969(0x81)](0x2),_0x9d73fa[_0x264969(0xc5)]()[_0x264969(0xae)]=_0x1c0f6c['stats'][_0x264969(0xd4)][_0x264969(0xb8)],_0x9d73fa[_0x264969(0xc5)]()['textContent']=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xd4)]['population']['toFixed'](0x2),_0x9d73fa['insertCell']()[_0x264969(0xae)]=_0x1c0f6c['stats']['houseboat']['count'],_0x9d73fa[_0x264969(0xc5)]()['textContent']=_0x1c0f6c[_0x264969(0xb2)]['houseboat'][_0x264969(0xcf)][_0x264969(0x81)](0x2),_0x9d73fa['insertCell']()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xd7)][_0x264969(0xb8)],_0x9d73fa[_0x264969(0xc5)]()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xd7)][_0x264969(0x89)]||0x0,_0x9d73fa[_0x264969(0xc5)]()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xd7)][_0x264969(0xcf)][_0x264969(0x81)](0x2),_0x9d73fa[_0x264969(0xc5)]()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xb2)][_0x264969(0xc2)][_0x264969(0xb8)],_0x9d73fa['insertCell']()[_0x264969(0xae)]=_0x1c0f6c['stats']['others']['population'][_0x264969(0x81)](0x2),_0x9d73fa['insertCell']()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xcc)],_0x9d73fa[_0x264969(0xc5)]()['textContent']=_0x1c0f6c[_0x264969(0xb4)][_0x264969(0x81)](0x2),_0x9d73fa[_0x264969(0xc5)]()[_0x264969(0xae)]=_0x1c0f6c[_0x264969(0xa7)][_0x264969(0x81)](0x2),_0x9d73fa['insertCell']()['textContent']=_0x1c0f6c[_0x264969(0xac)][_0x264969(0x81)](0x2);}),addTotalRow(_0x18fe19);}function addTotalRow(_0x440e34){const _0x38378f=_0x1ca38c,_0x3af0c1=document[_0x38378f(0x80)]('resultTable')[_0x38378f(0xbf)](_0x38378f(0xed))[0x0],_0x3adcc5=_0x3af0c1[_0x38378f(0xaa)]();_0x3adcc5[_0x38378f(0x90)]=_0x38378f(0x9e),_0x3adcc5[_0x38378f(0xc5)]()['textContent']=_0x38378f(0xda);const _0xe9add3={'singleHouse':{'count':0x0,'population':0x0},'duplexHouse':{'count':0x0,'population':0x0},'townhouse':{'count':0x0,'population':0x0},'shophouse':{'count':0x0,'population':0x0},'commercial':{'count':0x0,'population':0x0},'houseboat':{'count':0x0,'population':0x0},'apartment':{'count':0x0,'rooms':0x0,'population':0x0},'others':{'count':0x0,'population':0x0},'buildings':0x0,'population':0x0,'area':0x0};_0x440e34[_0x38378f(0x9a)](_0x5048ed=>{const _0x299b9e=_0x38378f;_0xe9add3['singleHouse']['count']+=_0x5048ed['stats'][_0x299b9e(0xdc)][_0x299b9e(0xb8)],_0xe9add3['singleHouse'][_0x299b9e(0xcf)]+=_0x5048ed['stats'][_0x299b9e(0xdc)]['population'],_0xe9add3['duplexHouse'][_0x299b9e(0xb8)]+=_0x5048ed[_0x299b9e(0xb2)]['duplexHouse'][_0x299b9e(0xb8)],_0xe9add3[_0x299b9e(0xe1)][_0x299b9e(0xcf)]+=_0x5048ed[_0x299b9e(0xb2)]['duplexHouse'][_0x299b9e(0xcf)],_0xe9add3[_0x299b9e(0xa1)][_0x299b9e(0xb8)]+=_0x5048ed[_0x299b9e(0xb2)][_0x299b9e(0xa1)][_0x299b9e(0xb8)],_0xe9add3[_0x299b9e(0xa1)][_0x299b9e(0xcf)]+=_0x5048ed[_0x299b9e(0xb2)]['townhouse'][_0x299b9e(0xcf)],_0xe9add3[_0x299b9e(0xab)][_0x299b9e(0xb8)]+=_0x5048ed[_0x299b9e(0xb2)][_0x299b9e(0xab)][_0x299b9e(0xb8)],_0xe9add3[_0x299b9e(0xab)][_0x299b9e(0xcf)]+=_0x5048ed['stats'][_0x299b9e(0xab)][_0x299b9e(0xcf)],_0xe9add3['commercial'][_0x299b9e(0xb8)]+=_0x5048ed[_0x299b9e(0xb2)][_0x299b9e(0xd4)][_0x299b9e(0xb8)],_0xe9add3[_0x299b9e(0xd4)][_0x299b9e(0xcf)]+=_0x5048ed['stats'][_0x299b9e(0xd4)][_0x299b9e(0xcf)],_0xe9add3['houseboat'][_0x299b9e(0xb8)]+=_0x5048ed[_0x299b9e(0xb2)]['houseboat'][_0x299b9e(0xb8)],_0xe9add3[_0x299b9e(0xa4)][_0x299b9e(0xcf)]+=_0x5048ed[_0x299b9e(0xb2)][_0x299b9e(0xa4)]['population'],_0xe9add3[_0x299b9e(0xd7)]['count']+=_0x5048ed['stats'][_0x299b9e(0xd7)][_0x299b9e(0xb8)],_0xe9add3[_0x299b9e(0xd7)][_0x299b9e(0x89)]+=_0x5048ed['stats']['apartment'][_0x299b9e(0x89)]||0x0,_0xe9add3[_0x299b9e(0xd7)][_0x299b9e(0xcf)]+=_0x5048ed[_0x299b9e(0xb2)][_0x299b9e(0xd7)]['population'],_0xe9add3['others'][_0x299b9e(0xb8)]+=_0x5048ed[_0x299b9e(0xb2)]['others'][_0x299b9e(0xb8)],_0xe9add3[_0x299b9e(0xc2)][_0x299b9e(0xcf)]+=_0x5048ed[_0x299b9e(0xb2)][_0x299b9e(0xc2)][_0x299b9e(0xcf)],_0xe9add3[_0x299b9e(0xa8)]+=_0x5048ed[_0x299b9e(0xcc)],_0xe9add3[_0x299b9e(0xcf)]+=_0x5048ed['totalPopulation'],_0xe9add3[_0x299b9e(0xa7)]+=_0x5048ed[_0x299b9e(0xa7)];}),_0x3adcc5['insertCell']()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xdc)][_0x38378f(0xb8)],_0x3adcc5['insertCell']()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xdc)][_0x38378f(0xcf)][_0x38378f(0x81)](0x2),_0x3adcc5['insertCell']()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xe1)]['count'],_0x3adcc5[_0x38378f(0xc5)]()['textContent']=_0xe9add3[_0x38378f(0xe1)][_0x38378f(0xcf)][_0x38378f(0x81)](0x2),_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xa1)][_0x38378f(0xb8)],_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0xe9add3['townhouse'][_0x38378f(0xcf)][_0x38378f(0x81)](0x2),_0x3adcc5['insertCell']()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xab)][_0x38378f(0xb8)],_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xab)]['population'][_0x38378f(0x81)](0x2),_0x3adcc5['insertCell']()[_0x38378f(0xae)]=_0xe9add3['commercial'][_0x38378f(0xb8)],_0x3adcc5['insertCell']()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xd4)][_0x38378f(0xcf)]['toFixed'](0x2),_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xa4)]['count'],_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xa4)][_0x38378f(0xcf)]['toFixed'](0x2),_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0xe9add3['apartment']['count'],_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0xe9add3['apartment'][_0x38378f(0x89)],_0x3adcc5['insertCell']()[_0x38378f(0xae)]=_0xe9add3[_0x38378f(0xd7)]['population'][_0x38378f(0x81)](0x2),_0x3adcc5[_0x38378f(0xc5)]()['textContent']=_0xe9add3[_0x38378f(0xc2)][_0x38378f(0xb8)],_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0xe9add3['others'][_0x38378f(0xcf)][_0x38378f(0x81)](0x2),_0x3adcc5['insertCell']()['textContent']=_0xe9add3[_0x38378f(0xa8)],_0x3adcc5[_0x38378f(0xc5)]()['textContent']=_0xe9add3['population'][_0x38378f(0x81)](0x2),_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0xe9add3['area'][_0x38378f(0x81)](0x2);const _0x4ac55f=_0xe9add3[_0x38378f(0xcf)]/_0xe9add3['area'];_0x3adcc5[_0x38378f(0xc5)]()[_0x38378f(0xae)]=_0x4ac55f['toFixed'](0x2);}function exportToExcel(){const _0x21bb30=_0x1ca38c;try{const _0x1fe2c1=document['getElementById'](_0x21bb30(0x86)),_0x2bb92e=[],_0x113d07=[_0x21bb30(0xc1),'จำนวนอาคาร\x20(บ้านเดี่ยว)',_0x21bb30(0x82),_0x21bb30(0xdd),'ประชากร\x20(บ้านแฝด)',_0x21bb30(0x92),'ประชากร\x20(ทาวน์เฮาส์)',_0x21bb30(0xb7),'ประชากร\x20(ห้องแถว)',_0x21bb30(0xb0),'ประชากร\x20(ตึกแถว)',_0x21bb30(0xcb),'ประชากร\x20(เรือนแพ)',_0x21bb30(0x98),_0x21bb30(0xdb),'ประชากร\x20(อาคารพักอาศัย)',_0x21bb30(0xb9),'ประชากร\x20(อื่นๆ)',_0x21bb30(0xd8),'ประชากรรวม',_0x21bb30(0xd6),'ความหนาแน่นประชากร(คน/ไร่)'];_0x2bb92e[_0x21bb30(0x87)](_0x113d07);for(let _0x59b711=0x0;_0x59b711<_0x1fe2c1['rows'][_0x21bb30(0xc0)];_0x59b711++){const _0x3d47fd=_0x1fe2c1[_0x21bb30(0xec)][_0x59b711];if(_0x59b711>0x1){const _0x36e575=[];for(let _0x2197cc=0x0;_0x2197cc<_0x3d47fd[_0x21bb30(0xee)][_0x21bb30(0xc0)];_0x2197cc++){const _0x4fd029=_0x3d47fd[_0x21bb30(0xee)][_0x2197cc][_0x21bb30(0xae)];_0x36e575[_0x21bb30(0x87)](_0x2197cc===0x0?_0x4fd029:isNaN(_0x4fd029)?_0x4fd029:Number(_0x4fd029));}_0x2bb92e['push'](_0x36e575);}}const _0x46a48c=XLSX[_0x21bb30(0xca)][_0x21bb30(0x9b)](),_0x4826ed=XLSX[_0x21bb30(0xca)][_0x21bb30(0x9c)](_0x2bb92e),_0x3d7e2f=_0x113d07[_0x21bb30(0x9d)](()=>({'wch':0xf}));_0x3d7e2f[0x0][_0x21bb30(0xd5)]=0x19,_0x4826ed['!cols']=_0x3d7e2f;for(let _0x156303=0x1;_0x156303<_0x2bb92e[_0x21bb30(0xc0)];_0x156303++){for(let _0x2b5209=0x1;_0x2b5209<_0x2bb92e[_0x156303][_0x21bb30(0xc0)];_0x2b5209++){const _0x37ff99=XLSX[_0x21bb30(0xca)]['encode_cell']({'r':_0x156303,'c':_0x2b5209});if(!_0x4826ed[_0x37ff99])continue;!isNaN(_0x4826ed[_0x37ff99]['v'])&&(_0x4826ed[_0x37ff99]['t']='n',_0x2b5209===_0x2bb92e[_0x156303]['length']-0x1||_0x2b5209%0x2===0x1?_0x4826ed[_0x37ff99]['z']=_0x21bb30(0x8c):_0x4826ed[_0x37ff99]['z']='#,##0.00');}}XLSX['utils']['book_append_sheet'](_0x46a48c,_0x4826ed,_0x21bb30(0xdf));const _0x58adfc=_0x21bb30(0x9f)+new Date()[_0x21bb30(0x8d)]()[_0x21bb30(0xe3)]('T')[0x0]+_0x21bb30(0xa3);XLSX[_0x21bb30(0xbd)](_0x46a48c,_0x58adfc),showStatus(_0x21bb30(0x84),_0x21bb30(0xf0));}catch(_0x3f8a3b){console[_0x21bb30(0xbb)]('Error\x20exporting\x20to\x20Excel:',_0x3f8a3b),handleError(_0x3f8a3b,'เกิดข้อผิดพลาดในการส่งออกข้อมูล');}}
    </script>
</body>
</html>            