<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบคำนวณประชากร</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .input-section {
            margin-bottom: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        input[type="file"],
        input[type="number"],
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 5px;
        }

        input[type="number"] {
            width: 200px;
        }

        .table-container {
            overflow-x: auto;
            display: none;
            margin-top: 20px;
            background-color: #fff;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
            font-size: 14px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px 8px;
            text-align: center;
        }

        th {
            background-color: #f8f9fa;
            color: #333;
            font-weight: bold;
            white-space: nowrap;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tr:nth-child(odd) {
            background-color: #ffffff;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .total-row {
            background-color: #e9ecef !important;
            font-weight: bold;
        }

        .filter-section {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .button-container {
            margin: 20px 0;
            text-align: center;
        }

        .button {
            padding: 12px 24px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .process-button {
            background-color: #007bff;
            color: white;
        }

        .process-button:hover {
            background-color: #0056b3;
        }

        .export-button {
            background-color: #28a745;
            color: white;
        }

        .export-button:hover {
            background-color: #218838;
        }

        .status-message {
            margin: 10px 0;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
            display: none;
        }

        .error {
            background-color: #fff3f3;
            color: #dc3545;
            border: 1px solid #f5c6cb;
        }

        .success {
            background-color: #f0fff0;
            color: #28a745;
            border: 1px solid #c3e6cb;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 6px 4px;
            }

            .button {
                width: 100%;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ระบบคำนวณประชากร</h1>
        
        <div class="input-section">
            <div class="input-group">
                <label for="buildingFile">ไฟล์อาคาร (Excel):</label>
                <input type="file" id="buildingFile" accept=".xlsx,.xls">
            </div>
            
            <div class="input-group">
                <label for="plluFile">ไฟล์ PLLU (Excel):</label>
                <input type="file" id="plluFile" accept=".xlsx,.xls">
            </div>
            
            <div class="input-group">
                <label for="householdSize">ขนาดครัวเรือนเฉลี่ย:</label>
                <input type="number" id="householdSize" step="0.01" value="3.0">
            </div>

            <div class="filter-section">
                <label for="plluFilter">กรองตาม PL_USE:</label>
                <select id="plluFilter">
                    <option value="all">ทั้งหมด</option>
                </select>
            </div>
        </div>

        <div id="statusMessage" class="status-message"></div>

        <div class="button-container">
            <button class="button process-button" onclick="processData()">ประมวลผล</button>
            <button class="button export-button" onclick="exportToExcel()" style="display: none;">Export to Excel</button>
        </div>

        <div class="table-container" id="tableContainer">
            <table id="resultTable">
                <thead>
                    <tr>
                        <th rowspan="2">การใช้ประโยชน์ที่ดินบริเวณหมายเลข</th>
                        <th colspan="2">บ้านเดี่ยว/อาคารเดี่ยว</th>
                        <th colspan="2">บ้านแฝด</th>
                        <th colspan="2">ทาวน์เฮาส์</th>
                        <th colspan="2">ห้องแถว</th>
                        <th colspan="2">ตึกแถว</th>
                        <th colspan="2">เรือนแพ</th>
                        <th colspan="3">อาคารพักอาศัย</th>
                        <th colspan="2">อื่นๆ</th>
                        <th rowspan="2">จำนวนอาคารรวม</th>
                        <th rowspan="2">ประชากรรวม</th>
                        <th rowspan="2">พื้นที่ทั้งหมด(ไร่)</th>
                        <th rowspan="2">ความหนาแน่นประชากร(คน/ไร่)</th>
                    </tr>
                    <tr>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>จำนวนห้อง</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script>
const _0x734ceb=_0x3d55;(function(_0x2f0b9d,_0x4e2416){const _0x247b7b=_0x3d55,_0xeb5e17=_0x2f0b9d();while(!![]){try{const _0x321f7a=parseInt(_0x247b7b(0x1f6))/0x1+-parseInt(_0x247b7b(0x210))/0x2+parseInt(_0x247b7b(0x244))/0x3*(-parseInt(_0x247b7b(0x221))/0x4)+parseInt(_0x247b7b(0x211))/0x5*(-parseInt(_0x247b7b(0x254))/0x6)+parseInt(_0x247b7b(0x207))/0x7*(parseInt(_0x247b7b(0x215))/0x8)+parseInt(_0x247b7b(0x26a))/0x9*(-parseInt(_0x247b7b(0x25c))/0xa)+parseInt(_0x247b7b(0x240))/0xb*(parseInt(_0x247b7b(0x226))/0xc);if(_0x321f7a===_0x4e2416)break;else _0xeb5e17['push'](_0xeb5e17['shift']());}catch(_0x5d5709){_0xeb5e17['push'](_0xeb5e17['shift']());}}}(_0x4060,0x6e6c6));let buildingData=[],plluData=[],filteredData=[];document[_0x734ceb(0x25a)](_0x734ceb(0x266))['addEventListener'](_0x734ceb(0x220),handleBuildingFile),document[_0x734ceb(0x25a)](_0x734ceb(0x239))[_0x734ceb(0x255)]('change',handlePlluFile),document[_0x734ceb(0x25a)](_0x734ceb(0x24d))[_0x734ceb(0x255)]('change',filterData),document['getElementById'](_0x734ceb(0x270))[_0x734ceb(0x255)]('keypress',function(_0x39448b){const _0x14c6ed=_0x734ceb;_0x39448b[_0x14c6ed(0x26b)]==='Enter'&&processData();});async function handleBuildingFile(_0x2a3e6a){const _0x933949=_0x734ceb;try{const _0x20ea40=_0x2a3e6a[_0x933949(0x22e)][_0x933949(0x235)][0x0];buildingData=await readExcelFile(_0x20ea40),showStatus(_0x933949(0x260),'success');}catch(_0x30de0e){handleError(_0x30de0e,_0x933949(0x222));}}async function handlePlluFile(_0x6e1e84){const _0x4d5d5e=_0x734ceb;try{const _0x212b24=_0x6e1e84[_0x4d5d5e(0x22e)][_0x4d5d5e(0x235)][0x0];plluData=await readExcelFile(_0x212b24),updatePlluFilter(),showStatus(_0x4d5d5e(0x259),'success');}catch(_0x366244){handleError(_0x366244,_0x4d5d5e(0x25d));}}async function readExcelFile(_0xa95ae8){return new Promise((_0x1bdec3,_0x2608b6)=>{const _0xa5fcff=_0x3d55,_0x42642d=new FileReader();_0x42642d[_0xa5fcff(0x253)]=_0x30b924=>{const _0x5b5c95=_0xa5fcff;try{const _0x1863b3=_0x30b924[_0x5b5c95(0x22e)][_0x5b5c95(0x219)],_0x522a3e=XLSX['read'](_0x1863b3,{'type':'binary'}),_0x56899a=_0x522a3e['SheetNames'][0x0],_0x4828a6=_0x522a3e[_0x5b5c95(0x249)][_0x56899a],_0x1c505d=XLSX['utils'][_0x5b5c95(0x234)](_0x4828a6);_0x1bdec3(_0x1c505d);}catch(_0x3b030e){_0x2608b6(_0x3b030e);}},_0x42642d[_0xa5fcff(0x205)]=_0x2608b6,_0x42642d['readAsBinaryString'](_0xa95ae8);});}function updatePlluFilter(){const _0x5938e6=_0x734ceb,_0x4e5c54=document[_0x5938e6(0x25a)](_0x5938e6(0x24d)),_0xaf07bb=new Set(plluData[_0x5938e6(0x24c)](_0x2a33b1=>_0x2a33b1['PL_USE']));_0x4e5c54[_0x5938e6(0x21d)]=_0x5938e6(0x26d),[..._0xaf07bb]['sort']()[_0x5938e6(0x1fb)](_0x20b96b=>{const _0x560f41=_0x5938e6;_0x4e5c54['innerHTML']+=_0x560f41(0x21f)+_0x20b96b+'\x22>'+_0x20b96b+'</option>';});}function _0x3d55(_0x38ef1a,_0x44856f){const _0x406083=_0x4060();return _0x3d55=function(_0x3d5577,_0x25cf41){_0x3d5577=_0x3d5577-0x1f2;let _0x45aa3c=_0x406083[_0x3d5577];return _0x45aa3c;},_0x3d55(_0x38ef1a,_0x44856f);}function filterData(){const _0x168594=_0x734ceb,_0x27b9aa=document[_0x168594(0x25a)](_0x168594(0x24d))[_0x168594(0x1fe)];filteredData=_0x27b9aa===_0x168594(0x209)?[...plluData]:plluData[_0x168594(0x20c)](_0x49ab93=>_0x49ab93['PL_USE']==_0x27b9aa),buildingData['length']>0x0&&plluData[_0x168594(0x223)]>0x0&&processData();}function showStatus(_0x33a74e,_0x41bda9){const _0x4d16a5=_0x734ceb,_0x2993f2=document[_0x4d16a5(0x25a)](_0x4d16a5(0x22c));_0x2993f2['textContent']=_0x33a74e,_0x2993f2[_0x4d16a5(0x23a)]=_0x4d16a5(0x261)+_0x41bda9,_0x2993f2[_0x4d16a5(0x26c)][_0x4d16a5(0x26e)]='block',setTimeout(()=>{const _0x3e822e=_0x4d16a5;_0x2993f2[_0x3e822e(0x26c)][_0x3e822e(0x26e)]=_0x3e822e(0x256);},0xbb8);}function handleError(_0x40ad23,_0x12e72e){const _0xb76394=_0x734ceb;console[_0xb76394(0x224)](_0x40ad23),showStatus(_0x12e72e,'error');}function processData(){const _0xc892ab=_0x734ceb;try{if(!buildingData[_0xc892ab(0x223)]||!plluData[_0xc892ab(0x223)]){showStatus(_0xc892ab(0x20d),_0xc892ab(0x224));return;}const _0x2210aa=parseFloat(document['getElementById'](_0xc892ab(0x270))[_0xc892ab(0x1fe)]);if(!_0x2210aa||_0x2210aa<=0x0){showStatus(_0xc892ab(0x202),_0xc892ab(0x224));return;}!filteredData[_0xc892ab(0x223)]&&(filteredData=[...plluData]),calculatePopulation(),document[_0xc892ab(0x25a)](_0xc892ab(0x217))[_0xc892ab(0x26c)][_0xc892ab(0x26e)]=_0xc892ab(0x1f2),document[_0xc892ab(0x247)](_0xc892ab(0x265))[_0xc892ab(0x26c)]['display']='inline-block',showStatus(_0xc892ab(0x246),_0xc892ab(0x230));}catch(_0x5258e7){handleError(_0x5258e7,_0xc892ab(0x1f8));}}function calculatePopulation(){const _0x1fc053=_0x734ceb,_0x238066=parseFloat(document[_0x1fc053(0x25a)](_0x1fc053(0x270))[_0x1fc053(0x1fe)]),_0x1e795f=document[_0x1fc053(0x25a)](_0x1fc053(0x264))[_0x1fc053(0x243)](_0x1fc053(0x21c))[0x0];_0x1e795f['innerHTML']='';const _0x394018=[0x3e8,0x44c,0x44d,0x44e,0x44f,0x461,0x462,0x463,0x46b,0x46c,0x4b0,0x514,0x51e,0x528,0x532,0x53c,0x546,0x1004,0x100e,0x1018,0x1019,0x101a,0x101b,0x1054,0x10cc],_0x5e0752=filteredData[_0x1fc053(0x24c)](_0x4c57ab=>{const _0x462a19=_0x1fc053,_0x3ba0f0=buildingData[_0x462a19(0x20c)](_0x100111=>_0x100111[_0x462a19(0x1fa)]===_0x4c57ab['PL_BLOCK']&&_0x394018['includes'](_0x100111[_0x462a19(0x25e)])),_0x2a8fee=_0x3112e2=>{const _0x178b84=_0x462a19,_0x3dc878=_0x3ba0f0[_0x178b84(0x20c)](_0x438aa1=>_0x438aa1[_0x178b84(0x23f)]===_0x3112e2),_0x4fe550=_0x3dc878[_0x178b84(0x223)];let _0x442029=0x0;switch(_0x3112e2){case 0x1:_0x442029=_0x4fe550*(_0x238066+0.15);break;case 0x2:_0x442029=_0x4fe550*_0x238066;break;case 0x3:case 0x4:case 0x5:_0x442029=_0x4fe550*(_0x238066-0.1);break;case 0x7:_0x442029=_0x4fe550*(_0x238066+0.15);break;case 0x6:const _0x16c9bc=_0x3dc878[_0x178b84(0x23b)]((_0x22f673,_0x30a448)=>_0x22f673+(_0x30a448['BL_NUNIT']||0x0),0x0);_0x442029=_0x16c9bc*0x2;return{'count':_0x4fe550,'rooms':_0x16c9bc,'population':_0x442029};case 0x8:case 0x62:_0x442029=_0x4fe550*_0x238066*0x2;break;}return{'count':_0x4fe550,'population':_0x442029};},_0x51c2a8={'singleHouse':_0x2a8fee(0x1),'duplexHouse':_0x2a8fee(0x2),'townhouse':_0x2a8fee(0x3),'shophouse':_0x2a8fee(0x4),'commercial':_0x2a8fee(0x5),'houseboat':_0x2a8fee(0x7),'apartment':_0x2a8fee(0x6),'others':{'count':_0x3ba0f0[_0x462a19(0x20c)](_0x218c84=>[0x8,0x62][_0x462a19(0x1fc)](_0x218c84['BL_TYPE']))[_0x462a19(0x223)],'population':_0x3ba0f0[_0x462a19(0x20c)](_0x2739a3=>[0x8,0x62][_0x462a19(0x1fc)](_0x2739a3[_0x462a19(0x23f)]))[_0x462a19(0x223)]*_0x238066*0x2}},_0x218752=Object[_0x462a19(0x267)](_0x51c2a8)['reduce']((_0x56a5d2,_0x548fda)=>_0x56a5d2+_0x548fda[_0x462a19(0x212)],0x0),_0x4eaf54=Object[_0x462a19(0x267)](_0x51c2a8)[_0x462a19(0x23b)]((_0xbc295d,_0x5108c2)=>_0xbc295d+_0x5108c2[_0x462a19(0x1f4)],0x0),_0x5d296f=_0x4eaf54/_0x4c57ab[_0x462a19(0x22b)];return{'plBlock':_0x4c57ab[_0x462a19(0x1fa)],'stats':_0x51c2a8,'totalBuildings':_0x218752,'totalPopulation':_0x4eaf54,'area':_0x4c57ab[_0x462a19(0x22b)],'density':_0x5d296f};});_0x5e0752[_0x1fc053(0x1fb)]((_0x25c150,_0x4edb49)=>{const _0x4dca4b=_0x1fc053,_0x4a6bab=_0x1e795f['insertRow']();_0x4a6bab['className']=_0x4edb49%0x2===0x0?'even-row':'odd-row',_0x4a6bab[_0x4dca4b(0x251)]()['textContent']=_0x25c150['plBlock'],_0x4a6bab['insertCell']()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)][_0x4dca4b(0x268)][_0x4dca4b(0x212)],_0x4a6bab[_0x4dca4b(0x251)]()['textContent']=_0x25c150[_0x4dca4b(0x231)]['singleHouse'][_0x4dca4b(0x1f4)]['toFixed'](0x2),_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150['stats'][_0x4dca4b(0x218)]['count'],_0x4a6bab['insertCell']()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)]['duplexHouse'][_0x4dca4b(0x1f4)][_0x4dca4b(0x24a)](0x2),_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150['stats'][_0x4dca4b(0x25b)][_0x4dca4b(0x212)],_0x4a6bab[_0x4dca4b(0x251)]()['textContent']=_0x25c150[_0x4dca4b(0x231)][_0x4dca4b(0x25b)]['population'][_0x4dca4b(0x24a)](0x2),_0x4a6bab['insertCell']()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)][_0x4dca4b(0x203)]['count'],_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)][_0x4dca4b(0x203)]['population']['toFixed'](0x2),_0x4a6bab['insertCell']()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)]['commercial'][_0x4dca4b(0x212)],_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150['stats'][_0x4dca4b(0x23e)][_0x4dca4b(0x1f4)][_0x4dca4b(0x24a)](0x2),_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)][_0x4dca4b(0x216)][_0x4dca4b(0x212)],_0x4a6bab['insertCell']()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)][_0x4dca4b(0x216)][_0x4dca4b(0x1f4)]['toFixed'](0x2),_0x4a6bab['insertCell']()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)][_0x4dca4b(0x1fd)][_0x4dca4b(0x212)],_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150['stats'][_0x4dca4b(0x1fd)][_0x4dca4b(0x257)]||0x0,_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)][_0x4dca4b(0x1fd)][_0x4dca4b(0x1f4)][_0x4dca4b(0x24a)](0x2),_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x231)]['others'][_0x4dca4b(0x212)],_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150['stats'][_0x4dca4b(0x26f)][_0x4dca4b(0x1f4)][_0x4dca4b(0x24a)](0x2),_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x232)],_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x20f)][_0x4dca4b(0x24a)](0x2),_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150['area'][_0x4dca4b(0x24a)](0x2),_0x4a6bab[_0x4dca4b(0x251)]()[_0x4dca4b(0x228)]=_0x25c150[_0x4dca4b(0x242)][_0x4dca4b(0x24a)](0x2);}),addTotalRow(_0x5e0752);}function _0x4060(){const _0x9a8c7a=['ส่งออกข้อมูลสำเร็จ','success','stats','totalBuildings','ข้อมูลประชากร','sheet_to_json','files','utils','จำนวนอาคาร\x20(ทาวน์เฮาส์)','aoa_to_sheet','plluFile','className','reduce','.xlsx','#,##0.00','commercial','BL_TYPE','990418FDfnLX','จำนวนอาคารรวม','density','getElementsByTagName','445167TUOZfg','Error\x20exporting\x20to\x20Excel:','ประมวลผลข้อมูลสำเร็จ','querySelector','wch','Sheets','toFixed','จำนวนอาคาร\x20(อื่นๆ)','map','plluFilter','ความหนาแน่นประชากร(คน/ไร่)','total-row','ประชากร\x20(ห้องแถว)','insertCell','cells','onload','1872HkjpXc','addEventListener','none','rooms','จำนวนอาคาร\x20(เรือนแพ)','อัพโหลดไฟล์\x20PLLU\x20สำเร็จ','getElementById','townhouse','10rzoNJT','เกิดข้อผิดพลาดในการอ่านไฟล์\x20PLLU','BL_USE','จำนวนอาคาร\x20(อาคารพักอาศัย)','อัพโหลดไฟล์อาคารสำเร็จ','status-message\x20','ประชากร\x20(เรือนแพ)','จำนวนอาคาร\x20(ห้องแถว)','resultTable','.export-button','buildingFile','values','singleHouse','รวม','2514924iHprVY','key','style','<option\x20value=\x22all\x22>ทั้งหมด</option>','display','others','householdSize','block','ประชากร\x20(อาคารพักอาศัย)','population','toISOString','265070rMxxEq','area','เกิดข้อผิดพลาดในการประมวลผลข้อมูล','push','PL_BLOCK','forEach','includes','apartment','value','rows','book_new','การใช้ประโยชน์ที่ดินบริเวณหมายเลข','กรุณากรอกขนาดครัวเรือนเฉลี่ยให้ถูกต้อง','shophouse','ประชากร\x20(บ้านแฝด)','onerror','ประชากร\x20(อื่นๆ)','24318rmJGCL','จำนวนห้อง\x20(อาคารพักอาศัย)','all','พื้นที่ทั้งหมด(ไร่)','split','filter','กรุณาอัพโหลดไฟล์ให้ครบถ้วน','book_append_sheet','totalPopulation','635190tQYZQw','13795YFZonH','count','insertRow','ประชากรรวม','728zrqCBc','houseboat','tableContainer','duplexHouse','result','encode_cell','ประชากร\x20(บ้านเดี่ยว)','tbody','innerHTML','ประชากร\x20(ทาวน์เฮาส์)','<option\x20value=\x22','change','20TXUDJA','เกิดข้อผิดพลาดในการอ่านไฟล์อาคาร','length','error','จำนวนอาคาร\x20(ตึกแถว)','276VYjfDh','buildings','textContent','เกิดข้อผิดพลาดในการส่งออกข้อมูล','ประชากร\x20(ตึกแถว)','AREA(rai)','statusMessage','population_calculation_','target'];_0x4060=function(){return _0x9a8c7a;};return _0x4060();}function addTotalRow(_0x18ebb6){const _0x3d0688=_0x734ceb,_0x84d41b=document[_0x3d0688(0x25a)](_0x3d0688(0x264))[_0x3d0688(0x243)]('tbody')[0x0],_0x100074=_0x84d41b[_0x3d0688(0x213)]();_0x100074['className']=_0x3d0688(0x24f),_0x100074['insertCell']()[_0x3d0688(0x228)]=_0x3d0688(0x269);const _0x382c4a={'singleHouse':{'count':0x0,'population':0x0},'duplexHouse':{'count':0x0,'population':0x0},'townhouse':{'count':0x0,'population':0x0},'shophouse':{'count':0x0,'population':0x0},'commercial':{'count':0x0,'population':0x0},'houseboat':{'count':0x0,'population':0x0},'apartment':{'count':0x0,'rooms':0x0,'population':0x0},'others':{'count':0x0,'population':0x0},'buildings':0x0,'population':0x0,'area':0x0};_0x18ebb6[_0x3d0688(0x1fb)](_0x4ed251=>{const _0x59a98f=_0x3d0688;_0x382c4a['singleHouse'][_0x59a98f(0x212)]+=_0x4ed251[_0x59a98f(0x231)]['singleHouse']['count'],_0x382c4a[_0x59a98f(0x268)][_0x59a98f(0x1f4)]+=_0x4ed251[_0x59a98f(0x231)][_0x59a98f(0x268)]['population'],_0x382c4a[_0x59a98f(0x218)][_0x59a98f(0x212)]+=_0x4ed251[_0x59a98f(0x231)][_0x59a98f(0x218)][_0x59a98f(0x212)],_0x382c4a[_0x59a98f(0x218)][_0x59a98f(0x1f4)]+=_0x4ed251[_0x59a98f(0x231)]['duplexHouse'][_0x59a98f(0x1f4)],_0x382c4a[_0x59a98f(0x25b)]['count']+=_0x4ed251[_0x59a98f(0x231)]['townhouse'][_0x59a98f(0x212)],_0x382c4a[_0x59a98f(0x25b)][_0x59a98f(0x1f4)]+=_0x4ed251[_0x59a98f(0x231)][_0x59a98f(0x25b)][_0x59a98f(0x1f4)],_0x382c4a[_0x59a98f(0x203)][_0x59a98f(0x212)]+=_0x4ed251[_0x59a98f(0x231)][_0x59a98f(0x203)]['count'],_0x382c4a[_0x59a98f(0x203)][_0x59a98f(0x1f4)]+=_0x4ed251[_0x59a98f(0x231)][_0x59a98f(0x203)]['population'],_0x382c4a['commercial'][_0x59a98f(0x212)]+=_0x4ed251[_0x59a98f(0x231)]['commercial'][_0x59a98f(0x212)],_0x382c4a['commercial'][_0x59a98f(0x1f4)]+=_0x4ed251['stats'][_0x59a98f(0x23e)][_0x59a98f(0x1f4)],_0x382c4a[_0x59a98f(0x216)]['count']+=_0x4ed251[_0x59a98f(0x231)][_0x59a98f(0x216)]['count'],_0x382c4a['houseboat']['population']+=_0x4ed251['stats'][_0x59a98f(0x216)]['population'],_0x382c4a[_0x59a98f(0x1fd)][_0x59a98f(0x212)]+=_0x4ed251[_0x59a98f(0x231)][_0x59a98f(0x1fd)][_0x59a98f(0x212)],_0x382c4a[_0x59a98f(0x1fd)][_0x59a98f(0x257)]+=_0x4ed251[_0x59a98f(0x231)][_0x59a98f(0x1fd)][_0x59a98f(0x257)]||0x0,_0x382c4a[_0x59a98f(0x1fd)]['population']+=_0x4ed251[_0x59a98f(0x231)]['apartment']['population'],_0x382c4a[_0x59a98f(0x26f)][_0x59a98f(0x212)]+=_0x4ed251['stats']['others'][_0x59a98f(0x212)],_0x382c4a[_0x59a98f(0x26f)][_0x59a98f(0x1f4)]+=_0x4ed251[_0x59a98f(0x231)]['others']['population'],_0x382c4a['buildings']+=_0x4ed251[_0x59a98f(0x232)],_0x382c4a[_0x59a98f(0x1f4)]+=_0x4ed251[_0x59a98f(0x20f)],_0x382c4a[_0x59a98f(0x1f7)]+=_0x4ed251[_0x59a98f(0x1f7)];}),_0x100074['insertCell']()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x268)][_0x3d0688(0x212)],_0x100074[_0x3d0688(0x251)]()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x268)][_0x3d0688(0x1f4)][_0x3d0688(0x24a)](0x2),_0x100074['insertCell']()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x218)][_0x3d0688(0x212)],_0x100074[_0x3d0688(0x251)]()[_0x3d0688(0x228)]=_0x382c4a['duplexHouse'][_0x3d0688(0x1f4)]['toFixed'](0x2),_0x100074[_0x3d0688(0x251)]()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x25b)][_0x3d0688(0x212)],_0x100074['insertCell']()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x25b)][_0x3d0688(0x1f4)][_0x3d0688(0x24a)](0x2),_0x100074[_0x3d0688(0x251)]()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x203)][_0x3d0688(0x212)],_0x100074['insertCell']()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x203)][_0x3d0688(0x1f4)][_0x3d0688(0x24a)](0x2),_0x100074[_0x3d0688(0x251)]()['textContent']=_0x382c4a['commercial']['count'],_0x100074['insertCell']()['textContent']=_0x382c4a[_0x3d0688(0x23e)][_0x3d0688(0x1f4)][_0x3d0688(0x24a)](0x2),_0x100074[_0x3d0688(0x251)]()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x216)]['count'],_0x100074[_0x3d0688(0x251)]()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x216)]['population'][_0x3d0688(0x24a)](0x2),_0x100074[_0x3d0688(0x251)]()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x1fd)]['count'],_0x100074[_0x3d0688(0x251)]()[_0x3d0688(0x228)]=_0x382c4a['apartment'][_0x3d0688(0x257)],_0x100074['insertCell']()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x1fd)][_0x3d0688(0x1f4)][_0x3d0688(0x24a)](0x2),_0x100074[_0x3d0688(0x251)]()['textContent']=_0x382c4a[_0x3d0688(0x26f)]['count'],_0x100074[_0x3d0688(0x251)]()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x26f)][_0x3d0688(0x1f4)][_0x3d0688(0x24a)](0x2),_0x100074['insertCell']()[_0x3d0688(0x228)]=_0x382c4a[_0x3d0688(0x227)],_0x100074[_0x3d0688(0x251)]()['textContent']=_0x382c4a[_0x3d0688(0x1f4)][_0x3d0688(0x24a)](0x2),_0x100074[_0x3d0688(0x251)]()['textContent']=_0x382c4a[_0x3d0688(0x1f7)][_0x3d0688(0x24a)](0x2);const _0x4fffa0=_0x382c4a[_0x3d0688(0x1f4)]/_0x382c4a['area'];_0x100074['insertCell']()[_0x3d0688(0x228)]=_0x4fffa0[_0x3d0688(0x24a)](0x2);}function exportToExcel(){const _0x20ff36=_0x734ceb;try{const _0x2dc345=document[_0x20ff36(0x25a)]('resultTable'),_0x1a4093=[],_0x4b1c18=[_0x20ff36(0x201),'จำนวนอาคาร\x20(บ้านเดี่ยว)',_0x20ff36(0x21b),'จำนวนอาคาร\x20(บ้านแฝด)',_0x20ff36(0x204),_0x20ff36(0x237),_0x20ff36(0x21e),_0x20ff36(0x263),_0x20ff36(0x250),_0x20ff36(0x225),_0x20ff36(0x22a),_0x20ff36(0x258),_0x20ff36(0x262),_0x20ff36(0x25f),_0x20ff36(0x208),_0x20ff36(0x1f3),_0x20ff36(0x24b),_0x20ff36(0x206),_0x20ff36(0x241),_0x20ff36(0x214),_0x20ff36(0x20a),_0x20ff36(0x24e)];_0x1a4093[_0x20ff36(0x1f9)](_0x4b1c18);for(let _0x5dfc09=0x0;_0x5dfc09<_0x2dc345[_0x20ff36(0x1ff)][_0x20ff36(0x223)];_0x5dfc09++){const _0x313958=_0x2dc345[_0x20ff36(0x1ff)][_0x5dfc09];if(_0x5dfc09>0x1){const _0x5bb6ca=[];for(let _0x385321=0x0;_0x385321<_0x313958[_0x20ff36(0x252)]['length'];_0x385321++){const _0x436f67=_0x313958['cells'][_0x385321][_0x20ff36(0x228)];_0x5bb6ca['push'](_0x385321===0x0?_0x436f67:isNaN(_0x436f67)?_0x436f67:Number(_0x436f67));}_0x1a4093['push'](_0x5bb6ca);}}const _0x12596d=XLSX['utils'][_0x20ff36(0x200)](),_0x409526=XLSX[_0x20ff36(0x236)][_0x20ff36(0x238)](_0x1a4093),_0x543004=_0x4b1c18[_0x20ff36(0x24c)](()=>({'wch':0xf}));_0x543004[0x0][_0x20ff36(0x248)]=0x19,_0x409526['!cols']=_0x543004;for(let _0x1574b5=0x1;_0x1574b5<_0x1a4093['length'];_0x1574b5++){for(let _0x47d898=0x1;_0x47d898<_0x1a4093[_0x1574b5]['length'];_0x47d898++){const _0x469867=XLSX[_0x20ff36(0x236)][_0x20ff36(0x21a)]({'r':_0x1574b5,'c':_0x47d898});if(!_0x409526[_0x469867])continue;!isNaN(_0x409526[_0x469867]['v'])&&(_0x409526[_0x469867]['t']='n',_0x47d898===_0x1a4093[_0x1574b5]['length']-0x1||_0x47d898%0x2===0x1?_0x409526[_0x469867]['z']=_0x20ff36(0x23d):_0x409526[_0x469867]['z']=_0x20ff36(0x23d));}}XLSX[_0x20ff36(0x236)][_0x20ff36(0x20e)](_0x12596d,_0x409526,_0x20ff36(0x233));const _0x1230ed=_0x20ff36(0x22d)+new Date()[_0x20ff36(0x1f5)]()[_0x20ff36(0x20b)]('T')[0x0]+_0x20ff36(0x23c);XLSX['writeFile'](_0x12596d,_0x1230ed),showStatus(_0x20ff36(0x22f),_0x20ff36(0x230));}catch(_0x516e84){console[_0x20ff36(0x224)](_0x20ff36(0x245),_0x516e84),handleError(_0x516e84,_0x20ff36(0x229));}}
    </script>
</body>
</html>            