<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบคำนวณประชากร</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .input-section {
            margin-bottom: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        input[type="file"],
        input[type="number"],
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 5px;
        }

        input[type="number"] {
            width: 200px;
        }

        .table-container {
            overflow-x: auto;
            display: none;
            margin-top: 20px;
            background-color: #fff;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
            font-size: 14px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px 8px;
            text-align: center;
        }

        th {
            background-color: #f8f9fa;
            color: #333;
            font-weight: bold;
            white-space: nowrap;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tr:nth-child(odd) {
            background-color: #ffffff;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .total-row {
            background-color: #e9ecef !important;
            font-weight: bold;
        }

        .filter-section {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .button-container {
            margin: 20px 0;
            text-align: center;
        }

        .button {
            padding: 12px 24px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .process-button {
            background-color: #007bff;
            color: white;
        }

        .process-button:hover {
            background-color: #0056b3;
        }

        .export-button {
            background-color: #28a745;
            color: white;
        }

        .export-button:hover {
            background-color: #218838;
        }

        .status-message {
            margin: 10px 0;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
            display: none;
        }

        .error {
            background-color: #fff3f3;
            color: #dc3545;
            border: 1px solid #f5c6cb;
        }

        .success {
            background-color: #f0fff0;
            color: #28a745;
            border: 1px solid #c3e6cb;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 6px 4px;
            }

            .button {
                width: 100%;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ระบบคำนวณประชากร</h1>
        
        <div class="input-section">
            <div class="input-group">
                <label for="buildingFile">ไฟล์อาคาร (Excel):</label>
                <input type="file" id="buildingFile" accept=".xlsx,.xls">
            </div>
            
            <div class="input-group">
                <label for="plluFile">ไฟล์ PLLU (Excel):</label>
                <input type="file" id="plluFile" accept=".xlsx,.xls">
            </div>
            
            <div class="input-group">
                <label for="householdSize">ขนาดครัวเรือนเฉลี่ย:</label>
                <input type="number" id="householdSize" step="0.01" value="3.0">
            </div>

            <div class="filter-section">
                <label for="plluFilter">กรองตาม PL_USE:</label>
                <select id="plluFilter">
                    <option value="all">ทั้งหมด</option>
                </select>
            </div>
        </div>

        <div id="statusMessage" class="status-message"></div>

        <div class="button-container">
            <button class="button process-button" onclick="processData()">ประมวลผล</button>
            <button class="button export-button" onclick="exportToExcel()" style="display: none;">Export to Excel</button>
        </div>

        <div class="table-container" id="tableContainer">
            <table id="resultTable">
                <thead>
                    <tr>
                        <th rowspan="2">การใช้ประโยชน์ที่ดินบริเวณหมายเลข</th>
                        <th colspan="2">บ้านเดี่ยว/อาคารเดี่ยว</th>
                        <th colspan="2">บ้านแฝด</th>
                        <th colspan="2">ทาวน์เฮาส์</th>
                        <th colspan="2">ห้องแถว</th>
                        <th colspan="2">ตึกแถว</th>
                        <th colspan="2">เรือนแพ</th>
                        <th colspan="3">อาคารพักอาศัย</th>
                        <th colspan="2">อื่นๆ</th>
                        <th rowspan="2">จำนวนอาคารรวม</th>
                        <th rowspan="2">ประชากรรวม</th>
                        <th rowspan="2">พื้นที่ทั้งหมด(ไร่)</th>
                        <th rowspan="2">ความหนาแน่นประชากร(คน/ไร่)</th>
                    </tr>
                    <tr>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>จำนวนห้อง</th>
                        <th>ประชากร</th>
                        <th>จำนวนอาคาร</th>
                        <th>ประชากร</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script>
const _0x496db5=_0x1078;(function(_0x3133fe,_0x21f435){const _0x2cd2f3=_0x1078,_0x5264d2=_0x3133fe();while(!![]){try{const _0x88a49d=-parseInt(_0x2cd2f3(0xf1))/0x1*(-parseInt(_0x2cd2f3(0xcd))/0x2)+-parseInt(_0x2cd2f3(0x13c))/0x3*(-parseInt(_0x2cd2f3(0x11e))/0x4)+-parseInt(_0x2cd2f3(0x140))/0x5*(parseInt(_0x2cd2f3(0xd9))/0x6)+-parseInt(_0x2cd2f3(0xf2))/0x7+parseInt(_0x2cd2f3(0x107))/0x8*(parseInt(_0x2cd2f3(0xc5))/0x9)+-parseInt(_0x2cd2f3(0xdb))/0xa+parseInt(_0x2cd2f3(0x105))/0xb*(-parseInt(_0x2cd2f3(0x113))/0xc);if(_0x88a49d===_0x21f435)break;else _0x5264d2['push'](_0x5264d2['shift']());}catch(_0x2443fd){_0x5264d2['push'](_0x5264d2['shift']());}}}(_0x1aab,0x82969));let buildingData=[],plluData=[],filteredData=[];document[_0x496db5(0xf3)]('buildingFile')[_0x496db5(0x128)](_0x496db5(0x136),handleBuildingFile),document[_0x496db5(0xf3)](_0x496db5(0x112))['addEventListener'](_0x496db5(0x136),handlePlluFile),document[_0x496db5(0xf3)](_0x496db5(0x146))[_0x496db5(0x128)](_0x496db5(0x136),filterData),document[_0x496db5(0xf3)]('householdSize')['addEventListener'](_0x496db5(0x125),function(_0x4c8a1f){const _0x49591c=_0x496db5;_0x4c8a1f[_0x49591c(0x122)]===_0x49591c(0xd2)&&processData();});function normalizeBuildingType(_0x10f226){const _0x310690=_0x496db5,_0x443ac2=String(_0x10f226)[_0x310690(0xf4)](),_0x559196={'1':0x1,'บ้านเดี่ยว':0x1,'2':0x2,'บ้านแฝด':0x2,'3':0x3,'ทาวน์เฮาส์':0x3,'4':0x4,'ห้องแถว':0x4,'5':0x5,'ตึกแถว':0x5,'6':0x6,'อาคารพักอาศัย':0x6,'7':0x7,'เรือนแพ':0x7,'8':0x8,'อื่นๆ':0x8,'98':0x62};return _0x559196[_0x443ac2]||null;}function formatNumber(_0x7467ae,_0x2ee964=0x0){const _0x17af61=_0x496db5;return _0x7467ae[_0x17af61(0xfa)](_0x17af61(0x12f),{'minimumFractionDigits':_0x2ee964,'maximumFractionDigits':_0x2ee964});}async function handleBuildingFile(_0x4ff65e){const _0x47f26d=_0x496db5;try{const _0x5e1b6a=_0x4ff65e['target'][_0x47f26d(0xc3)][0x0];buildingData=await readExcelFile(_0x5e1b6a),showStatus(_0x47f26d(0xd1),_0x47f26d(0xeb));}catch(_0x522fd1){handleError(_0x522fd1,'เกิดข้อผิดพลาดในการอ่านไฟล์อาคาร');}}async function handlePlluFile(_0x23cddd){const _0x37f1fc=_0x496db5;try{const _0x37b51d=_0x23cddd[_0x37f1fc(0x141)]['files'][0x0];plluData=await readExcelFile(_0x37b51d),updatePlluFilter(),showStatus(_0x37f1fc(0xee),_0x37f1fc(0xeb));}catch(_0x47ef3a){handleError(_0x47ef3a,_0x37f1fc(0xde));}}async function readExcelFile(_0x1ca3a2){return new Promise((_0x20759a,_0x4e2709)=>{const _0x567d77=_0x1078,_0x1c53ca=new FileReader();_0x1c53ca[_0x567d77(0x111)]=_0x3cb7f8=>{const _0x880cb2=_0x567d77;try{const _0x4487e2=_0x3cb7f8[_0x880cb2(0x141)]['result'],_0x114078=XLSX[_0x880cb2(0xbc)](_0x4487e2,{'type':_0x880cb2(0x13f)}),_0x5b9729=_0x114078[_0x880cb2(0xec)][0x0],_0x108b9d=_0x114078[_0x880cb2(0x114)][_0x5b9729],_0x4eaeec=XLSX[_0x880cb2(0x10f)]['sheet_to_json'](_0x108b9d);_0x20759a(_0x4eaeec);}catch(_0x3c6efa){_0x4e2709(_0x3c6efa);}},_0x1c53ca[_0x567d77(0x124)]=_0x4e2709,_0x1c53ca[_0x567d77(0x145)](_0x1ca3a2);});}function updatePlluFilter(){const _0x1d3c61=_0x496db5,_0xa818df=document[_0x1d3c61(0xf3)](_0x1d3c61(0x146)),_0x58bada=new Set(plluData[_0x1d3c61(0xc7)](_0x3764c5=>String(_0x3764c5[_0x1d3c61(0x11d)])[_0x1d3c61(0xf4)]()));_0xa818df['innerHTML']='<option\x20value=\x22all\x22>ทั้งหมด</option>',[..._0x58bada]['sort']()['forEach'](_0x5e7b24=>{const _0x37791d=_0x1d3c61;_0xa818df['innerHTML']+=_0x37791d(0xd6)+_0x5e7b24+'\x22>'+_0x5e7b24+_0x37791d(0x13e);});}function filterData(){const _0x26d73f=_0x496db5,_0x278d83=document[_0x26d73f(0xf3)](_0x26d73f(0x146))[_0x26d73f(0x119)];filteredData=_0x278d83===_0x26d73f(0x13a)?[...plluData]:plluData[_0x26d73f(0x143)](_0x255b06=>String(_0x255b06[_0x26d73f(0x11d)])[_0x26d73f(0xf4)]()===_0x278d83),buildingData[_0x26d73f(0xdd)]>0x0&&plluData[_0x26d73f(0xdd)]>0x0&&processData();}function _0x1aab(){const _0x124916=['rooms','4110','1100','others','replace','cells','ข้อมูลประชากร','11VSmClX','commercial','112XDtVqm','จำนวนห้อง\x20(อาคารพักอาศัย)','ประชากร\x20(ตึกแถว)','1102','area','จำนวนอาคาร\x20(อื่นๆ)','style','block','utils','split','onload','plluFile','2283504lGaTgT','Sheets','totalArea','houseboat','ประชากร\x20(เรือนแพ)','apartment','value','จำนวนอาคาร\x20(อาคารพักอาศัย)','1340','จำนวนอาคาร\x20(ตึกแถว)','PL_USE','2188mhsytI','ประชากร\x20(อาคารพักอาศัย)','ประชากร\x20(ทาวน์เฮาส์)','ความหนาแน่นประชากร(คน/ไร่)','key','4122','onerror','keypress','เกิดข้อผิดพลาดในการคำนวณข้อมูล','duplexHouse','addEventListener','reduce','population','1132','display','total-row','toISOString','th-TH','4100','townhouse','insertCell','status-message\x20','1310','1131','change','forEach','1330','4121','all','insertRow','5811lxyvvn','.xlsx','</option>','binary','1358865qJQsUr','target','resultTable','filter','writeFile','readAsBinaryString','plluFilter','รวม','book_append_sheet','shophouse','none','totalPopulation','1350','includes','read','AREA(rai)','ประชากร\x20(ห้องแถว)','1000','ประชากร\x20(บ้านแฝด)','BL_NUNIT','householdSize','files','count','138861IMVMLO','statusMessage','map','กรุณากรอกขนาดครัวเรือนเฉลี่ยให้ถูกต้อง','1200','1101','4300','population_calculation_','582OPzNIc','querySelector','plBlock','values','อัพโหลดไฟล์อาคารสำเร็จ','Enter','even-row','จำนวนอาคาร\x20(บ้านแฝด)','error','<option\x20value=\x22','เกิดข้อผิดพลาดในการส่งออกข้อมูล','inline-block','6xIrpWf','wch','5865260Dlxbmp','4120','length','เกิดข้อผิดพลาดในการอ่านไฟล์\x20PLLU','ประมวลผลข้อมูลสำเร็จ','className','พื้นที่ทั้งหมด(ไร่)','textContent','stats','ส่งออกข้อมูลสำเร็จ','PL_BLOCK','getElementsByTagName','push','innerHTML','.export-button','จำนวนอาคาร\x20(บ้านเดี่ยว)','success','SheetNames','BL_TYPE','อัพโหลดไฟล์\x20PLLU\x20สำเร็จ','singleHouse','1320','1205bFmAOB','299040APUvuC','getElementById','trim','BL_USE','1123','tbody','rows','4180','toLocaleString','totalBuildings','ประชากรรวม','จำนวนอาคาร\x20(เรือนแพ)'];_0x1aab=function(){return _0x124916;};return _0x1aab();}function _0x1078(_0x1f583f,_0x49dac1){const _0x1aab7e=_0x1aab();return _0x1078=function(_0x1078a2,_0x5de4f1){_0x1078a2=_0x1078a2-0xbc;let _0x27c18d=_0x1aab7e[_0x1078a2];return _0x27c18d;},_0x1078(_0x1f583f,_0x49dac1);}function showStatus(_0x5cb97e,_0x51b034){const _0x13454f=_0x496db5,_0x572db9=document[_0x13454f(0xf3)](_0x13454f(0xc6));_0x572db9[_0x13454f(0xe2)]=_0x5cb97e,_0x572db9['className']=_0x13454f(0x133)+_0x51b034,_0x572db9[_0x13454f(0x10d)][_0x13454f(0x12c)]=_0x13454f(0x10e),setTimeout(()=>{const _0x40923c=_0x13454f;_0x572db9[_0x40923c(0x10d)][_0x40923c(0x12c)]=_0x40923c(0x14a);},0xbb8);}function handleError(_0x379b9f,_0x22aa9b){const _0x3e87db=_0x496db5;console[_0x3e87db(0xd5)](_0x379b9f),showStatus(_0x22aa9b,_0x3e87db(0xd5));}function processData(){const _0xd5aa3b=_0x496db5;try{if(!buildingData[_0xd5aa3b(0xdd)]||!plluData[_0xd5aa3b(0xdd)]){showStatus('กรุณาอัพโหลดไฟล์ให้ครบถ้วน',_0xd5aa3b(0xd5));return;}const _0x789284=parseFloat(document[_0xd5aa3b(0xf3)](_0xd5aa3b(0xc2))['value']);if(!_0x789284||_0x789284<=0x0){showStatus(_0xd5aa3b(0xc8),'error');return;}!filteredData[_0xd5aa3b(0xdd)]&&(filteredData=[...plluData]),calculatePopulation(),document[_0xd5aa3b(0xf3)]('tableContainer')[_0xd5aa3b(0x10d)]['display']=_0xd5aa3b(0x10e),document[_0xd5aa3b(0xce)](_0xd5aa3b(0xe9))[_0xd5aa3b(0x10d)][_0xd5aa3b(0x12c)]=_0xd5aa3b(0xd8),showStatus(_0xd5aa3b(0xdf),_0xd5aa3b(0xeb));}catch(_0xd4ae26){handleError(_0xd4ae26,'เกิดข้อผิดพลาดในการประมวลผลข้อมูล');}}function calculatePopulation(){const _0x23d0a3=_0x496db5;try{const _0x101c18=parseFloat(document['getElementById'](_0x23d0a3(0xc2))[_0x23d0a3(0x119)]),_0x5545bd=document['getElementById']('resultTable')[_0x23d0a3(0xe6)](_0x23d0a3(0xf7))[0x0];_0x5545bd[_0x23d0a3(0xe8)]='';const _0x15a071=[_0x23d0a3(0xbf),_0x23d0a3(0x100),_0x23d0a3(0xca),_0x23d0a3(0x10a),'1103','1121','1122',_0x23d0a3(0xf6),_0x23d0a3(0x135),_0x23d0a3(0x12b),_0x23d0a3(0xc9),'1300',_0x23d0a3(0x134),_0x23d0a3(0xf0),_0x23d0a3(0x138),_0x23d0a3(0x11b),_0x23d0a3(0x14c),_0x23d0a3(0x130),_0x23d0a3(0xff),_0x23d0a3(0xdc),_0x23d0a3(0x139),_0x23d0a3(0x123),'4123',_0x23d0a3(0xf9),_0x23d0a3(0xcb)],_0x3831fd=filteredData[_0x23d0a3(0xc7)](_0x31b4f7=>{const _0x305e2f=_0x23d0a3,_0x1b3bdb=buildingData['filter'](_0xf8d266=>String(_0xf8d266[_0x305e2f(0xe5)])['trim']()===String(_0x31b4f7[_0x305e2f(0xe5)])[_0x305e2f(0xf4)]()&&_0x15a071['includes'](String(_0xf8d266[_0x305e2f(0xf5)])[_0x305e2f(0xf4)]())),_0x5056a6=_0x2a63df=>{const _0x55d05e=_0x305e2f,_0xc9b3d7=_0x1b3bdb[_0x55d05e(0x143)](_0x406d47=>normalizeBuildingType(_0x406d47[_0x55d05e(0xed)])===_0x2a63df),_0x5e3c7c=_0xc9b3d7[_0x55d05e(0xdd)];let _0x3d346f=0x0;switch(_0x2a63df){case 0x1:_0x3d346f=_0x5e3c7c*(_0x101c18+0.15);break;case 0x2:_0x3d346f=_0x5e3c7c*_0x101c18;break;case 0x3:case 0x4:case 0x5:_0x3d346f=_0x5e3c7c*(_0x101c18-0.1);break;case 0x6:const _0x113ff8=_0xc9b3d7[_0x55d05e(0x129)]((_0x4d77d3,_0x2c3274)=>_0x4d77d3+(parseFloat(_0x2c3274[_0x55d05e(0xc1)])||0x0),0x0);_0x3d346f=_0x113ff8*0x2;return{'count':_0x5e3c7c,'rooms':_0x113ff8,'population':_0x3d346f};case 0x7:_0x3d346f=_0x5e3c7c*(_0x101c18+0.15);break;case 0x8:case 0x62:_0x3d346f=_0x5e3c7c*_0x101c18*0x2;break;}return{'count':_0x5e3c7c,'population':_0x3d346f};},_0x4dd4e7={'singleHouse':_0x5056a6(0x1),'duplexHouse':_0x5056a6(0x2),'townhouse':_0x5056a6(0x3),'shophouse':_0x5056a6(0x4),'commercial':_0x5056a6(0x5),'houseboat':_0x5056a6(0x7),'apartment':_0x5056a6(0x6),'others':{'count':_0x1b3bdb[_0x305e2f(0x143)](_0x2c8452=>[0x8,0x62][_0x305e2f(0x14d)](normalizeBuildingType(_0x2c8452[_0x305e2f(0xed)])))[_0x305e2f(0xdd)],'population':_0x1b3bdb[_0x305e2f(0x143)](_0x1c5d9b=>[0x8,0x62]['includes'](normalizeBuildingType(_0x1c5d9b[_0x305e2f(0xed)])))[_0x305e2f(0xdd)]*_0x101c18*0x2}},_0x5eb9e1=Object[_0x305e2f(0xd0)](_0x4dd4e7)[_0x305e2f(0x129)]((_0x5ed92,_0x3fa8a8)=>_0x5ed92+_0x3fa8a8['count'],0x0),_0x4c877d=Object['values'](_0x4dd4e7)[_0x305e2f(0x129)]((_0x9f024d,_0x1b87e6)=>_0x9f024d+_0x1b87e6[_0x305e2f(0x12a)],0x0),_0xa1546=parseFloat(_0x31b4f7[_0x305e2f(0xbd)])||0x0,_0x26c69e=_0xa1546>0x0?_0x4c877d/_0xa1546:0x0;return{'plBlock':_0x31b4f7[_0x305e2f(0xe5)],'stats':_0x4dd4e7,'totalBuildings':_0x5eb9e1,'totalPopulation':_0x4c877d,'area':_0xa1546,'density':_0x26c69e};});_0x3831fd[_0x23d0a3(0x137)]((_0x293a87,_0x68daa6)=>{const _0x35a7af=_0x23d0a3,_0x5105bd=_0x5545bd[_0x35a7af(0x13b)]();_0x5105bd[_0x35a7af(0xe0)]=_0x68daa6%0x2===0x0?_0x35a7af(0xd3):'odd-row',_0x5105bd[_0x35a7af(0x132)]()['textContent']=_0x293a87[_0x35a7af(0xcf)],_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0xe3)][_0x35a7af(0xef)][_0x35a7af(0xc4)]),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0xe3)][_0x35a7af(0xef)]['population'],0x2),_0x5105bd['insertCell']()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0xe3)]['duplexHouse'][_0x35a7af(0xc4)]),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87['stats'][_0x35a7af(0x127)][_0x35a7af(0x12a)],0x2),_0x5105bd[_0x35a7af(0x132)]()['textContent']=formatNumber(_0x293a87[_0x35a7af(0xe3)][_0x35a7af(0x131)][_0x35a7af(0xc4)]),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87['stats'][_0x35a7af(0x131)][_0x35a7af(0x12a)],0x2),_0x5105bd['insertCell']()['textContent']=formatNumber(_0x293a87[_0x35a7af(0xe3)][_0x35a7af(0x149)][_0x35a7af(0xc4)]),_0x5105bd[_0x35a7af(0x132)]()['textContent']=formatNumber(_0x293a87[_0x35a7af(0xe3)]['shophouse'][_0x35a7af(0x12a)],0x2),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0xe3)]['commercial'][_0x35a7af(0xc4)]),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0xe3)]['commercial'][_0x35a7af(0x12a)],0x2),_0x5105bd['insertCell']()['textContent']=formatNumber(_0x293a87[_0x35a7af(0xe3)][_0x35a7af(0x116)][_0x35a7af(0xc4)]),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0xe3)][_0x35a7af(0x116)]['population'],0x2),_0x5105bd['insertCell']()[_0x35a7af(0xe2)]=formatNumber(_0x293a87['stats']['apartment'][_0x35a7af(0xc4)]),_0x5105bd['insertCell']()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0xe3)][_0x35a7af(0x118)]['rooms']||0x0),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87['stats']['apartment'][_0x35a7af(0x12a)],0x2),_0x5105bd['insertCell']()['textContent']=formatNumber(_0x293a87[_0x35a7af(0xe3)]['others'][_0x35a7af(0xc4)]),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0xe3)]['others'][_0x35a7af(0x12a)],0x2),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0xfb)]),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87[_0x35a7af(0x14b)],0x2),_0x5105bd[_0x35a7af(0x132)]()['textContent']=formatNumber(_0x293a87[_0x35a7af(0x10b)],0x2),_0x5105bd[_0x35a7af(0x132)]()[_0x35a7af(0xe2)]=formatNumber(_0x293a87['density'],0x2);}),addTotalRow(_0x3831fd);}catch(_0xbbfdd1){console[_0x23d0a3(0xd5)]('Error\x20in\x20calculatePopulation:',_0xbbfdd1),showStatus(_0x23d0a3(0x126),_0x23d0a3(0xd5));}}function addTotalRow(_0x5d14a3){const _0x5e6941=_0x496db5,_0x3c3036=document[_0x5e6941(0xf3)](_0x5e6941(0x142))[_0x5e6941(0xe6)](_0x5e6941(0xf7))[0x0],_0x4ed95d=_0x3c3036[_0x5e6941(0x13b)]();_0x4ed95d[_0x5e6941(0xe0)]=_0x5e6941(0x12d);const _0x3d1952=_0x5d14a3[_0x5e6941(0x129)]((_0xedae91,_0x1f69e6)=>({'singleHouse':{'count':_0xedae91[_0x5e6941(0xef)][_0x5e6941(0xc4)]+_0x1f69e6[_0x5e6941(0xe3)][_0x5e6941(0xef)]['count'],'population':_0xedae91['singleHouse'][_0x5e6941(0x12a)]+_0x1f69e6[_0x5e6941(0xe3)]['singleHouse']['population']},'duplexHouse':{'count':_0xedae91[_0x5e6941(0x127)]['count']+_0x1f69e6[_0x5e6941(0xe3)]['duplexHouse']['count'],'population':_0xedae91[_0x5e6941(0x127)][_0x5e6941(0x12a)]+_0x1f69e6[_0x5e6941(0xe3)]['duplexHouse'][_0x5e6941(0x12a)]},'townhouse':{'count':_0xedae91[_0x5e6941(0x131)][_0x5e6941(0xc4)]+_0x1f69e6[_0x5e6941(0xe3)][_0x5e6941(0x131)]['count'],'population':_0xedae91['townhouse'][_0x5e6941(0x12a)]+_0x1f69e6['stats'][_0x5e6941(0x131)]['population']},'shophouse':{'count':_0xedae91[_0x5e6941(0x149)][_0x5e6941(0xc4)]+_0x1f69e6[_0x5e6941(0xe3)][_0x5e6941(0x149)][_0x5e6941(0xc4)],'population':_0xedae91[_0x5e6941(0x149)][_0x5e6941(0x12a)]+_0x1f69e6[_0x5e6941(0xe3)][_0x5e6941(0x149)][_0x5e6941(0x12a)]},'commercial':{'count':_0xedae91['commercial'][_0x5e6941(0xc4)]+_0x1f69e6[_0x5e6941(0xe3)][_0x5e6941(0x106)][_0x5e6941(0xc4)],'population':_0xedae91[_0x5e6941(0x106)][_0x5e6941(0x12a)]+_0x1f69e6[_0x5e6941(0xe3)][_0x5e6941(0x106)][_0x5e6941(0x12a)]},'houseboat':{'count':_0xedae91['houseboat'][_0x5e6941(0xc4)]+_0x1f69e6['stats'][_0x5e6941(0x116)][_0x5e6941(0xc4)],'population':_0xedae91[_0x5e6941(0x116)][_0x5e6941(0x12a)]+_0x1f69e6[_0x5e6941(0xe3)][_0x5e6941(0x116)][_0x5e6941(0x12a)]},'apartment':{'count':_0xedae91['apartment'][_0x5e6941(0xc4)]+_0x1f69e6['stats'][_0x5e6941(0x118)][_0x5e6941(0xc4)],'rooms':_0xedae91[_0x5e6941(0x118)][_0x5e6941(0xfe)]+(_0x1f69e6['stats'][_0x5e6941(0x118)][_0x5e6941(0xfe)]||0x0),'population':_0xedae91[_0x5e6941(0x118)][_0x5e6941(0x12a)]+_0x1f69e6[_0x5e6941(0xe3)]['apartment'][_0x5e6941(0x12a)]},'others':{'count':_0xedae91['others'][_0x5e6941(0xc4)]+_0x1f69e6[_0x5e6941(0xe3)][_0x5e6941(0x101)][_0x5e6941(0xc4)],'population':_0xedae91[_0x5e6941(0x101)][_0x5e6941(0x12a)]+_0x1f69e6[_0x5e6941(0xe3)][_0x5e6941(0x101)][_0x5e6941(0x12a)]},'totalBuildings':_0xedae91[_0x5e6941(0xfb)]+_0x1f69e6[_0x5e6941(0xfb)],'totalPopulation':_0xedae91[_0x5e6941(0x14b)]+_0x1f69e6['totalPopulation'],'totalArea':_0xedae91['totalArea']+_0x1f69e6[_0x5e6941(0x10b)]}),{'singleHouse':{'count':0x0,'population':0x0},'duplexHouse':{'count':0x0,'population':0x0},'townhouse':{'count':0x0,'population':0x0},'shophouse':{'count':0x0,'population':0x0},'commercial':{'count':0x0,'population':0x0},'houseboat':{'count':0x0,'population':0x0},'apartment':{'count':0x0,'rooms':0x0,'population':0x0},'others':{'count':0x0,'population':0x0},'totalBuildings':0x0,'totalPopulation':0x0,'totalArea':0x0}),_0x506c49=[_0x5e6941(0x147),formatNumber(_0x3d1952[_0x5e6941(0xef)][_0x5e6941(0xc4)]),formatNumber(_0x3d1952[_0x5e6941(0xef)][_0x5e6941(0x12a)],0x2),formatNumber(_0x3d1952[_0x5e6941(0x127)][_0x5e6941(0xc4)]),formatNumber(_0x3d1952[_0x5e6941(0x127)][_0x5e6941(0x12a)],0x2),formatNumber(_0x3d1952[_0x5e6941(0x131)]['count']),formatNumber(_0x3d1952[_0x5e6941(0x131)][_0x5e6941(0x12a)],0x2),formatNumber(_0x3d1952[_0x5e6941(0x149)][_0x5e6941(0xc4)]),formatNumber(_0x3d1952[_0x5e6941(0x149)][_0x5e6941(0x12a)],0x2),formatNumber(_0x3d1952['commercial'][_0x5e6941(0xc4)]),formatNumber(_0x3d1952['commercial']['population'],0x2),formatNumber(_0x3d1952[_0x5e6941(0x116)][_0x5e6941(0xc4)]),formatNumber(_0x3d1952[_0x5e6941(0x116)][_0x5e6941(0x12a)],0x2),formatNumber(_0x3d1952[_0x5e6941(0x118)]['count']),formatNumber(_0x3d1952['apartment'][_0x5e6941(0xfe)]),formatNumber(_0x3d1952['apartment'][_0x5e6941(0x12a)],0x2),formatNumber(_0x3d1952['others'][_0x5e6941(0xc4)]),formatNumber(_0x3d1952[_0x5e6941(0x101)][_0x5e6941(0x12a)],0x2),formatNumber(_0x3d1952[_0x5e6941(0xfb)]),formatNumber(_0x3d1952[_0x5e6941(0x14b)],0x2),formatNumber(_0x3d1952[_0x5e6941(0x115)],0x2),formatNumber(_0x3d1952[_0x5e6941(0x14b)]/_0x3d1952['totalArea'],0x2)];_0x506c49[_0x5e6941(0x137)](_0x3c3b06=>{const _0x175f67=_0x5e6941;_0x4ed95d['insertCell']()[_0x175f67(0xe2)]=_0x3c3b06;});}function exportToExcel(){const _0x54c684=_0x496db5;try{const _0x55e52b=document[_0x54c684(0xf3)](_0x54c684(0x142)),_0x3f4e95=XLSX[_0x54c684(0x10f)]['book_new'](),_0x39e3ff=[],_0x14fcf9=['การใช้ประโยชน์ที่ดินบริเวณหมายเลข',_0x54c684(0xea),'ประชากร\x20(บ้านเดี่ยว)',_0x54c684(0xd4),_0x54c684(0xc0),'จำนวนอาคาร\x20(ทาวน์เฮาส์)',_0x54c684(0x120),'จำนวนอาคาร\x20(ห้องแถว)',_0x54c684(0xbe),_0x54c684(0x11c),_0x54c684(0x109),_0x54c684(0xfd),_0x54c684(0x117),_0x54c684(0x11a),_0x54c684(0x108),_0x54c684(0x11f),_0x54c684(0x10c),'ประชากร\x20(อื่นๆ)','จำนวนอาคารรวม',_0x54c684(0xfc),_0x54c684(0xe1),_0x54c684(0x121)];_0x39e3ff[_0x54c684(0xe7)](_0x14fcf9);for(let _0x4bd97b=0x2;_0x4bd97b<_0x55e52b[_0x54c684(0xf8)][_0x54c684(0xdd)];_0x4bd97b++){const _0x53bc76=_0x55e52b[_0x54c684(0xf8)][_0x4bd97b],_0x302493=[];for(let _0xb05954=0x0;_0xb05954<_0x53bc76[_0x54c684(0x103)][_0x54c684(0xdd)];_0xb05954++){const _0x4d93f7=_0x53bc76['cells'][_0xb05954][_0x54c684(0xe2)];if(_0xb05954===0x0)_0x302493[_0x54c684(0xe7)](_0x4d93f7);else{const _0x23394b=_0x4d93f7[_0x54c684(0x102)](/,/g,'');_0x302493['push'](isNaN(_0x23394b)?_0x4d93f7:Number(_0x23394b));}}_0x39e3ff[_0x54c684(0xe7)](_0x302493);}const _0x3bd984=XLSX[_0x54c684(0x10f)]['aoa_to_sheet'](_0x39e3ff),_0x5dc22c=_0x14fcf9[_0x54c684(0xc7)](()=>({'wch':0xf}));_0x5dc22c[0x0][_0x54c684(0xda)]=0x19,_0x3bd984['!cols']=_0x5dc22c,XLSX[_0x54c684(0x10f)][_0x54c684(0x148)](_0x3f4e95,_0x3bd984,_0x54c684(0x104));const _0x4eae2b=_0x54c684(0xcc)+new Date()[_0x54c684(0x12e)]()[_0x54c684(0x110)]('T')[0x0]+_0x54c684(0x13d);XLSX[_0x54c684(0x144)](_0x3f4e95,_0x4eae2b),showStatus(_0x54c684(0xe4),_0x54c684(0xeb));}catch(_0x221f9a){console[_0x54c684(0xd5)]('Error\x20exporting\x20to\x20Excel:',_0x221f9a),handleError(_0x221f9a,_0x54c684(0xd7));}}
    </script>
</body>
</html>                            